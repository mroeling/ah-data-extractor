(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))s(i);new MutationObserver(i=>{for(const r of i)if(r.type==="childList")for(const o of r.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&s(o)}).observe(document,{childList:!0,subtree:!0});function t(i){const r={};return i.integrity&&(r.integrity=i.integrity),i.referrerPolicy&&(r.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?r.credentials="include":i.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function s(i){if(i.ep)return;i.ep=!0;const r=t(i);fetch(i.href,r)}})();const Hd=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:Function("return this")(),Qa=__DEFINES__;Object.keys(Qa).forEach(n=>{const e=n.split(".");let t=Hd;for(let s=0;s<e.length;s++){const i=e[s];s===e.length-1?t[i]=Qa[n]:t=t[i]||(t[i]={})}});function bi(n){"@babel/helpers - typeof";return bi=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},bi(n)}function Ud(n,e){if(bi(n)!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var s=t.call(n,e);if(bi(s)!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function Wd(n){var e=Ud(n,"string");return bi(e)=="symbol"?e:e+""}function ot(n,e,t){return(e=Wd(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}var zd=class{constructor(n,e,t){this.logger=n,this.transport=e,this.importUpdatedModule=t,ot(this,"hotModulesMap",new Map),ot(this,"disposeMap",new Map),ot(this,"pruneMap",new Map),ot(this,"dataMap",new Map),ot(this,"customListenersMap",new Map),ot(this,"ctxToListenersMap",new Map),ot(this,"currentFirstInvalidatedBy",void 0),ot(this,"updateQueue",[]),ot(this,"pendingUpdateQueue",!1)}async notifyListeners(n,e){const t=this.customListenersMap.get(n);t&&await Promise.allSettled(t.map(s=>s(e)))}send(n){this.transport.send(n).catch(e=>{this.logger.error(e)})}clear(){this.hotModulesMap.clear(),this.disposeMap.clear(),this.pruneMap.clear(),this.dataMap.clear(),this.customListenersMap.clear(),this.ctxToListenersMap.clear()}async prunePaths(n){await Promise.all(n.map(e=>{const t=this.disposeMap.get(e);if(t)return t(this.dataMap.get(e))})),await Promise.all(n.map(e=>{const t=this.pruneMap.get(e);if(t)return t(this.dataMap.get(e))}))}warnFailedUpdate(n,e){(!(n instanceof Error)||!n.message.includes("fetch"))&&this.logger.error(n),this.logger.error(`Failed to reload ${e}. This could be due to syntax errors or importing non-existent modules. (see errors above)`)}async queueUpdate(n){if(this.updateQueue.push(this.fetchUpdate(n)),!this.pendingUpdateQueue){this.pendingUpdateQueue=!0,await Promise.resolve(),this.pendingUpdateQueue=!1;const e=[...this.updateQueue];this.updateQueue=[],(await Promise.all(e)).forEach(t=>t&&t())}}async fetchUpdate(n){const{path:e,acceptedPath:t,firstInvalidatedBy:s}=n,i=this.hotModulesMap.get(e);if(!i)return;let r;const o=e===t,a=i.callbacks.filter(({deps:c})=>c.includes(t));if(o||a.length>0){const c=this.disposeMap.get(t);c&&await c(this.dataMap.get(t));try{r=await this.importUpdatedModule(n)}catch(l){this.warnFailedUpdate(l,t)}}return()=>{try{this.currentFirstInvalidatedBy=s;for(const{deps:l,fn:h}of a)h(l.map(u=>u===t?r:void 0));const c=o?e:`${t} via ${e}`;this.logger.debug(`hot updated: ${c}`)}finally{this.currentFirstInvalidatedBy=void 0}}}};let qd="useandom-26T198340PX75pxJACKVERYMINDBUSHWOLF_GQZbfghjklqvwyzrict",Kd=(n=21)=>{let e="",t=n|0;for(;t--;)e+=qd[Math.random()*64|0];return e};typeof process<"u"&&process.platform;function Qd(){let n,e;return{promise:new Promise((t,s)=>{n=t,e=s}),resolve:n,reject:e}}function Ya(n){const e=new Error(n.message||"Unknown invoke error");return Object.assign(e,n,{runnerError:new Error("RunnerError")}),e}const Yd=n=>{if(n.invoke)return{...n,async invoke(t,s){const i=await n.invoke({type:"custom",event:"vite:invoke",data:{id:"send",name:t,data:s}});if("error"in i)throw Ya(i.error);return i.result}};if(!n.send||!n.connect)throw new Error("transport must implement send and connect when invoke is not implemented");const e=new Map;return{...n,connect({onMessage:t,onDisconnection:s}){return n.connect({onMessage(i){if(i.type==="custom"&&i.event==="vite:invoke"){const r=i.data;if(r.id.startsWith("response:")){const o=r.id.slice(9),a=e.get(o);if(!a)return;a.timeoutId&&clearTimeout(a.timeoutId),e.delete(o);const{error:c,result:l}=r.data;c?a.reject(c):a.resolve(l);return}}t(i)},onDisconnection:s})},disconnect(){return e.forEach(t=>{t.reject(new Error(`transport was disconnected, cannot call ${JSON.stringify(t.name)}`))}),e.clear(),n.disconnect?.()},send(t){return n.send(t)},async invoke(t,s){const i=Kd(),r={type:"custom",event:"vite:invoke",data:{name:t,id:`send:${i}`,data:s}},o=n.send(r),{promise:a,resolve:c,reject:l}=Qd(),h=n.timeout??6e4;let u;h>0&&(u=setTimeout(()=>{e.delete(i),l(new Error(`transport invoke timed out after ${h}ms (data: ${JSON.stringify(r)})`))},h),u?.unref?.()),e.set(i,{resolve:c,reject:l,name:t,timeoutId:u}),o&&o.catch(d=>{clearTimeout(u),e.delete(i),l(d)});try{return await a}catch(d){throw Ya(d)}}}},Xd=n=>{const e=Yd(n);let t=!e.connect,s;return{...n,...e.connect?{async connect(i){if(t)return;if(s){await s;return}const r=e.connect({onMessage:i??(()=>{}),onDisconnection(){t=!1}});r&&(s=r,await s,s=void 0),t=!0}}:{},...e.disconnect?{async disconnect(){t&&(s&&await s,t=!1,await e.disconnect())}}:{},async send(i){if(e.send){if(!t)if(s)await s;else throw new Error("send was called before connect");await e.send(i)}},async invoke(i,r){if(!t)if(s)await s;else throw new Error("invoke was called before connect");return e.invoke(i,r)}}},Xa=n=>{const e=n.pingInterval??3e4;let t,s;return{async connect({onMessage:i,onDisconnection:r}){const o=n.createConnection();o.addEventListener("message",async({data:c})=>{i(JSON.parse(c))});let a=o.readyState===o.OPEN;a||await new Promise((c,l)=>{o.addEventListener("open",()=>{a=!0,c()},{once:!0}),o.addEventListener("close",async()=>{if(!a){l(new Error("WebSocket closed without opened."));return}i({type:"custom",event:"vite:ws:disconnect",data:{webSocket:o}}),r()})}),i({type:"custom",event:"vite:ws:connect",data:{webSocket:o}}),t=o,s=setInterval(()=>{o.readyState===o.OPEN&&o.send(JSON.stringify({type:"ping"}))},e)},disconnect(){clearInterval(s),t?.close()},send(i){t.send(JSON.stringify(i))}}};function Gd(n){const e=new Jd;return t=>e.enqueue(()=>n(t))}var Jd=class{constructor(){ot(this,"queue",[]),ot(this,"pending",!1)}enqueue(n){return new Promise((e,t)=>{this.queue.push({promise:n,resolve:e,reject:t}),this.dequeue()})}dequeue(){if(this.pending)return!1;const n=this.queue.shift();return n?(this.pending=!0,n.promise().then(n.resolve).catch(n.reject).finally(()=>{this.pending=!1,this.dequeue()}),!0):!1}};const Zd=__HMR_CONFIG_NAME__,ef=__BASE__||"/",tf="document"in globalThis?document.querySelector("meta[property=csp-nonce]")?.nonce:void 0;function Xe(n,e={},...t){const s=document.createElement(n);for(const[i,r]of Object.entries(e))r!==void 0&&s.setAttribute(i,r);return s.append(...t),s}const sf=`
:host {
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  z-index: 99999;
  --monospace: 'SFMono-Regular', Consolas,
  'Liberation Mono', Menlo, Courier, monospace;
  --red: #ff5555;
  --yellow: #e2aa53;
  --purple: #cfa4ff;
  --cyan: #2dd9da;
  --dim: #c9c9c9;

  --window-background: #181818;
  --window-color: #d8d8d8;
}

.backdrop {
  position: fixed;
  z-index: 99999;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  overflow-y: scroll;
  margin: 0;
  background: rgba(0, 0, 0, 0.66);
}

.window {
  font-family: var(--monospace);
  line-height: 1.5;
  max-width: 80vw;
  color: var(--window-color);
  box-sizing: border-box;
  margin: 30px auto;
  padding: 2.5vh 4vw;
  position: relative;
  background: var(--window-background);
  border-radius: 6px 6px 8px 8px;
  box-shadow: 0 19px 38px rgba(0,0,0,0.30), 0 15px 12px rgba(0,0,0,0.22);
  overflow: hidden;
  border-top: 8px solid var(--red);
  direction: ltr;
  text-align: left;
}

pre {
  font-family: var(--monospace);
  font-size: 16px;
  margin-top: 0;
  margin-bottom: 1em;
  overflow-x: scroll;
  scrollbar-width: none;
}

pre::-webkit-scrollbar {
  display: none;
}

pre.frame::-webkit-scrollbar {
  display: block;
  height: 5px;
}

pre.frame::-webkit-scrollbar-thumb {
  background: #999;
  border-radius: 5px;
}

pre.frame {
  scrollbar-width: thin;
}

.message {
  line-height: 1.3;
  font-weight: 600;
  white-space: pre-wrap;
}

.message-body {
  color: var(--red);
}

.plugin {
  color: var(--purple);
}

.file {
  color: var(--cyan);
  margin-bottom: 0;
  white-space: pre-wrap;
  word-break: break-all;
}

.frame {
  color: var(--yellow);
}

.stack {
  font-size: 13px;
  color: var(--dim);
}

.tip {
  font-size: 13px;
  color: #999;
  border-top: 1px dotted #999;
  padding-top: 13px;
  line-height: 1.8;
}

code {
  font-size: 13px;
  font-family: var(--monospace);
  color: var(--yellow);
}

.file-link {
  text-decoration: underline;
  cursor: pointer;
}

kbd {
  line-height: 1.5;
  font-family: ui-monospace, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
  font-size: 0.75rem;
  font-weight: 700;
  background-color: rgb(38, 40, 44);
  color: rgb(166, 167, 171);
  padding: 0.15rem 0.3rem;
  border-radius: 0.25rem;
  border-width: 0.0625rem 0.0625rem 0.1875rem;
  border-style: solid;
  border-color: rgb(54, 57, 64);
  border-image: initial;
}
`,nf=()=>Xe("div",{class:"backdrop",part:"backdrop"},Xe("div",{class:"window",part:"window"},Xe("pre",{class:"message",part:"message"},Xe("span",{class:"plugin",part:"plugin"}),Xe("span",{class:"message-body",part:"message-body"})),Xe("pre",{class:"file",part:"file"}),Xe("pre",{class:"frame",part:"frame"}),Xe("pre",{class:"stack",part:"stack"}),Xe("div",{class:"tip",part:"tip"},"Click outside, press ",Xe("kbd",{},"Esc")," key, or fix the code to dismiss.",Xe("br"),"You can also disable this overlay by setting ",Xe("code",{part:"config-option-name"},"server.hmr.overlay")," to ",Xe("code",{part:"config-option-value"},"false")," in ",Xe("code",{part:"config-file-name"},Zd),".")),Xe("style",{nonce:tf},sf)),Ga=/(?:file:\/\/)?(?:[a-zA-Z]:\\|\/).*?:\d+:\d+/g,Vr=/^(?:>?\s*\d+\s+\|.*|\s+\|\s*\^.*)\r?\n/gm,{HTMLElement:rf=class{}}=globalThis;var of=class extends rf{constructor(n,e=!0){super(),ot(this,"root",void 0),ot(this,"closeOnEsc",void 0),this.root=this.attachShadow({mode:"open"}),this.root.appendChild(nf()),Vr.lastIndex=0;const t=n.frame&&Vr.test(n.frame),s=t?n.message.replace(Vr,""):n.message;n.plugin&&this.text(".plugin",`[plugin:${n.plugin}] `),this.text(".message-body",s.trim());const[i]=(n.loc?.file||n.id||"unknown file").split("?");n.loc?this.text(".file",`${i}:${n.loc.line}:${n.loc.column}`,e):n.id&&this.text(".file",i),t&&this.text(".frame",n.frame.trim()),this.text(".stack",n.stack,e),this.root.querySelector(".window").addEventListener("click",r=>{r.stopPropagation()}),this.addEventListener("click",()=>{this.close()}),this.closeOnEsc=r=>{(r.key==="Escape"||r.code==="Escape")&&this.close()},document.addEventListener("keydown",this.closeOnEsc)}text(n,e,t=!1){const s=this.root.querySelector(n);if(!t)s.textContent=e;else{let i=0,r;for(Ga.lastIndex=0;r=Ga.exec(e);){const{0:o,index:a}=r,c=e.slice(i,a);s.appendChild(document.createTextNode(c));const l=document.createElement("a");l.textContent=o,l.className="file-link",l.onclick=()=>{fetch(new URL(`${ef}__open-in-editor?file=${encodeURIComponent(o)}`,import.meta.url))},s.appendChild(l),i+=c.length+o.length}i<e.length&&s.appendChild(document.createTextNode(e.slice(i)))}}close(){this.parentNode?.removeChild(this),document.removeEventListener("keydown",this.closeOnEsc)}};const vi="vite-error-overlay",{customElements:Hr}=globalThis;Hr&&!Hr.get(vi)&&Hr.define(vi,of);console.debug("[vite] connecting...");const wo=new URL(import.meta.url),af=__SERVER_HOST__,Ja=__HMR_PROTOCOL__||(wo.protocol==="https:"?"wss":"ws"),Oc=__HMR_PORT__,Za=`${__HMR_HOSTNAME__||wo.hostname}:${Oc||wo.port}${__HMR_BASE__}`,el=__HMR_DIRECT_TARGET__,yo=__BASE__||"/",tl=__HMR_TIMEOUT__,sl=__WS_TOKEN__,Lc=Xd((()=>{let n=Xa({createConnection:()=>new WebSocket(`${Ja}://${Za}?token=${sl}`,"vite-hmr"),pingInterval:tl});return{async connect(e){try{await n.connect(e)}catch(t){if(!Oc){n=Xa({createConnection:()=>new WebSocket(`${Ja}://${el}?token=${sl}`,"vite-hmr"),pingInterval:tl});try{await n.connect(e),console.info("[vite] Direct websocket connection fallback. Check out https://vite.dev/config/server-options.html#server-hmr to remove the previous connection error.")}catch(s){if(s instanceof Error&&s.message.includes("WebSocket closed without opened.")){const i=new URL(import.meta.url),r=i.host+i.pathname.replace(/@vite\/client$/,"");console.error(`[vite] failed to connect to websocket.
your current setup:
  (browser) ${r} <--[HTTP]--> ${af} (server)
  (browser) ${Za} <--[WebSocket (failing)]--> ${el} (server)
Check out your Vite / network configuration and https://vite.dev/config/server-options.html#server-hmr .`)}}return}throw console.error(`[vite] failed to connect to websocket (${t}). `),t}},async disconnect(){await n.disconnect()},send(e){n.send(e)}}})());let Dc=!1;typeof window<"u"&&window.addEventListener?.("beforeunload",()=>{Dc=!0});function nl(n){const e=new URL(n,"http://vite.dev");return e.searchParams.delete("direct"),e.pathname+e.search}let il=!0;const rl=new WeakSet,lf=n=>{let e;return()=>{e&&(clearTimeout(e),e=null),e=setTimeout(()=>{location.reload()},n)}},ko=lf(20),ds=new zd({error:n=>console.error("[vite]",n),debug:(...n)=>console.debug("[vite]",...n)},Lc,async function({acceptedPath:e,timestamp:t,explicitImportRequired:s,isWithinCircularImport:i}){const[r,o]=e.split("?"),a=import(yo+r.slice(1)+`?${s?"import&":""}t=${t}${o?`&${o}`:""}`);return i&&a.catch(()=>{console.info(`[hmr] ${e} failed to apply HMR as it's within a circular import. Reloading page to reset the execution order. To debug and break the circular import, you can run \`vite --debug hmr\` to log the circular dependency path if a file change triggered it.`),ko()}),await a});Lc.connect(Gd(cf));async function cf(n){switch(n.type){case"connected":console.debug("[vite] connected.");break;case"update":if(await ds.notifyListeners("vite:beforeUpdate",n),Li)if(il&&uf()){location.reload();return}else ol&&Fc(),il=!1;await Promise.all(n.updates.map(async e=>{if(e.type==="js-update")return ds.queueUpdate(e);const{path:t,timestamp:s}=e,i=nl(t),r=Array.from(document.querySelectorAll("link")).find(a=>!rl.has(a)&&nl(a.href).includes(i));if(!r)return;const o=`${yo}${i.slice(1)}${i.includes("?")?"&":"?"}t=${s}`;return new Promise(a=>{const c=r.cloneNode();c.href=new URL(o,r.href).href;const l=()=>{r.remove(),console.debug(`[vite] css hot updated: ${i}`),a()};c.addEventListener("load",l),c.addEventListener("error",l),rl.add(r),r.after(c)})})),await ds.notifyListeners("vite:afterUpdate",n);break;case"custom":if(await ds.notifyListeners(n.event,n.data),n.event==="vite:ws:disconnect"&&Li&&!Dc){console.log("[vite] server connection lost. Polling for restart...");const e=n.data.webSocket,t=new URL(e.url);t.search="",await df(t.href),location.reload()}break;case"full-reload":if(await ds.notifyListeners("vite:beforeFullReload",n),Li)if(n.path&&n.path.endsWith(".html")){const e=decodeURI(location.pathname),t=yo+n.path.slice(1);(e===t||n.path==="/index.html"||e.endsWith("/")&&e+"index.html"===t)&&ko();return}else ko();break;case"prune":await ds.notifyListeners("vite:beforePrune",n),await ds.prunePaths(n.paths);break;case"error":if(await ds.notifyListeners("vite:error",n),Li){const e=n.err;ol?hf(e):console.error(`[vite] Internal Server Error
${e.message}
${e.stack}`)}break;case"ping":break;default:return n}}const ol=__HMR_ENABLE_OVERLAY__,Li="document"in globalThis;function hf(n){Fc();const{customElements:e}=globalThis;if(e){const t=e.get(vi);document.body.appendChild(new t(n))}}function Fc(){document.querySelectorAll(vi).forEach(n=>n.close())}function uf(){return document.querySelectorAll(vi).length}function df(n){if(typeof SharedWorker>"u"){const i={currentState:document.visibilityState,listeners:new Set},r=()=>{i.currentState=document.visibilityState;for(const o of i.listeners)o(i.currentState)};return document.addEventListener("visibilitychange",r),Co(n,i)}const e=new Blob(['"use strict";',`const waitForSuccessfulPingInternal = ${Co.toString()};`,`const fn = ${ff.toString()};`,`fn(${JSON.stringify(n)})`],{type:"application/javascript"}),t=URL.createObjectURL(e),s=new SharedWorker(t);return new Promise((i,r)=>{const o=()=>{s.port.postMessage({visibility:document.visibilityState})};document.addEventListener("visibilitychange",o),s.port.addEventListener("message",a=>{document.removeEventListener("visibilitychange",o),s.port.close();const c=a.data;if(c.type==="error"){r(c.error);return}i()}),o(),s.port.start()})}function ff(n){self.addEventListener("connect",e=>{const t=e.ports[0];if(!n){t.postMessage({type:"error",error:new Error("socketUrl not found")});return}const s={currentState:"visible",listeners:new Set};t.addEventListener("message",i=>{const{visibility:r}=i.data;s.currentState=r,console.debug("[vite] new window visibility",r);for(const o of s.listeners)o(r)}),t.start(),console.debug("[vite] connected from window"),Co(n,s).then(()=>{console.debug("[vite] ping successful");try{t.postMessage({type:"success"})}catch(i){t.postMessage({type:"error",error:i})}},i=>{console.debug("[vite] error happened",i);try{t.postMessage({type:"error",error:i})}catch(r){t.postMessage({type:"error",error:r})}})})}async function Co(n,e,t=1e3){function s(o){return new Promise(a=>setTimeout(a,o))}async function i(){try{const o=new WebSocket(n,"vite-ping");return new Promise(a=>{function c(){a(!0),h()}function l(){a(!1),h()}function h(){o.removeEventListener("open",c),o.removeEventListener("error",l),o.close()}o.addEventListener("open",c),o.addEventListener("error",l)})}catch{return!1}}function r(o){return new Promise(a=>{const c=l=>{l==="visible"&&(a(),o.listeners.delete(c))};o.listeners.add(c)})}if(!await i())for(await s(t);;)if(e.currentState==="visible"){if(await i())break;await s(t)}else await r(e)}const pf=new Map,gf=new Map;"document"in globalThis&&(document.querySelectorAll("style[data-vite-dev-id]").forEach(n=>{pf.set(n.getAttribute("data-vite-dev-id"),n)}),document.querySelectorAll('link[rel="stylesheet"][data-vite-dev-id]').forEach(n=>{gf.set(n.getAttribute("data-vite-dev-id"),n)}));function mf(){Symbol.metadata??=Symbol.for("Symbol.metadata")}const as={get(n,e){return e[Symbol.metadata]?.[n]},define(n,e,...t){let s=Object.getOwnPropertyDescriptor(e,Symbol.metadata)?.value;s==null&&Object.defineProperty(e,Symbol.metadata,{value:s=Object.create(null),enumerable:!0,configurable:!0,writable:!0});const i=t.length;switch(i){case 0:throw new Error("At least one key must be provided");case 1:s[t[0]]=n;return;case 2:s[t[0]]=s[t[1]]=n;return;default:{for(let r=0;r<i;++r)s[t[r]]=n;return}}},has(n,e){const t=e[Symbol.metadata];return t==null?!1:n in t}},$i=Object.freeze,Nc=Object.assign,bf=String,Lt=as.get,_i=as.define,Pe=n=>n instanceof Promise,Ee=n=>n instanceof Array,Rn=n=>n instanceof Set,_s=n=>n instanceof Map,jc=n=>n instanceof Object;function er(n){return typeof n=="object"&&n!==null||typeof n=="function"}const ce=n=>typeof n=="function",se=n=>typeof n=="string",vf=n=>typeof n=="symbol",_f=n=>typeof n=="number",de=()=>Object.create(null),is=Object.is,Fe=(n,...e)=>{const t=bf(n).padStart(4,"0"),s=yf(n,...e),i=`https://docs.aurelia.io/developer-guides/error-messages/0001-to-0023/aur${t}`;return new Error(`AUR${t}: ${s}\\n\\nFor more information, see: ${i}`)},wf={1:"No registration for interface: '{{0}}'",2:`'{{0}}' was registered with "none" resolver, are you injecting the right key?`,3:"Cyclic dependency found: {{0}}",4:"Resolver for {{0}} returned a null factory",5:"Invalid resolver strategy specified: {{0}}. Did you assign an invalid strategy value?",6:"Unable to autoregister dependency: {{0}}",7:'Resource key "{{0}}" already registered',8:"Unable to resolve key: {{0}}",9:"Attempted to jitRegister something that is not a constructor: '{{0}}'. Did you forget to register this resource?",10:'Attempted to jitRegister an intrinsic type: "{{0}}". Did you forget to add @inject(Key)',11:"Invalid resolver, null/undefined returned from the static register method.",12:"Attempted to jitRegister an interface: {{0}}",13:"Cannot call resolve '{{0}}' before calling prepare or after calling dispose.",14:"Key cannot be null or undefined. Are you trying to inject/register something that doesn't exist with DI?A common cause is circular dependency with bundler, did you accidentally introduce circular dependency into your module graph?",15:"'{{0}}' is a native function and cannot be safely constructed by DI. If this is intentional, please use a callback or cachedCallback resolver.",16:'There is not a currently active container to resolve "{{0}}". Are you trying to "new Class(...)" that has a resolve(...) call?',17:"Failed to instantiate '{{0}}' via @newInstanceOf/@newInstanceForScope, there's no registration and no default implementation, or the default implementation does not result in factory for constructing the instances.",18:"Invalid channel name or instance: '{{0}}'.",19:"Invalid channel name or type: {{0}}.",20:"No defined value found when calling firstDefined()",21:"Invalid module transform input: {{0}}. Expected Promise or Object.",22:"The @inject decorator on the target ('{{0}}') type '{{1}}' is not supported.",23:"Resource key '{{0}}' has already been registered."},yf=(n,...e)=>{let t=wf[n];for(let s=0;s<e.length;++s)t=t.replace(`{{${s}}}`,String(e[s]));return t},In=(...n)=>globalThis.console.error(...n),wi=(()=>{const n={};let e=!1,t=0,s=0,i=0;return r=>{switch(typeof r){case"number":return r>=0&&(r|0)===r;case"string":if(e=n[r],e!==void 0)return e;if(t=r.length,t===0)return n[r]=!1;for(s=0,i=0;i<t;++i)if(s=r.charCodeAt(i),i===0&&s===48&&t>1||s<48||s>57)return n[r]=!1;return n[r]=!0;default:return!1}}})(),Vc=(function(){const n=Nc(de(),{0:!0,1:!0,2:!0,3:!0,4:!0,5:!0,6:!0,7:!0,8:!0,9:!0}),e=t=>t===""?0:t!==t.toUpperCase()?3:t!==t.toLowerCase()?2:n[t]===!0?1:0;return(t,s)=>{const i=t.length;if(i===0)return t;let r=!1,o="",a,c="",l=0,h=t.charAt(0),u=e(h),d=0;for(;d<i;++d)a=l,c=h,l=u,h=t.charAt(d+1),u=e(h),l===0?o.length>0&&(r=!0):(!r&&o.length>0&&l===2&&(r=a===3||u===3),o+=s(c,r),r=!1);return o}})(),je=(function(){const n=de(),e=(t,s)=>s?t.toUpperCase():t.toLowerCase();return t=>{let s=n[t];return s===void 0&&(s=n[t]=Vc(t,e)),s}})(),Hc=(function(){const n=de();return e=>{let t=n[e];return t===void 0&&(t=je(e),t.length>0&&(t=t[0].toUpperCase()+t.slice(1)),n[e]=t),t}})(),Uc=(function(){const n=de(),e=(t,s)=>s?`-${t.toLowerCase()}`:t.toLowerCase();return t=>{let s=n[t];return s===void 0&&(s=n[t]=Vc(t,e)),s}})(),Ur=n=>{const e=n.length,t=Array(e);let s=0;for(;s<e;++s)t[s]=n[s];return t},an=(n,e)=>{const t=e.name;e.addInitializer(function(){Reflect.defineProperty(this,t,{value:n.bind(this),writable:!0,configurable:!0,enumerable:!1})})},Be=(...n)=>{const e=[];let t=0;const s=n.length;let i=0,r,o=0;for(;o<s;++o)if(r=n[o],r!==void 0){i=r.length;let a=0;for(;a<i;++a)e[t++]=r[a]}return e},gs=(...n)=>{const e=n.length;let t,s=0;for(;e>s;++s)if(t=n[s],t!==void 0)return t;throw Fe(20)},kf=(function(){const n=Function.prototype,e=Object.getPrototypeOf,t=new WeakMap;let s=n,i=0,r;return function(o){if(r=t.get(o),r===void 0)for(t.set(o,r=[s=o]),i=0;(s=e(s))!==n;)r[++i]=s;return r}})();function xo(...n){return Nc(de(),...n)}const al=(()=>{const n=new WeakMap;let e=!1,t="",s=0;return i=>(e=n.get(i),e==null&&(s=(t=i.toString()).length,e=s>28&&t.indexOf("[native code] }")===s-15,n.set(i,e)),e)})(),q=(n,e)=>Pe(n)?n.then(e):e(n),De=(...n)=>{let e,t,s,i=0,r=n.length;for(;i<r;++i)e=n[i],Pe(e=n[i])&&(t===void 0?t=e:s===void 0?s=[t,e]:s.push(e));return s===void 0?t:Promise.all(s)},Cf=(n,e)=>new St(n,0,e),yi=(n,e)=>new St(n,1,e),Wc=(n,e)=>new St(n,2,e),xf=(n,e)=>new St(n,3,e),Sf=(n,e)=>new St(n,3,zc(e)),tr=(n,e)=>new St(e,5,n),Af=(n,...e)=>new Hf(n,e),ll=new WeakMap,zc=n=>(e,t,s)=>{let i=ll.get(e);if(i===void 0&&ll.set(e,i=new WeakMap),i.has(s))return i.get(s);const r=n(e,t,s);return i.set(s,r),r},Ys={instance:Cf,singleton:yi,transient:Wc,callback:xf,cachedCallback:Sf,aliasTo:tr,defer:Af},Ii=function(n){return function(t){t.register(yi(this,this),tr(this,n))}},Ks="au:annotation",ws=(n,e)=>e===void 0?`${Ks}:${n}`:`${Ks}:${n}:${e}`,$f=(n,e)=>{const t=Lt(Ks,n);t===void 0?_i([e],n,Ks):t.push(e)},If=$i({name:"au:annotation",appendTo:$f,set(n,e,t){_i(t,n,ws(e))},get:(n,e)=>Lt(ws(e),n),getKeys(n){let e=Lt(Ks,n);return e===void 0&&_i(e=[],n,Ks),e},isKey:n=>n.startsWith(Ks),keyFor:ws}),Pt="au:resource",rn=(n,e,t)=>`${Pt}:${n}`,qc={annotation:If},Kc=Object.prototype.hasOwnProperty;function it(n,e,t,s){let i=Lt(ws(n),t);return i===void 0?(i=e[n],i===void 0?(i=t[n],i===void 0||!Kc.call(t,n)?s():i):i):i}function kt(n,e,t){let s=Lt(ws(n),e);return s===void 0?(s=e[n],s===void 0||!Kc.call(e,n)?t():s):s}function Tt(n,e,t){const s=e[n];return s===void 0?t():s}const Ht=Symbol.for("au:registrable"),Tf={singleton:n=>new St(n,1,n)};class Ot{constructor(e,t){this.inheritParentResources=e,this.defaultResolver=t}static from(e){return e===void 0||e===Ot.DEFAULT?Ot.DEFAULT:new Ot(e.inheritParentResources??!1,e.defaultResolver??Tf.singleton)}}Ot.DEFAULT=Ot.from({});const Ef=n=>new Zn(null,Ot.from(n)),Mf=new Set("Array ArrayBuffer Boolean DataView Date Error EvalError Float32Array Float64Array Function Int8Array Int16Array Int32Array Map Number Object Promise RangeError ReferenceError RegExp Set SharedArrayBuffer String SyntaxError TypeError Uint8Array Uint8ClampedArray Uint16Array Uint32Array URIError WeakMap WeakSet".split(" "));let Bf=0,Ce=null;class Zn{get depth(){return this._parent===null?0:this._parent.depth+1}get parent(){return this._parent}constructor(e,t){if(this.id=++Bf,this._registerDepth=0,this._disposableResolvers=new Map,this._parent=e,this.config=t,this._resolvers=new Map,this.res={},e===null)this.root=this,this._factories=new Map;else if(this.root=e.root,this._factories=e._factories,t.inheritParentResources)for(const s in e.res)this.registerResolver(s,e.res[s]);this._resolvers.set(Ti,Rf)}register(...e){if(++this._registerDepth===100)throw Fe(6,...e);let t,s,i,r,o,a=0,c=e.length,l;for(;a<c;++a)if(t=e[a],!!er(t))if(qn(t))t.register(this);else if((l=Lt(Pt,t))!=null)l.register(this);else if(Lf(t)){const h=t[Symbol.metadata]?.[Ht];if(qn(h))h.register(this);else if(se(t.$au?.type)){const u=t.$au,d=(t.aliases??X).concat(u.aliases??X);let p=`${Pt}:${u.type}:${u.name}`;if(this.has(p,!1)){globalThis.console?.warn(Fe(7,p));continue}for(tr(t,p).register(this),this.has(t,!1)||yi(t,t).register(this),r=0,o=d.length;r<o;++r){if(p=`${Pt}:${u.type}:${d[r]}`,this.has(p,!1)){globalThis.console?.warn(Fe(7,p));continue}tr(t,p).register(this)}}else yi(t,t).register(this)}else for(s=Object.keys(t),r=0,o=s.length;r<o;++r)i=t[s[r]],er(i)&&(qn(i)?i.register(this):this.register(i));return--this._registerDepth,this}registerResolver(e,t,s=!1){Vn(e);const i=this._resolvers,r=i.get(e);if(r==null){if(i.set(e,t),Wr(e)){if(this.res[e]!==void 0)throw Fe(7,e);this.res[e]=t}}else r instanceof St&&r._strategy===4?r._state.push(t):i.set(e,new St(e,4,[r,t]));return s&&this._disposableResolvers.set(e,t),t}deregister(e){Vn(e);const t=this._resolvers.get(e);t!=null&&(this._resolvers.delete(e),Wr(e)&&delete this.res[e],this._disposableResolvers.has(e)&&(t.dispose(),this._disposableResolvers.delete(e)))}registerTransformer(e,t){const s=this.getResolver(e);if(s==null)return!1;if(s.getFactory){const i=s.getFactory(this);return i==null?!1:(i.registerTransformer(t),!0)}return!1}getResolver(e,t=!0){if(Vn(e),e.resolve!==void 0)return e;const s=Ce;let i=Ce=this,r,o;try{for(;i!=null;)if(r=i._resolvers.get(e),r==null){if(i._parent==null)return o=ul(e)?this:i,t?this._jitRegister(e,o):null;i=i._parent}else return r}finally{Ce=s}return null}has(e,t=!1){return this._resolvers.has(e)||Wr(e)&&e in this.res||((t&&this._parent?.has(e,!0))??!1)}get(e){if(Vn(e),e.$isResolver)return e.resolve(this,this);const t=Ce;let s=Ce=this,i,r;try{for(;s!=null;)if(i=s._resolvers.get(e),i==null){if(s._parent==null)return r=ul(e)?this:s,i=this._jitRegister(e,r),i.resolve(s,this);s=s._parent}else return i.resolve(s,this)}finally{Ce=t}throw Fe(8,e)}getAll(e,t=!1){Vn(e);const s=Ce,i=Ce=this;let r=i,o,a=X;try{if(t){for(;r!=null;)o=r._resolvers.get(e),o!=null&&(a=a.concat(hl(o,r,i))),r=r._parent;return a}for(;r!=null;)if(o=r._resolvers.get(e),o==null){if(r=r._parent,r==null)return X}else return hl(o,r,i)}finally{Ce=s}return X}invoke(e,t){if(al(e))throw Fe(15,e);const s=Ce;Ce=this;{let i,r;try{i=bn(e).map(o=>this.get(r=o))}catch(o){throw In(`[DEV:aurelia] Error during construction of ${e.name?e.name:`(Anonymous) ${String(e)}`}, caused by dependency: ${String(r)}`),Ce=s,o}try{return t===void 0?new e(...i):new e(...i,...t)}catch(o){throw In(`[DEV:aurelia] Error during construction of ${e.name?e.name:`(Anonymous) ${String(e)}`}`),o}finally{Ce=s}}try{return t===void 0?new e(...bn(e).map(ki,this)):new e(...bn(e).map(ki,this),...t)}finally{Ce=s}}hasFactory(e){return this._factories.has(e)}getFactory(e){let t=this._factories.get(e);if(t===void 0){if(al(e))throw Fe(15,e);this._factories.set(e,t=new Pf(e,bn(e)))}return t}registerFactory(e,t){this._factories.set(e,t)}createChild(e){return e===void 0&&this.config.inheritParentResources?this.config===Ot.DEFAULT?new Zn(this,this.config):new Zn(this,Ot.from({...this.config,inheritParentResources:!1})):new Zn(this,Ot.from(e??this.config))}disposeResolvers(){const e=this._resolvers,t=this._disposableResolvers;let s,i;for([i,s]of t.entries())s.dispose?.(),e.delete(i);t.clear()}useResources(e){const t=e.res;for(const s in t)this.registerResolver(s,t[s])}find(e,t){const s=se(t)?`${Pt}:${e}:${t}`:e;let i=this,r=i.res[s];return r==null&&(i=i.root,r=i.res[s]),r==null?null:r.getFactory?.(i)?.Type??null}dispose(){this._disposableResolvers.size>0&&this.disposeResolvers(),this._resolvers.clear(),this.root===this&&(this._factories.clear(),this.res={})}_jitRegister(e,t){const s=qn(e);if(!ce(e)&&!s)throw Fe(9,e);if(Mf.has(e.name))throw Fe(10,e);if(s){const r=e.register(t,e);if(!(r instanceof Object)||r.resolve==null){const o=t._resolvers.get(e);if(o!=null)return o;throw Fe(11,e)}return r}if(e.$isInterface)throw Fe(12,e.friendlyName);const i=this.config.defaultResolver(e,t);return t._resolvers.set(e,i),i}}class Pf{constructor(e,t){this.Type=e,this.dependencies=t,this.transformers=null}construct(e,t){const s=Ce;Ce=e;let i;{let r,o;try{r=this.dependencies.map(a=>e.get(o=a))}catch(a){throw In(`[DEV:aurelia] Error during construction of ${this.Type.name?this.Type.name:`(Anonymous) ${String(this.Type)}`}, caused by dependency: ${String(o)}`),Ce=s,a}try{return t===void 0?i=new this.Type(...r):i=new this.Type(...r,...t),this.transformers==null?i:this.transformers.reduce(cl,i)}catch(a){throw In(`[DEV:aurelia] Error during construction of ${this.Type.name?this.Type.name:`(Anonymous) ${String(this.Type)}`}`),a}finally{Ce=s}}try{return t===void 0?i=new this.Type(...this.dependencies.map(ki,e)):i=new this.Type(...this.dependencies.map(ki,e),...t),this.transformers==null?i:this.transformers.reduce(cl,i)}finally{Ce=s}}registerTransformer(e){(this.transformers??=[]).push(e)}}function cl(n,e){return e(n)}function Vn(n){if(n==null)throw Fe(14)}function ki(n){return this.get(n)}function E(...n){if(Ce==null)throw Fe(16,...n);if(n.length===1)try{return Ce.get(n[0])}catch(e){throw In(`[DEV:aurelia] resolve() call error for: ${String(n[0])}`),e}else{let e;try{return n.map(t=>Ce.get(e=t))}catch(t){throw In(`[DEV:aurelia] resolve() call error for: ${String(e)}`),t}}return n.length===1?Ce.get(n[0]):n.map(ki,Ce)}const hl=(n,e,t)=>{if(n instanceof St&&n._strategy===4){const s=n._state,i=s.length,r=Array(i);let o=0;for(;o<i;++o)r[o]=s[o].resolve(e,t);return r}return[n.resolve(e,t)]},Rf={$isResolver:!0,resolve(n,e){return e}},qn=n=>ce(n?.register),Of=n=>qn(n)&&typeof n.registerInRequestor=="boolean",ul=n=>Of(n)&&n.registerInRequestor,Lf=n=>n.prototype!==void 0,Wr=n=>se(n)&&n.indexOf(":")>0;class Df{constructor(e,t){this._container=e,this._key=t}instance(e){return this._registerResolver(0,e)}singleton(e){return this._registerResolver(1,e)}transient(e){return this._registerResolver(2,e)}callback(e){return this._registerResolver(3,e)}cachedCallback(e){return this._registerResolver(3,zc(e))}aliasTo(e){return this._registerResolver(5,e)}_registerResolver(e,t){const{_container:s,_key:i}=this;return this._container=this._key=void 0,s.registerResolver(i,new St(i,e,t))}}const Hn=n=>{const e=n.slice(),t=Object.keys(n),s=t.length;let i;for(let r=0;r<s;++r)i=t[r],wi(i)||(e[i]=n[i]);return e},Qc=ws("di:paramtypes"),Ff=n=>Lt(Qc,n),Yc=n=>Lt("design:paramtypes",n),dl=n=>n.metadata[Qc]??=[],bn=n=>{const e=ws("di:dependencies");let t=Lt(e,n);if(t===void 0){const s=n.inject;if(s===void 0){const i=Yc(n),r=Ff(n);if(i===void 0)if(r===void 0){const o=Object.getPrototypeOf(n);ce(o)&&o!==Function.prototype?t=Hn(bn(o)):t=[]}else t=Hn(r);else if(r===void 0)t=Hn(i);else{t=Hn(i);let o=r.length,a,c=0;for(;c<o;++c)a=r[c],a!==void 0&&(t[c]=a);const l=Object.keys(r);let h;for(c=0,o=l.length,c=0;c<o;++c)h=l[c],wi(h)||(t[h]=r[h])}}else t=Hn(s);_i(t,n,e)}return t},Is=(n,e)=>{const t=ce(n)?n:e,s=(se(n)?n:void 0)??"(anonymous)",i={$isInterface:!0,friendlyName:s,toString:()=>`InterfaceSymbol<${s}>`,register:t!=null?(r,o)=>t(new Df(r,o??i)):void 0};return i},na=(...n)=>(e,t)=>{switch(t.kind){case"class":{const s=dl(t);let i,r=0;for(;r<n.length;++r)i=n[r],i!==void 0&&(s[r]=i);break}case"field":{const s=dl(t),i=n[0];i!==void 0&&(s[t.name]=i);break}default:throw Fe(22,String(t.name),t.kind)}},Ts=(mf(),{createContainer:Ef,getDesignParamtypes:Yc,getDependencies:bn,createInterface:Is,inject:na,transient(n){return n.register=function(e){return Wc(n,n).register(e,n)},n.registerInRequestor=!1,n},singleton(n,e=Vf){return n.register=function(t){return yi(n,n).register(t,n)},n.registerInRequestor=e.scoped,n}}),Ti=Is("IContainer"),Nf=Ti;function fl(n,e){return Ts.transient(n)}function jf(n,e){return n==null?fl:fl(n)}const Vf={scoped:!1};class St{get $isResolver(){return!0}constructor(e,t,s){this._resolving=!1,this._cachedFactory=null,this._key=e,this._strategy=t,this._state=s}register(e,t){return e.registerResolver(t||this._key,this)}resolve(e,t){switch(this._strategy){case 0:return this._state;case 1:{if(this._resolving)throw Fe(3,this._state.name);return this._resolving=!0,this._state=(this._cachedFactory=e.getFactory(this._state)).construct(t),this._strategy=0,this._resolving=!1,this._state}case 2:{const s=e.getFactory(this._state);if(s===null)throw Fe(4,this._key);return s.construct(t)}case 3:return this._state(e,t,this);case 4:return this._state[0].resolve(e,t);case 5:return t.get(this._state);default:throw Fe(5,this._strategy)}}getFactory(e){switch(this._strategy){case 1:case 2:return e.getFactory(this._state);case 5:return e.getResolver(this._state)?.getFactory?.(e)??null;case 0:return this._cachedFactory;default:return null}}}class Re{get friendlyName(){return this._name}constructor(e,t=null,s=null){this._name=e,this._instance=t,this._Type=s}prepare(e){this._instance=e}get $isResolver(){return!0}resolve(){if(this._instance==null)throw Fe(13,this._name);return this._instance}getFactory(e){return this._Type==null?null:e.getFactory(this._Type)}dispose(){this._instance=null}}class Hf{constructor(e,t){this.key=e,this.params=t}register(e){e.has(this.key,!0)?e.get(this.key).register(e,...this.params):e.register(...this.params.filter(t=>typeof t=="object"))}}const X=$i([]),Uf=$i({});function wt(){}const On=Is("IPlatform");function Ei(n){return function(e){function t(s,i){na(t)(s,i)}return t.$isResolver=!0,t.resolve=function(s,i){return n(e,s,i)},t}}const ia=(n,e=!1)=>{function t(s,i){na(t)(s,i)}return t.$isResolver=!0,t.resolve=(s,i)=>i.getAll(n,e),t},Xc=Ei((n,e,t)=>{if(t.has(n,!0))return t.get(n)}),Wf=Ei((n,e,t)=>t.has(n,!1)?t.get(n):void 0),Tn=Ei((n,e,t)=>t.has(n,!1)?t.get(n):t.root.get(n)),zf=Ei((n,e,t)=>t.has(n,!1)?t.get(n):t.root.has(n,!1)?t.root.get(n):void 0),qf=Ei((n,e,t)=>t===t.root?t.getAll(n,!1):t.has(n,!1)?t.getAll(n,!1).concat(t.root.getAll(n,!1)):t.root.getAll(n,!1));function ln(n,e,t,s,i,r){function o(w){if(w!==void 0&&typeof w!="function")throw new TypeError("Function expected");return w}for(var a=s.kind,c=a==="getter"?"get":a==="setter"?"set":"value",l=n?s.static?n:n.prototype:null,h=l?Object.getOwnPropertyDescriptor(l,s.name):{},u,d=!1,p=t.length-1;p>=0;p--){var m={};for(var f in s)m[f]=f==="access"?{}:s[f];for(var f in s.access)m.access[f]=s.access[f];m.addInitializer=function(w){if(d)throw new TypeError("Cannot add initializers after decoration has completed");r.push(o(w||null))};var g=(0,t[p])(a==="accessor"?{get:h.get,set:h.set}:h[c],m);if(a==="accessor"){if(g===void 0)continue;if(g===null||typeof g!="object")throw new TypeError("Object expected");(u=o(g.get))&&(h.get=u),(u=o(g.set))&&(h.set=u),(u=o(g.init))&&i.unshift(u)}else(u=o(g))&&(a==="field"?i.unshift(u):h[c]=u)}l&&Object.defineProperty(l,s.name,h),d=!0}function Kf(n,e,t){for(var s=arguments.length>2,i=0;i<e.length;i++)t=s?e[i].call(n,t):e[i].call(n);return s?t:void 0}const ei=0,ti=1,si=2,xn=3,ni=4,ii=5,Qf=6,Yf=$i({trace:ei,debug:ti,info:si,warn:xn,error:ni,fatal:ii,none:Qf}),Gc=Is("ILogConfig",n=>n.instance(new ep("no-colors",xn))),Xf=Is("ISink"),Gf=Is("ILogEventFactory",n=>n.singleton(sp)),Xs=Is("ILogger",n=>n.singleton(np)),Jf=Is("ILogScope"),Zf=$i({key:ws("logger-sink-handles"),define(n,e){_i(e.handles,n,this.key)},getHandles(n){return Lt(this.key,n.constructor)}}),Jt=xo({red(n){return`\x1B[31m${n}\x1B[39m`},green(n){return`\x1B[32m${n}\x1B[39m`},yellow(n){return`\x1B[33m${n}\x1B[39m`},blue(n){return`\x1B[34m${n}\x1B[39m`},magenta(n){return`\x1B[35m${n}\x1B[39m`},cyan(n){return`\x1B[36m${n}\x1B[39m`},white(n){return`\x1B[37m${n}\x1B[39m`},grey(n){return`\x1B[90m${n}\x1B[39m`}});class ep{constructor(e,t){this.colorOptions=e,this.level=t}}const zr=(function(){const n={"no-colors":xo({TRC:"TRC",DBG:"DBG",INF:"INF",WRN:"WRN",ERR:"ERR",FTL:"FTL",QQQ:"???"}),colors:xo({TRC:Jt.grey("TRC"),DBG:Jt.grey("DBG"),INF:Jt.white("INF"),WRN:Jt.yellow("WRN"),ERR:Jt.red("ERR"),FTL:Jt.red("FTL"),QQQ:Jt.grey("???")})};return(e,t)=>e<=ei?n[t].TRC:e<=ti?n[t].DBG:e<=si?n[t].INF:e<=xn?n[t].WRN:e<=ni?n[t].ERR:e<=ii?n[t].FTL:n[t].QQQ})(),pl=(n,e)=>e==="no-colors"?n.join("."):n.map(Jt.cyan).join("."),qr=(n,e)=>e==="no-colors"?new Date(n).toISOString():Jt.grey(new Date(n).toISOString());class tp{constructor(e,t,s,i,r,o){this.severity=e,this.message=t,this.optionalParams=s,this.scope=i,this.colorOptions=r,this.timestamp=o}toString(){const{severity:e,message:t,scope:s,colorOptions:i,timestamp:r}=this;return s.length===0?`${qr(r,i)} [${zr(e,i)}] ${t}`:`${qr(r,i)} [${zr(e,i)} ${pl(s,i)}] ${t}`}getFormattedLogInfo(e=!1){const{severity:t,message:s,scope:i,colorOptions:r,timestamp:o,optionalParams:a}=this;let c=null,l="";e&&s instanceof Error?c=s:l=s;const h=i.length===0?"":` ${pl(i,r)}`;let u=`${qr(o,r)} [${zr(t,r)}${h}] ${l}`;if(a===void 0||a.length===0)return c===null?[u]:[u,c];let d=0;for(;u.includes("%s");)u=u.replace("%s",String(a[d++]));return c!==null?[u,c,...a.slice(d)]:[u,...a.slice(d)]}}class sp{constructor(){this.config=E(Gc)}createLogEvent(e,t,s,i){return new tp(t,s,i,e.scope,this.config.colorOptions,Date.now())}}let np=(()=>{var n;let e=[],t,s,i,r,o,a;return n=class{constructor(l=E(Gc),h=E(Gf),u=E(ia(Xf)),d=E(Xc(Jf))??[],p=null){this.scope=(Kf(this,e),d),this._scopedLoggers=de();let m,f,g,w,I,M;if(this.config=l,this._factory=h,this.sinks=u,p===null){this.root=this,this.parent=this,m=this._traceSinks=[],f=this._debugSinks=[],g=this._infoSinks=[],w=this._warnSinks=[],I=this._errorSinks=[],M=this._fatalSinks=[];for(const A of u){const S=Zf.getHandles(A);(S?.includes(ei)??!0)&&m.push(A),(S?.includes(ti)??!0)&&f.push(A),(S?.includes(si)??!0)&&g.push(A),(S?.includes(xn)??!0)&&w.push(A),(S?.includes(ni)??!0)&&I.push(A),(S?.includes(ii)??!0)&&M.push(A)}}else this.root=p.root,this.parent=p,m=this._traceSinks=p._traceSinks,f=this._debugSinks=p._debugSinks,g=this._infoSinks=p._infoSinks,w=this._warnSinks=p._warnSinks,I=this._errorSinks=p._errorSinks,M=this._fatalSinks=p._fatalSinks}trace(l,...h){this.config.level<=ei&&this._emit(this._traceSinks,ei,l,h)}debug(l,...h){this.config.level<=ti&&this._emit(this._debugSinks,ti,l,h)}info(l,...h){this.config.level<=si&&this._emit(this._infoSinks,si,l,h)}warn(l,...h){this.config.level<=xn&&this._emit(this._warnSinks,xn,l,h)}error(l,...h){this.config.level<=ni&&this._emit(this._errorSinks,ni,l,h)}fatal(l,...h){this.config.level<=ii&&this._emit(this._fatalSinks,ii,l,h)}scopeTo(l){const h=this._scopedLoggers;let u=h[l];return u===void 0&&(u=h[l]=new n(this.config,this._factory,null,this.scope.concat(l),this)),u}_emit(l,h,u,d){const p=ce(u)?u():u,m=this._factory.createLogEvent(this,h,p,d);for(let f=0,g=l.length;f<g;++f)l[f].handleEvent(m)}},(()=>{const c=typeof Symbol=="function"&&Symbol.metadata?Object.create(null):void 0;t=[an],s=[an],i=[an],r=[an],o=[an],a=[an],ln(n,null,t,{kind:"method",name:"trace",static:!1,private:!1,access:{has:l=>"trace"in l,get:l=>l.trace},metadata:c},null,e),ln(n,null,s,{kind:"method",name:"debug",static:!1,private:!1,access:{has:l=>"debug"in l,get:l=>l.debug},metadata:c},null,e),ln(n,null,i,{kind:"method",name:"info",static:!1,private:!1,access:{has:l=>"info"in l,get:l=>l.info},metadata:c},null,e),ln(n,null,r,{kind:"method",name:"warn",static:!1,private:!1,access:{has:l=>"warn"in l,get:l=>l.warn},metadata:c},null,e),ln(n,null,o,{kind:"method",name:"error",static:!1,private:!1,access:{has:l=>"error"in l,get:l=>l.error},metadata:c},null,e),ln(n,null,a,{kind:"method",name:"fatal",static:!1,private:!1,access:{has:l=>"fatal"in l,get:l=>l.fatal},metadata:c},null,e),c&&Object.defineProperty(n,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:c})})(),n})();const Jc="AccessThis",ip="AccessBoundary",ra="AccessGlobal",oa="AccessScope",rp="ArrayLiteral",op="ObjectLiteral",ap="PrimitiveLiteral",lp="New",cp="Template",hp="Unary",up="CallScope",dp="CallMember",fp="CallFunction",pp="CallGlobal",yr="AccessMember",Zc="AccessKeyed",gp="TaggedTemplate",mp="Binary",bp="Conditional",vp="Assign",_p="ArrowFunction",wp="ValueConverter",yp="BindingBehavior",eh="ArrayBindingPattern",th="ObjectBindingPattern",sh="BindingIdentifier",kp="ForOfStatement",Cp="Interpolation",nh="ArrayDestructuring",xp="ObjectDestructuring",Sp="DestructuringAssignmentLeaf",Ap="Custom";class ih{constructor(e){this.value=e,this.$kind=Ap}evaluate(...e){return this.value}assign(...e){return e}bind(...e){}unbind(...e){}accept(e){}}class $p{constructor(e,t,s){this.expression=e,this.name=t,this.args=s,this.$kind=yp,this.key=`_bb_${t}`}}class Ip{constructor(e,t,s){this.expression=e,this.name=t,this.args=s,this.$kind=wp}}class Tp{constructor(e,t,s="="){this.target=e,this.value=t,this.op=s,this.$kind=vp}}class Ep{constructor(e,t,s){this.condition=e,this.yes=t,this.no=s,this.$kind=bp}}class Mp{constructor(e){this.name=e,this.$kind=ra}}class ri{constructor(e=0){this.ancestor=e,this.$kind=Jc}}class Bp{constructor(){this.$kind=ip}}class oi{constructor(e,t=0){this.name=e,this.ancestor=t,this.$kind=oa}}const rh=n=>n.$kind===ra||(n.$kind===yr||n.$kind===Zc)&&n.accessGlobal;class So{constructor(e,t,s=!1){this.object=e,this.name=t,this.optional=s,this.$kind=yr,this.accessGlobal=rh(e)}}class oh{constructor(e,t,s=!1){this.object=e,this.key=t,this.optional=s,this.$kind=Zc,this.accessGlobal=rh(e)}}class Pp{constructor(e,t){this.func=e,this.args=t,this.$kind=lp}}class ah{constructor(e,t,s=0,i=!1){this.name=e,this.args=t,this.ancestor=s,this.optional=i,this.$kind=up}}class sr{constructor(e,t,s,i=!1,r=!1){this.object=e,this.name=t,this.args=s,this.optionalMember=i,this.optionalCall=r,this.$kind=dp}}class qi{constructor(e,t,s=!1){this.func=e,this.args=t,this.optional=s,this.$kind=fp}}class Rp{constructor(e,t){this.name=e,this.args=t,this.$kind=pp}}class Op{constructor(e,t,s){this.operation=e,this.left=t,this.right=s,this.$kind=mp}}class gl{constructor(e,t,s=0){this.operation=e,this.expression=t,this.pos=s,this.$kind=hp}}class Ve{constructor(e){this.value=e,this.$kind=ap}}Ve.$undefined=new Ve(void 0);Ve.$null=new Ve(null);Ve.$true=new Ve(!0);Ve.$false=new Ve(!1);Ve.$empty=new Ve("");class Ao{constructor(e){this.elements=e,this.$kind=rp}}Ao.$empty=new Ao(X);class $o{constructor(e,t){this.keys=e,this.values=t,this.$kind=op}}$o.$empty=new $o(X,X);class nr{constructor(e,t=X){this.cooked=e,this.expressions=t,this.$kind=cp}}nr.$empty=new nr([""]);class lh{constructor(e,t,s,i=X){this.cooked=e,this.func=s,this.expressions=i,this.$kind=gp,e.raw=t}}class Lp{constructor(e){this.elements=e,this.$kind=eh}}class Dp{constructor(e,t){this.keys=e,this.values=t,this.$kind=th}}class ir{constructor(e){this.name=e,this.$kind=sh}}class Fp{constructor(e,t,s){this.declaration=e,this.iterable=t,this.semiIdx=s,this.$kind=kp}}class Np{constructor(e,t=X){this.parts=e,this.expressions=t,this.$kind=Cp,this.isMulti=t.length>1,this.firstExpression=t[0]}}class jp{constructor(e,t,s,i){this.$kind=e,this.list=t,this.source=s,this.initializer=i}}class ch{constructor(e,t,s){this.target=e,this.source=t,this.initializer=s,this.$kind=Sp}}class Io{constructor(e,t,s=!1){this.args=e,this.body=t,this.rest=s,this.$kind=_p}}const To=String,Ki=()=>Object.create(null),ge=(n,...e)=>new Error(`AUR${To(n).padStart(4,"0")}: ${Hp(n,...e)}`),Vp={99:"Method {{0}} not implemented",101:'Ast eval error: binding behavior "{{0}}" could not be found. Did you forget to register it as a dependency?',102:'Ast eval error: binding behavior "{{0}}" already applied.',103:'Ast eval error: value converter "{{0}}" could not be found. Did you forget to register it as a dependency?',105:"Ast eval error: unable to find $host context. Did you forget [au-slot] attribute?",106:'Ast eval error: invalid assignment. "$host" is a reserved keyword.',107:"Ast eval error: expression is not a function.",109:'Ast eval error: unknown unary operator: "{{0}}"',108:'Ast eval error: unknown binary operator: "{{0}}"',110:"Ast eval error: left-hand side of tagged template expression is not a function.",111:'Ast eval error: expected "{{0}}" to be a function',112:"Ast eval error: cannot use non-object value for destructuring assignment.",151:'Expression error: invalid start: "{{0}}"',152:'Expression error: spread operator is not supported: "{{0}}"',153:'Expression error: expected identifier: "{{0}}"',154:'Expression error: invalid member expression: "{{0}}"',155:'Expression error: unexpected end of expression: "{{0}}"',156:'Expression error: unconsumed token: "{{0}}" at position {{1}} of "{{2}}"',157:"Expression error: invalid empty expression. Empty expression is only valid in event bindings (trigger, delegate, capture etc...)",158:'Expression error: left hand side of expression is not assignable: "{{0}}"',159:'Expression error: expected identifier to come after value converter operator: "{{0}}"',160:"Expression error: expected identifier to come after binding behavior operator: {{0}}",161:'Expression error: unexpected keyword "of": "{{0}}"',162:'Expression error: unexpected keyword "import": "{{0}}"',163:'Expression error: invalid BindingIdentifier at left hand side of "of": "{{0}}" | kind: {{1}}',164:'Expression error: invalid or unsupported property definition in object literal: "{{0}}"',165:'Expression error: unterminated quote in string literal: "{{0}}"',166:'Expression error: unterminated template string: "{{0}}"',167:'Expression error: missing expected token "{{0}}" in "{{1}}"',168:'Expression error: unexpected character: "{{0}}"',170:'Expression error: unexpected "{{0}}" at position "{{1}}" for destructuring assignment in "{{2}}"',171:'Expression error: unexpected {{0}} at position "{{1}}" for optional chain in "{{2}}"',172:'Expression error: invalid tagged template on optional chain in "{{1}}"',173:'Expression error: invalid arrow parameter list in "{{0}}"',174:'Expression error: arrow function with default parameters is not supported: "{{0}}"',175:'Expression error: arrow function with destructuring parameters is not supported: "{{0}}"',176:'Expression error: rest parameter must be last formal parameter in arrow function: "{{0}}"',178:'Expression error: arrow function with function body is not supported: "{{0}}"',179:`Expression error: unexpected token '.' at position "{{1}}" in "{{0}}"`},Hp=(n,...e)=>{let t=Vp[n];for(let s=0;s<e.length;++s){const i=new RegExp(`{{${s}(:.*)?}}`,"g");let r=i.exec(t);for(;r!=null;){const o=r[1]?.slice(1);let a=e[s];if(a!=null)switch(o){case"toString":a=Object.prototype.toString.call(a);break;case"join(!=)":a=a.join("!=");break;case"element":a=a==="*"?"all elements":`<${a} />`;break;default:o?.startsWith(".")?a=To(a[o.slice(1)]):a=To(a)}t=t.slice(0,r.index)+a+t.slice(i.lastIndex),r=i.exec(t)}}return t},Ln=Ts.createInterface("IExpressionParser");class hh{constructor(){this._expressionLookup=Ki(),this._forOfLookup=Ki(),this._interpolationLookup=Ki()}parse(e,t){let s;switch(t){case fh:return new ih(e);case rr:return s=this._interpolationLookup[e],s===void 0&&(s=this._interpolationLookup[e]=this.$parse(e,t)),s;case es:return s=this._forOfLookup[e],s===void 0&&(s=this._forOfLookup[e]=this.$parse(e,t)),s;default:{if(e.length===0){if(t===Kp||t===ml)return Ve.$empty;throw cg()}return s=this._expressionLookup[e],s===void 0&&(s=this._expressionLookup[e]=this.$parse(e,t)),s}}}$parse(e,t){return oe=e,J=0,Dt=e.length,lt=0,Gs=0,R=6291456,ve="",fe=Js(0),le=!0,re=!1,Kn=!0,la=-1,Se(61,t===void 0?ml:t)}}hh.register=Ii(Ln);function aa(n){switch(n){case 98:return 8;case 116:return 9;case 110:return 10;case 118:return 11;case 102:return 12;case 114:return 13;case 34:return 34;case 39:return 39;case 92:return 92;default:return n}}const Up=Ve.$false,Wp=Ve.$true,zp=Ve.$null,uh=Ve.$undefined,ai=new ri(0),Kr=new ri(1),qp=new Bp,ss="None",rr="Interpolation",es="IsIterator",dh="IsChainable",Kp="IsFunction",ml="IsProperty",fh="IsCustom";let oe="",J=0,Dt=0,lt=0,Gs=0,R=6291456,ve="",fe,le=!0,re=!1,Kn=!0,la=-1;const Ci=String.fromCharCode,Js=n=>oe.charCodeAt(n),ns=()=>oe.slice(Gs,J),Qp="Infinity NaN isFinite isNaN parseFloat parseInt decodeURI decodeURIComponent encodeURI encodeURIComponent Array BigInt Boolean Date Map Number Object RegExp Set String JSON Math Intl".split(" ");function Se(n,e){if(e===fh)return new ih(oe);if(J===0){if(e===rr)return sg();if(V(),R&4194304)throw og()}le=577>n,re=!1,Kn=579>n;let t=!1,s,i=0;if(R&131072){const r=un[R&63];V(),s=new gl(r,Se(579,e)),le=!1}else{e:switch(R){case 12296:i=lt,le=!1,Kn=!1;do switch(V(),++i,R){case 65547:if(V(),(R&12288)===0)throw Yt();break;case 12:case 13:throw Yt();case 2162702:if(re=!0,V(),(R&12288)===0){s=i===0?ai:i===1?Kr:new ri(i),t=!0;break e}break;default:if(R&2097152){s=i===0?ai:i===1?Kr:new ri(i);break e}throw ag()}while(R===12296);case 4096:{const r=ve;if(e===es)s=new ir(r);else if(Kn&&Qp.includes(r))s=new Mp(r);else{if(Kn&&r==="import")throw pg();s=new oi(r,i)}if(le=!re,V(),Et(53)){if(R===524298)throw vh();const o=re,a=lt;++lt;const c=Se(62,ss);re=o,lt=a,le=!1,s=new Io([new ir(r)],c)}break}case 12:throw _g();case 13:throw Eo();case 12293:switch(le=!1,V(),lt){case 0:s=ai;break;case 1:s=Kr;break;default:s=new ri(lt);break}break;case 12294:le=!1,V(),s=qp;break;case 2688009:s=Gp(e);break;case 2688020:s=oe.search(/\s+of\s+/)>J?Yp():Jp(e);break;case 524298:s=tg(e);break;case 2163762:s=new nr([ve]),le=!1,V();break;case 2163763:s=Qr(e,s,!1);break;case 16384:case 32768:s=new Ve(ve),le=!1,V();break;case 8194:case 8195:case 8193:case 8192:s=un[R&63],le=!1,V();break;case 8196:{V();const r=Se(578,e);let o;R===2688009?o=bt():(o=[],V()),s=new Pp(r,o),le=!1;break}default:throw J>=Dt?lg():Yr()}if(e===es)return eg(s);switch(R){case 2228282:case 2228283:s=new gl(un[R&63],s,1),V(),le=!1;break}if(579<n)return s;if(R===12||R===13)throw Yt();if(s.$kind===Jc)switch(R){case 2162702:if(re=!0,le=!1,V(),(R&13312)===0)throw ca();if(R&12288)s=new oi(ve,s.ancestor),V();else if(R===2688009)s=new qi(s,bt(),!0);else if(R===2688020)s=Qi(s,!0);else throw Yi();break;case 65547:if(le=!re,V(),(R&12288)===0)throw Yt();s=new oi(ve,s.ancestor),V();break;case 12:case 13:throw Yt();case 2688009:s=new qi(s,bt(),t);break;case 2688020:s=Qi(s,t);break;case 2163762:s=bl(s);break;case 2163763:s=Qr(e,s,!0);break}for(;(R&65536)>0;)switch(R){case 2162702:s=Xp(s);break;case 65547:if(V(),(R&12288)===0)throw Yt();s=ph(s,!1);break;case 12:case 13:throw Yt();case 2688009:if(n===578)return s;s.$kind===oa?s=new ah(s.name,bt(),s.ancestor,!1):s.$kind===yr?s=new sr(s.object,s.name,bt(),s.optional,!1):s.$kind===ra?s=new Rp(s.name,bt()):s=new qi(s,bt(),!1);break;case 2688020:s=Qi(s,!1);break;case 2163762:if(re)throw Yi();s=bl(s);break;case 2163763:if(re)throw Yi();s=Qr(e,s,!0);break}}if(R===12||R===13)throw Yt();if(577<n)return s;for(;(R&262144)>0;){const r=R;if((r&960)<=n)break;V(),s=new Op(un[r&63],s,Se(r&960,e)),le=!1}if(63<n)return s;if(Et(6291480)){const r=Se(62,e);xt(6291478),s=new Ep(s,r,Se(62,e)),le=!1}if(62<n)return s;switch(R){case 4194352:case 4194358:case 4194359:case 4194360:case 4194361:{if(!le)throw hg();const r=un[R&63];V(),s=new Tp(s,Se(62,e),r);break}}if(61<n)return s;for(;Et(6291482);){if(R===6291456)throw ug();const r=ve;V();const o=new Array;for(;Et(6291478);)o.push(Se(62,e));s=new Ip(s,r,o)}for(;Et(6291481);){if(R===6291456)throw dg();const r=ve;V();const o=new Array;for(;Et(6291478);)o.push(Se(62,e));s=new $p(s,r,o)}if(R!==6291456){if(e===rr&&R===7340047)return s;if(e===dh&&R===6291479){if(J===Dt)throw Yr();return la=J-1,s}throw ns()==="of"?fg():Yr()}return s}function Yp(){const n=[],e=new jp(nh,n,void 0,void 0);let t="",s=!0,i=0;for(;s;)switch(V(),R){case 7340053:s=!1,r();break;case 6291475:r();break;case 4096:t=ns();break;default:throw bg()}return xt(7340053),e;function r(){t!==""?(n.push(new ch(new So(ai,t),new oh(ai,new Ve(i++)),void 0)),t=""):i++}}function bt(){const n=re;V();const e=[];for(;R!==7340048&&(e.push(Se(62,ss)),!!Et(6291475)););return xt(7340048),le=!1,re=n,e}function Qi(n,e){const t=re;return V(),n=new oh(n,Se(62,ss),e),xt(7340053),le=!t,re=t,n}function Xp(n){if(re=!0,le=!1,V(),(R&13312)===0)throw ca();if(R&12288)return ph(n,!0);if(R===2688009)return n.$kind===oa?new ah(n.name,bt(),n.ancestor,!0):n.$kind===yr?new sr(n.object,n.name,bt(),n.optional,!0):new qi(n,bt(),!0);if(R===2688020)return Qi(n,!0);throw Yi()}function ph(n,e){const t=ve;switch(R){case 2162702:{re=!0,le=!1;const s=J,i=Gs,r=R,o=fe,a=ve,c=le,l=re;if(V(),(R&13312)===0)throw ca();return R===2688009?new sr(n,t,bt(),e,!0):(J=s,Gs=i,R=r,fe=o,ve=a,le=c,re=l,new So(n,t,e))}case 2688009:return le=!1,new sr(n,t,bt(),e,!1);default:return le=!re,V(),new So(n,t,e)}}function Gp(n){V();const e=J,t=Gs,s=R,i=fe,r=ve,o=re,a=[];let c=1,l=!1;e:for(;;){if(R===13){if(V(),R!==4096)throw Yt();if(a.push(new ir(ve)),V(),R===6291475)throw vg();if(R!==7340048||(V(),R!==53))throw Eo();V();const d=re,p=lt;++lt;const m=Se(62,ss);return re=d,lt=p,le=!1,new Io(a,m,!0)}switch(R){case 4096:a.push(new ir(ve)),V();break;case 7340048:V();break e;case 524298:case 2688020:V(),c=4;break;case 6291475:c=2,l=!0;break e;case 2688009:c=2;break e;default:V(),c=2;break}switch(R){case 6291475:if(V(),l=!0,c===1)break;break e;case 7340048:V();break e;case 4194352:c===1&&(c=3);break e;case 53:if(l)throw Di();V(),c=2;break e;default:c===1&&(c=2);break e}}if(R===53){if(c===1){if(V(),R===524298)throw vh();const d=re,p=lt;++lt;const m=Se(62,ss);return re=d,lt=p,le=!1,new Io(a,m)}throw Di()}else if(c===1&&a.length===0)throw bh(53);if(l)switch(c){case 2:throw Di();case 3:throw wl();case 4:throw yl()}J=e,Gs=t,R=s,fe=i,ve=r,re=o;const h=re,u=Se(62,n);if(re=h,xt(7340048),R===53)switch(c){case 2:throw Di();case 3:throw wl();case 4:throw yl()}return u}function Jp(n){const e=re;V();const t=new Array;for(;R!==7340053;)if(Et(6291475)){if(t.push(uh),R===7340053)break}else if(t.push(Se(62,n===es?ss:n)),Et(6291475)){if(R===7340053)break}else break;return re=e,xt(7340053),n===es?new Lp(t):(le=!1,new Ao(t))}const Zp=[eh,th,sh,nh,xp];function eg(n){if(!Zp.includes(n.$kind)||R!==4204596)throw _l(n.$kind);V();const e=n,t=Se(61,dh);return new Fp(e,t,la)}function tg(n){const e=re,t=new Array,s=new Array;for(V();R!==7340047;){if(t.push(ve),R&49152)V(),xt(6291478),s.push(Se(62,n===es?ss:n));else if(R&12288){const i=fe,r=R,o=J;V(),Et(6291478)?s.push(Se(62,n===es?ss:n)):(fe=i,R=r,J=o,s.push(Se(580,n===es?ss:n)))}else throw gg();R!==7340047&&xt(6291475)}return re=e,xt(7340047),n===es?new Dp(t,s):(le=!1,new $o(t,s))}function sg(){const n=[],e=[],t=Dt;let s="";for(;J<t;){switch(fe){case 36:if(Js(J+1)===123){n.push(s),s="",J+=2,fe=Js(J),V();const i=Se(61,rr);e.push(i);continue}else s+="$";break;case 92:s+=Ci(aa(W()));break;default:s+=Ci(fe)}W()}return e.length?(n.push(s),new Np(n,e)):null}function Qr(n,e,t){const s=re,i=[ve];xt(2163763);const r=[Se(62,n)];for(;(R=rg())!==2163762;)i.push(ve),xt(2163763),r.push(Se(62,n));return i.push(ve),le=!1,re=s,t?(V(),new lh(i,i,e,r)):(V(),new nr(i,r))}function bl(n){le=!1;const e=[ve];return V(),new lh(e,e,n)}function V(){for(;J<Dt;)if(Gs=J,(R=yg[fe]())!=null)return;R=6291456}function W(){return fe=Js(++J)}function ng(){for(;kg[W()];);const n=wg[ve=ns()];return n===void 0?4096:n}function vl(n){let e=fe;if(n===!1){do e=W();while(e<=57&&e>=48);if(e!==46)return ve=parseInt(ns(),10),32768;if(e=W(),J>=Dt)return ve=parseInt(ns().slice(0,-1),10),32768}if(e<=57&&e>=48)do e=W();while(e<=57&&e>=48);else fe=Js(--J);return ve=parseFloat(ns()),32768}function ig(){const n=fe;W();let e=0;const t=new Array;let s=J;for(;fe!==n;)if(fe===92)t.push(oe.slice(s,J)),W(),e=aa(fe),W(),t.push(Ci(e)),s=J;else{if(J>=Dt)throw mg();W()}const i=oe.slice(s,J);return W(),t.push(i),ve=t.join(""),16384}function gh(){let n=!0,e="";for(;W()!==96;)if(fe===36)if(J+1<Dt&&Js(J+1)===123){J++,n=!1;break}else e+="$";else if(fe===92)e+=Ci(aa(W()));else{if(J>=Dt)throw mh();e+=Ci(fe)}return W(),ve=e,n?2163762:2163763}const rg=()=>{if(J>=Dt)throw mh();return J--,gh()},Et=n=>R===n?(V(),!0):!1,xt=n=>{if(R===n)V();else throw bh(n)},og=()=>ge(151,oe),Eo=()=>ge(152,oe),Yt=()=>ge(153,oe),ag=()=>ge(154,oe),lg=()=>ge(155,oe),Yr=()=>ge(156,ns(),J,oe),cg=()=>ge(157),hg=()=>ge(158,oe),ug=()=>ge(159,oe),dg=()=>ge(160,oe),fg=()=>ge(161,oe),pg=()=>ge(162,oe),_l=n=>ge(163,oe,n),gg=()=>ge(164,oe),mg=()=>ge(165,oe),mh=()=>ge(166,oe),bh=n=>ge(167,un[n&63],oe),bg=()=>ge(170,ns(),J,oe),ca=()=>ge(171,ns(),J-1,oe),Yi=()=>ge(172,oe),Di=()=>ge(173,oe),wl=()=>ge(174,oe),yl=()=>ge(175,oe),vg=()=>ge(176,oe),vh=()=>ge(178,oe),_g=()=>ge(179,J-1,oe),un=[Up,Wp,zp,uh,"new","this","$this",null,"$parent","(","{",".","..","...","?.","}",")",",","[","]",":",";","?","'",'"',"&","|","??","||","&&","==","!=","===","!==","<",">","<=",">=","in","instanceof","+","-","typeof","void","*","%","/","**","=","!",2163762,2163763,"of","=>","+=","-=","*=","/=","++","--"],wg=Object.assign(Ki(),{true:8193,null:8194,false:8192,undefined:8195,new:8196,this:12294,$this:12293,$parent:12296,in:6562214,instanceof:6562215,typeof:139306,void:139307,of:4204596}),{CharScanners:yg,IdParts:kg}=(()=>{const n=()=>{throw ge(168,oe)};n.notMapped=!0;const e={IdStart:[36,0,65,91,95,0,97,123,170,0,186,0,192,215,216,247,248,697,736,741,7424,7462,7468,7517,7522,7526,7531,7544,7545,7615,7680,7936,8305,0,8319,0,8336,8349,8490,8492,8498,0,8526,0,8544,8585,11360,11392,42786,42888,42891,42927,42928,42936,42999,43008,43824,43867,43868,43877,64256,64263,65313,65339,65345,65371],Digit:[48,58],Skip:[0,33,127,161]},t=(o,a,c,l)=>{const h=c.length;for(let u=0;u<h;u+=2){const d=c[u];let p=c[u+1];p=p>0?p:d+1,o&&o.fill(l,d,p)}},s=(o=>(t(o,null,e.IdStart,1),t(o,null,e.Digit,1),o))(new Uint8Array(65535)),i=o=>()=>(W(),o),r=new Array(65535);return r.fill(n,0,65535),t(r,null,e.Skip,()=>(W(),null)),t(r,null,e.IdStart,ng),t(r,null,e.Digit,()=>vl(!1)),r[34]=r[39]=()=>ig(),r[96]=()=>gh(),r[33]=()=>W()!==61?131121:W()!==61?6553951:(W(),6553953),r[61]=()=>W()===62?(W(),53):fe!==61?4194352:W()!==61?6553950:(W(),6553952),r[38]=()=>W()!==38?6291481:(W(),6553885),r[124]=()=>W()!==124?6291482:(W(),6553820),r[63]=()=>{if(W()===46){const o=Js(J+1);return o<=48||o>=57?(W(),2162702):6291480}return fe!==63?6291480:(W(),6553755)},r[46]=()=>W()<=57&&fe>=48?vl(!0):fe===46?W()!==46?12:(W(),13):65547,r[60]=()=>W()!==61?6554018:(W(),6554020),r[62]=()=>W()!==61?6554019:(W(),6554021),r[37]=i(6554157),r[40]=i(2688009),r[41]=i(7340048),r[42]=()=>W()===61?(W(),4194360):fe===42?(W(),6554223):6554156,r[43]=()=>W()===43?(W(),2228282):fe!==61?2490856:(W(),4194358),r[44]=i(6291475),r[45]=()=>W()===45?(W(),2228283):fe!==61?2490857:(W(),4194359),r[47]=()=>W()!==61?6554158:(W(),4194361),r[58]=i(6291478),r[59]=i(6291479),r[91]=i(2688020),r[93]=i(7340053),r[123]=i(524298),r[125]=i(7340047),{CharScanners:r,IdParts:s}})(),Ut=Ts.createInterface,Dn=Object.freeze,{aliasTo:kl,singleton:ha}=Ys,Ct="Interpolation",_h="IsFunction",Wt="IsProperty",dn="custom-element",Mi=Dn({default:0,oneTime:1,toView:2,fromView:4,twoWay:6}),kr=Ut("ITemplateCompiler"),wh=Ut("IAttrMapper"),xe=(n,...e)=>{const t=String(n).padStart(4,"0"),s=xg(n,...e),i=`https://docs.aurelia.io/developer-guides/error-messages/0088-to-0723/aur${t}`;return new Error(`AUR${t}: ${s}

For more information, see: ${i}`)},Cg={88:"AttributeParser is already initialized; cannot add patterns after initialization.",89:'Attribute pattern "{{0}}" has already been registered.',99:"Method {{0}} not implemented",157:"Binding command {{0}} has already been registered.",701:'Template compilation error in element "{{0:name}}": the root <template> cannot be a local element template.',702:'Template compilation error: attribute "{{0}}" is invalid on element surrogate.',703:'Template compilation error: template controller "{{0}}" is invalid on element surrogate.',704:'Template compilation error: Invalid command "{{0:.command}}" for <let>. Only to-view/bind supported.',706:'Template compilation error: detected projection with [au-slot="{{0}}"] attempted on a non custom element {{1}}.',707:"Template compilation error: creating binding to non-bindable property {{0}} on {{1}}.",708:'Template compilation error: the custom element "{{0}}" does not have any content other than local template(s).',709:'Template compilation error: local element template needs to be defined directly under root of element "{{0}}".',710:'Template compilation error: bindable properties of local element "{{0}}" template needs to be defined directly under <template>.',711:`Template compilation error: the attribute 'property' is missing in {{0:outerHTML}} in local element "{{1}}"`,712:"Template compilation error: Bindable property and attribute needs to be unique; found property: {{0}}, attribute: {{1}}",713:'Template compilation error: unknown binding command: "{{0}}".{{0:bindingCommandHelp}}',714:'Template compilation error: primary already exists on element/attribute "{{0}}"',715:'Template compilation error: the value of "as-custom-element" attribute cannot be empty for local element in element "{{0}}"',716:'Template compilation error: duplicate definition of the local template named "{{0}} in element {{1}}"',717:'Template compilation error: detected a usage of "<slot>" element without specifying shadow DOM options in element: {{0}}',718:'Spreading template controller "{{0}}" is not supported.',719:"Attribute {{0}} has been already registered for {{1:element}}",720:'Spreading syntax "...xxx" is reserved. Encountered "...{{0}}"',721:'Usage of $bindables is only allowed on custom element. Encountered: <{{0}} {{1}}="{{2}}">',722:"Invalid platform object provided to the compilation, no DOM API found.",723:"Template compilation error: Invalid comma-separated class binding syntax in {{0}}. It resulted in no valid class names after parsing.",9998:"Spread binding does not support spreading custom attributes/template controllers. Did you build the spread instruction manually?"},xg=(n,...e)=>{let t=Cg[n];for(let s=0;s<e.length;++s){const i=new RegExp(`{{${s}(:.*)?}}`,"g");let r=i.exec(t);for(;r!=null;){const o=r[1]?.slice(1);let a=e[s];if(a!=null)switch(o){case"nodeName":a=a.nodeName.toLowerCase();break;case"name":a=a.name;break;case"typeof":a=typeof a;break;case"ctor":a=a.constructor.name;break;case"controller":a=a.controller.name;break;case"target@property":a=`${a.target}@${a.targetProperty}`;break;case"toString":a=Object.prototype.toString.call(a);break;case"join(!=)":a=a.join("!=");break;case"bindingCommandHelp":a=Sg(a);break;case"element":a=a==="*"?"all elements":`<${a} />`;break;default:o?.startsWith(".")?a=String(a[o.slice(1)]):a=String(a)}t=t.slice(0,r.index)+a+t.slice(i.lastIndex),r=i.exec(t)}}return t};function Sg(n){switch(n){case"delegate":return`
The ".delegate" binding command has been removed in v2. Binding command ".trigger" should be used instead. If you are migrating v1 application, install compat package to add back the ".delegate" binding command for ease of migration.`;case"call":return`
The ".call" binding command has been removed in v2. If you want to pass a callback that preserves the context of the function call, you can use lambda instead. Refer to lambda expression doc for more details.`;default:return""}}var yh,kh,Ch,xh,Sh;class ua{constructor(e,t,s,i){if(this.chars=e,this.repeat=t,this.isSymbol=s,this.isInverted=i,i)switch(e.length){case 0:this.has=this._hasOfNoneInverse;break;case 1:this.has=this._hasOfSingleInverse;break;default:this.has=this._hasOfMultipleInverse}else switch(e.length){case 0:this.has=this._hasOfNone;break;case 1:this.has=this._hasOfSingle;break;default:this.has=this._hasOfMultiple}}equals(e){return this.chars===e.chars&&this.repeat===e.repeat&&this.isSymbol===e.isSymbol&&this.isInverted===e.isInverted}_hasOfMultiple(e){return this.chars.includes(e)}_hasOfSingle(e){return this.chars===e}_hasOfNone(e){return!1}_hasOfMultipleInverse(e){return!this.chars.includes(e)}_hasOfSingleInverse(e){return this.chars!==e}_hasOfNoneInverse(e){return!0}}class Ag{constructor(){this.parts=X,this._pattern="",this._currentRecord={},this._partsRecord={}}get pattern(){const e=this._pattern;return e===""?null:e}set pattern(e){e==null?(this._pattern="",this.parts=X):(this._pattern=e,this.parts=this._partsRecord[e])}append(e,t){const s=this._currentRecord;s[e]===void 0?s[e]=t:s[e]+=t}next(e){const t=this._currentRecord;let s;t[e]!==void 0&&(s=this._partsRecord,s[e]===void 0?s[e]=[t[e]]:s[e].push(t[e]),t[e]=void 0)}}class da{get _pattern(){return this._isEndpoint?this._patterns[0]:null}constructor(e,...t){this.charSpec=e,this._nextStates=[],this._types=null,this._isEndpoint=!1,this._patterns=t}findChild(e){const t=this._nextStates,s=t.length;let i=null,r=0;for(;r<s;++r)if(i=t[r],e.equals(i.charSpec))return i;return null}append(e,t){const s=this._patterns;s.includes(t)||s.push(t);let i=this.findChild(e);return i==null&&(i=new da(e,t),this._nextStates.push(i),e.repeat&&i._nextStates.push(i)),i}findMatches(e,t){const s=[],i=this._nextStates,r=i.length;let o=0,a=null,c=0,l=0;for(;c<r;++c)if(a=i[c],a.charSpec.has(e))if(s.push(a),o=a._patterns.length,l=0,a.charSpec.isSymbol)for(;l<o;++l)t.next(a._patterns[l]);else for(;l<o;++l)t.append(a._patterns[l],e);return s}}class Cl{constructor(e){this.text=e;const t=this._len=e.length,s=this._specs=[];let i=0;for(;t>i;++i)s.push(new ua(e[i],!1,!1,!1))}eachChar(e){const t=this._len,s=this._specs;let i=0;for(;t>i;++i)e(s[i])}}class $g{constructor(e){this.text="PART",this._spec=new ua(e,!0,!1,!0)}eachChar(e){e(this._spec)}}class Ig{constructor(e){this.text=e,this._spec=new ua(e,!1,!0,!1)}eachChar(e){e(this._spec)}}class Tg{constructor(){this.statics=0,this.dynamics=0,this.symbols=0}}const Eg=Ut("ISyntaxInterpreter",n=>n.singleton(Mg));class Mg{constructor(){this._rootState=new da(null),this._initialStates=[this._rootState]}add(e){e=e.slice(0).sort((d,p)=>d.pattern>p.pattern?1:-1);const t=e.length;let s,i,r,o,a,c,l,h=0,u;for(;t>h;){for(s=this._rootState,i=e[h],r=i.pattern,o=new Tg,a=this._parse(i,o),c=a.length,l=d=>s=s.append(d,r),u=0;c>u;++u)a[u].eachChar(l);s._types=o,s._isEndpoint=!0,++h}}interpret(e){const t=new Ag,s=e.length;let i=this._initialStates,r=0,o;for(;r<s&&(i=this._getNextStates(i,e.charAt(r),t),i.length!==0);++r);return i=i.filter(Bg),i.length>0&&(i.sort(Pg),o=i[0],o.charSpec.isSymbol||t.next(o._pattern),t.pattern=o._pattern),t}_getNextStates(e,t,s){const i=[];let r=null;const o=e.length;let a=0;for(;a<o;++a)r=e[a],i.push(...r.findMatches(t,s));return i}_parse(e,t){const s=[],i=e.pattern,r=i.length,o=e.symbols;let a=0,c=0,l="";for(;a<r;)l=i.charAt(a),o.length===0||!o.includes(l)?a===c&&l==="P"&&i.slice(a,a+4)==="PART"?(c=a=a+4,s.push(new $g(o)),++t.dynamics):++a:a!==c?(s.push(new Cl(i.slice(c,a))),++t.statics,c=a):(s.push(new Ig(i.slice(c,a+1))),++t.symbols,c=++a);return c!==a&&(s.push(new Cl(i.slice(c,a))),++t.statics),s}}function Bg(n){return n._isEndpoint}function Pg(n,e){const t=n._types,s=e._types;return t.statics!==s.statics?s.statics-t.statics:t.dynamics!==s.dynamics?s.dynamics-t.dynamics:t.symbols!==s.symbols?s.symbols-t.symbols:0}class ut{constructor(e,t,s,i,r=null){this.rawName=e,this.rawValue=t,this.target=s,this.command=i,this.parts=r}}const Rg=Ut("IAttributePattern"),fa=Ut("IAttributeParser",n=>n.singleton(Og));class Og{constructor(){this._cache={},this._patterns={},this._initialized=!1,this._allDefinitions=[],this._interpreter=E(Eg),this._container=E(Ti)}registerPattern(e,t){if(this._initialized)throw xe(88);const s=this._patterns;for(const{pattern:i}of e){if(s[i]!=null)throw xe(89,i);s[i]={patternType:t}}this._allDefinitions.push(...e)}_initialize(){this._interpreter.add(this._allDefinitions);const e=this._container;for(const[,t]of Object.entries(this._patterns))t.pattern=e.get(t.patternType)}parse(e,t){this._initialized||(this._initialize(),this._initialized=!0);let s=this._cache[e];s==null&&(s=this._cache[e]=this._interpreter.interpret(e));const i=s.pattern;return i==null?new ut(e,t,e,null,null):this._patterns[i].pattern[i](e,t,s.parts)}}const Es=Dn({name:rn("attribute-pattern"),create(n,e){return{register(t){t.get(fa).registerPattern(n,e),ha(Rg,e).register(t)}}}});class Mo{"PART.PART"(e,t,s){return new ut(e,t,s[0],s[1])}"PART.PART.PART"(e,t,s){return new ut(e,t,`${s[0]}.${s[1]}`,s[2])}}yh=Symbol.metadata;Mo[yh]={[Ht]:Es.create([{pattern:"PART.PART",symbols:"."},{pattern:"PART.PART.PART",symbols:"."}],Mo)};class Bo{ref(e,t,s){return new ut(e,t,"element","ref")}"PART.ref"(e,t,s){let i=s[0];return i==="view-model"&&(i="component",console.warn(`[aurelia] Detected view-model.ref usage: "${e}=${t}". This is deprecated and component.ref should be used instead`)),new ut(e,t,i,"ref")}}kh=Symbol.metadata;Bo[kh]={[Ht]:Es.create([{pattern:"ref",symbols:""},{pattern:"PART.ref",symbols:"."}],Bo)};class Po{"PART.trigger:PART"(e,t,s){return new ut(e,t,s[0],"trigger",s)}"PART.capture:PART"(e,t,s){return new ut(e,t,s[0],"capture",s)}}Ch=Symbol.metadata;Po[Ch]={[Ht]:Es.create([{pattern:"PART.trigger:PART",symbols:".:"},{pattern:"PART.capture:PART",symbols:".:"}],Po)};class xl{":PART"(e,t,s){return new ut(e,t,s[0],"bind")}}xh=Symbol.metadata;xl[xh]={[Ht]:Es.create([{pattern:":PART",symbols:":"}],xl)};class Sl{"@PART"(e,t,s){return new ut(e,t,s[0],"trigger")}"@PART:PART"(e,t,s){return new ut(e,t,s[0],"trigger",[s[0],"trigger",...s.slice(1)])}}Sh=Symbol.metadata;Sl[Sh]={[Ht]:Es.create([{pattern:"@PART",symbols:"@"},{pattern:"@PART:PART",symbols:"@:"}],Sl)};const Ro=as.get,Al=as.define,Ah="ra",$h="rb",Ih="rc",Th="rd",Eh="re",Mh="rf",pa="rg",Bh="ri",Ph="rj",Rh="rk",Oh="rl",Lh="ha",Dh="hb",Fh="hc",Lg="hd",Nh="he",jh="hf",Vh="hg",Hh="hs",Uh="hp",Wh="svb",Le=Dn({hydrateElement:Ah,hydrateAttribute:$h,hydrateTemplateController:Ih,hydrateLetElement:Th,setProperty:Eh,interpolation:Mh,propertyBinding:pa,letBinding:Bh,refBinding:Ph,iteratorBinding:Rh,multiAttr:Oh,textBinding:Lh,listenerBinding:Dh,attributeBinding:Fh,stylePropertyBinding:Lg,setAttribute:Nh,setClassAttribute:jh,setStyleAttribute:Vh,spreadTransferedBinding:Hh,spreadElementProp:Uh,spreadValueBinding:Wh}),Fn=Ut("Instruction");class Kt{constructor(e,t){this.from=e,this.to=t,this.type=Mh}}class Bi{constructor(e,t,s){this.from=e,this.to=t,this.mode=s,this.type=pa}}class Dg{constructor(e,t,s){this.forOf=e,this.to=t,this.props=s,this.type=Rh}}class Fg{constructor(e,t){this.from=e,this.to=t,this.type=Ph}}class cn{constructor(e,t){this.value=e,this.to=t,this.type=Eh}}class Ng{constructor(e,t,s){this.value=e,this.to=t,this.command=s,this.type=Oh}}class jg{constructor(e,t,s,i,r,o){this.res=e,this.props=t,this.projections=s,this.containerless=i,this.captures=r,this.data=o,this.type=Ah}}class Xr{constructor(e,t,s){this.res=e,this.alias=t,this.props=s,this.type=$h}}class Vg{constructor(e,t,s,i){this.def=e,this.res=t,this.alias=s,this.props=i,this.type=Ih}}class Hg{constructor(e,t){this.instructions=e,this.toBindingContext=t,this.type=Th}}class $l{constructor(e,t){this.from=e,this.to=t,this.type=Bh}}class Ug{constructor(e){this.from=e,this.type=Lh}}class zh{constructor(e,t,s,i){this.from=e,this.to=t,this.capture=s,this.modifier=i,this.type=Dh}}class Il{constructor(e,t){this.value=e,this.to=t,this.type=Nh}}class Tl{constructor(e){this.value=e,this.type=jh}}class El{constructor(e){this.value=e,this.type=Vh}}class ga{constructor(e,t,s){this.attr=e,this.from=t,this.to=s,this.type=Fh}}class Ml{constructor(){this.type=Hh}}class Bl{constructor(e){this.instruction=e,this.type=Uh}}class Oo{constructor(e,t){this.target=e,this.from=t,this.type=Wh}}class or{constructor(e,t,s,i){this.Type=e,this.name=t,this.aliases=s,this.key=i}static create(e,t){let s,i;return se(e)?(s=e,i={name:s}):(s=e.name,i=e),new or(t,gs(Lo(t,"name"),s),Be(Lo(t,"aliases"),i.aliases,t.aliases),Sn(s))}register(e,t){const s=this.Type,i=typeof t=="string"?Sn(t):this.key,r=this.aliases;e.has(i,!1)?console.warn(`[DEV:aurelia] ${xe(157,this.name)}`):e.register(e.has(s,!1)?null:ha(s,s),kl(s,i),...r.map(o=>kl(s,Sn(o))))}}const Ke="binding-command",Xi=rn(Ke),Sn=n=>`${Xi}:${n}`,Lo=(n,e)=>Ro(qc.annotation.keyFor(e),n),Wg=(()=>{const n="__au_static_resource__",e=(t,s,i)=>{let r=Ro(n,t);return r==null&&t.$au?.type===s&&(r=i(t.$au,t),Al(r,t,n)),r};return Dn({name:Xi,keyFrom:Sn,define(t,s){const i=or.create(t,s),r=i.Type;return Al(i,r,Xi,Pt),r},getAnnotation:Lo,find(t,s){const i=t.find(Ke,s);return i==null?null:Ro(Xi,i)??e(i,Ke,or.create)??null},get(t,s){try{return t.get(Tn(Sn(s)))}catch(i){throw console.log(`


[DEV:aurelia] Cannot retrieve binding command with name




`,s),i}return t.get(Tn(Sn(s)))}})})();class qh{get ignoreAttr(){return!1}build(e,t,s){let r=e.attr.target,o=e.attr.rawValue;return o=o===""?je(r):o,e.bindable==null?r=s.map(e.node,r)??je(r):r=e.bindable.name,new Bi(t.parse(o,Wt),r,1)}}qh.$au={type:Ke,name:"one-time"};class Kh{get ignoreAttr(){return!1}build(e,t,s){let r=e.attr.target,o=e.attr.rawValue;return o=o===""?je(r):o,e.bindable==null?r=s.map(e.node,r)??je(r):r=e.bindable.name,new Bi(t.parse(o,Wt),r,2)}}Kh.$au={type:Ke,name:"to-view"};class Qh{get ignoreAttr(){return!1}build(e,t,s){const i=e.attr;let r=i.target,o=i.rawValue;return o=o===""?je(r):o,e.bindable==null?r=s.map(e.node,r)??je(r):r=e.bindable.name,new Bi(t.parse(o,Wt),r,4)}}Qh.$au={type:Ke,name:"from-view"};class Yh{get ignoreAttr(){return!1}build(e,t,s){const i=e.attr;let r=i.target,o=i.rawValue;return o=o===""?je(r):o,e.bindable==null?r=s.map(e.node,r)??je(r):r=e.bindable.name,new Bi(t.parse(o,Wt),r,6)}}Yh.$au={type:Ke,name:"two-way"};class Xh{get ignoreAttr(){return!1}build(e,t,s){const i=e.attr,r=e.bindable;let o=i.rawValue,a=i.target,c,l;return o=o===""?je(a):o,r==null?(l=s.isTwoWay(e.node,a)?6:2,a=s.map(e.node,a)??je(a)):(c=e.def.defaultBindingMode??0,l=r.mode===0||r.mode==null?c==null||c===0?2:c:r.mode,a=r.name),new Bi(t.parse(o,Wt),a,se(l)?Mi[l]??0:l)}}Xh.$au={type:Ke,name:"bind"};class Gh{constructor(){this._attrParser=E(fa)}get ignoreAttr(){return!1}build(e,t){const s=e.bindable===null?je(e.attr.target):e.bindable.name,i=t.parse(e.attr.rawValue,"IsIterator");let r=X;if(i.semiIdx>-1){const o=e.attr.rawValue.slice(i.semiIdx+1),a=o.indexOf(":");if(a>-1){const c=o.slice(0,a).trim(),l=o.slice(a+1).trim(),h=this._attrParser.parse(c,l);r=[new Ng(l,h.target,h.command)]}}return new Dg(i,s,r)}}Gh.$au={type:Ke,name:"for"};class Jh{get ignoreAttr(){return!0}build(e,t){return new zh(t.parse(e.attr.rawValue,_h),e.attr.target,!1,e.attr.parts?.[2]??null)}}Jh.$au={type:Ke,name:"trigger"};class Zh{get ignoreAttr(){return!0}build(e,t){return new zh(t.parse(e.attr.rawValue,_h),e.attr.target,!0,e.attr.parts?.[2]??null)}}Zh.$au={type:Ke,name:"capture"};class eu{get ignoreAttr(){return!0}build(e,t){const s=e.attr,i=s.target;let r=s.rawValue;return r=r===""?je(i):r,new ga(i,t.parse(r,Wt),i)}}eu.$au={type:Ke,name:"attr"};class tu{get ignoreAttr(){return!0}build(e,t){return new ga("style",t.parse(e.attr.rawValue,Wt),e.attr.target)}}tu.$au={type:Ke,name:"style"};class su{get ignoreAttr(){return!0}build(e,t){let s=e.attr.target;if(s.includes(",")){const i=s.split(",").filter(r=>r.length>0);if(i.length===0)throw xe(723);s=i.join(" ")}return new ga("class",t.parse(e.attr.rawValue,Wt),s)}}su.$au={type:Ke,name:"class"};class nu{get ignoreAttr(){return!0}build(e,t){return new Fg(t.parse(e.attr.rawValue,Wt),e.attr.target)}}nu.$au={type:Ke,name:"ref"};class iu{get ignoreAttr(){return!1}build(e){return new Oo(e.attr.target,e.attr.rawValue)}}iu.$au={type:Ke,name:"spread"};const zg=Ut("ITemplateElementFactory",n=>n.singleton(qg)),Pl={};class qg{constructor(){this.p=E(On),this._template=this.t()}t(){return this.p.document.createElement("template")}createTemplate(e){if(se(e)){let s=Pl[e];if(s===void 0){const i=this._template;i.innerHTML=e;const r=i.content.firstElementChild;t(r)?(this._template=this.t(),s=i):(i.content.removeChild(r),s=r),Pl[e]=s}return s.cloneNode(!0)}if(e.nodeName!=="TEMPLATE"){const s=this.t();return s.content.appendChild(e),s}return e.parentNode?.removeChild(e),e.cloneNode(!0);function t(s){if(s==null||s.nodeName!=="TEMPLATE"||s.nextElementSibling!=null)return!0;const r=s.previousSibling;if(r!=null)switch(r.nodeType){case 3:return r.textContent.trim().length>0}const o=s.nextSibling;if(o!=null)switch(o.nodeType){case 3:return o.textContent.trim().length>0}return!1}}}const Gr="au-start",Jr="au-end",Zr=(n,e,t)=>n.insertBefore(e,t),Rl=(n,e,t)=>{if(n===null)return;const s=t.length;let i=0;for(;s>i;)n.insertBefore(t[i],e),++i},Fs=(n,e)=>n.content.appendChild(e),Ol=(n,e)=>{const t=e.length;let s=0;for(;t>s;)n.content.appendChild(e[s]),++s},Ll=n=>n.nodeType===1,Dl=n=>n.nodeType===3,Un="au-slot",Fl="default",Wn=(n=>()=>`anonymous-${++n}`)(0);class ru{constructor(){this.debug=!1,this.resolveResources=!0}compile(e,t){if(e.template==null||e.needsCompile===!1)return e;const s=new ar(e,t,null,null,void 0),i=se(e.template)||!e.enhance?s._templateFactory.createTemplate(e.template):e.template,r=i.nodeName===eo&&i.content!=null,o=r?i.content:i,a=Jg.findAll(t),c=a.length;let l=0;if(c>0)for(;c>l;)a[l].compiling?.(i),++l;if(i.hasAttribute(Do))throw xe(701,e);return this._compileLocalElement(o,s),this._compileNode(o,s),{...e,name:e.name||Wn(),dependencies:(e.dependencies??X).concat(s.deps??X),instructions:s.rows,surrogates:r?this._compileSurrogate(i,s):X,template:i,hasSlots:s.hasSlot,needsCompile:!1}}compileSpread(e,t,s,i,r){const o=new ar(e,s,null,null,void 0),a=[],c=r??o._findElement(i.nodeName.toLowerCase()),l=c!==null,h=o._exprParser,u=t.length;let d=0,p,m=null,f,g,w,I,M,A=null,S,P,T,N;for(;u>d;++d){if(p=t[d],T=p.target,N=p.rawValue,T==="...$attrs"){a.push(new Ml);continue}if(A=o._getCommand(p),A!==null&&A.ignoreAttr){D.node=i,D.attr=p,D.bindable=null,D.def=null,a.push(A.build(D,o._exprParser,o._attrMapper));continue}if(l&&(w=o._getBindables(c),I=w.attrs[T],I!==void 0)){A==null?(S=h.parse(N,Ct),a.push(new Bl(S==null?new cn(N,I.name):new Kt(S,I.name)))):(D.node=i,D.attr=p,D.bindable=I,D.def=c,a.push(new Bl(A.build(D,o._exprParser,o._attrMapper))));continue}if(m=o._findAttr(T),m!==null){if(m.isTemplateController)throw xe(9998,T);w=o._getBindables(m),P=m.noMultiBindings===!1&&A===null&&to(N),P?g=this._compileMultiBindings(i,N,m,o):(M=w.primary,A===null?(S=h.parse(N,Ct),g=[S===null?new cn(N,M.name):new Kt(S,M.name)]):(D.node=i,D.attr=p,D.bindable=M,D.def=m,g=[A.build(D,o._exprParser,o._attrMapper)])),(f??=[]).push(new Xr(this.resolveResources?m:m.name,m.aliases!=null&&m.aliases.includes(T)?T:void 0,g));continue}if(A==null)if(S=h.parse(N,Ct),S!=null)a.push(new Kt(S,o._attrMapper.map(i,T)??je(T)));else switch(T){case"class":a.push(new Tl(N));break;case"style":a.push(new El(N));break;default:a.push(new Il(N,T))}else D.node=i,D.attr=p,D.bindable=null,D.def=null,a.push(A.build(D,o._exprParser,o._attrMapper))}return Fi(),f!=null?f.concat(a):a}_compileSurrogate(e,t){const s=[],i=e.attributes,r=t._exprParser;let o=i.length,a=0,c,l,h,u,d=null,p,m,f,g,w=null,I,M,A,S;for(;o>a;++a){if(c=i[a],l=c.name,h=c.value,u=t._attrParser.parse(l,h),A=u.target,S=u.rawValue,Qg[A])throw xe(702,l);if(w=t._getCommand(u),w!==null&&w.ignoreAttr){D.node=e,D.attr=u,D.bindable=null,D.def=null,s.push(w.build(D,t._exprParser,t._attrMapper));continue}if(d=t._findAttr(A),d!==null){if(d.isTemplateController)throw xe(703,A);f=t._getBindables(d),M=d.noMultiBindings===!1&&w===null&&to(S),M?m=this._compileMultiBindings(e,S,d,t):(g=f.primary,w===null?(I=r.parse(S,Ct),m=I===null?S===""?[]:[new cn(S,g.name)]:[new Kt(I,g.name)]):(D.node=e,D.attr=u,D.bindable=g,D.def=d,m=[w.build(D,t._exprParser,t._attrMapper)])),e.removeAttribute(l),--a,--o,(p??=[]).push(new Xr(this.resolveResources?d:d.name,d.aliases!=null&&d.aliases.includes(A)?A:void 0,m));continue}if(w===null)if(I=r.parse(S,Ct),I!=null)e.removeAttribute(l),--a,--o,s.push(new Kt(I,t._attrMapper.map(e,A)??je(A)));else switch(l){case"class":s.push(new Tl(S));break;case"style":s.push(new El(S));break;default:s.push(new Il(S,l))}else D.node=e,D.attr=u,D.bindable=null,D.def=null,s.push(w.build(D,t._exprParser,t._attrMapper))}return Fi(),p!=null?p.concat(s):s}_compileNode(e,t){switch(e.nodeType){case 1:switch(e.nodeName){case"LET":return this._compileLet(e,t);default:return this._compileElement(e,t)}case 3:return this._compileText(e,t);case 11:{let s=e.firstChild;for(;s!==null;)s=this._compileNode(s,t);break}}return e.nextSibling}_compileLet(e,t){const s=e.attributes,i=s.length,r=[],o=t._exprParser;let a=!1,c=0,l,h,u,d,p,m,f,g;for(;i>c;++c){if(l=s[c],u=l.name,d=l.value,u==="to-binding-context"){a=!0;continue}if(h=t._attrParser.parse(u,d),m=h.target,f=h.rawValue,p=t._getCommand(h),p!==null){if(h.command==="bind")r.push(new $l(o.parse(f,Wt),je(m)));else throw xe(704,h);continue}g=o.parse(f,Ct),g===null&&console.warn(`[DEV:aurelia] Property "${m}" is declared with literal string ${f}. Did you mean ${m}.bind="${f}"?`),r.push(new $l(g===null?new Ve(f):g,je(m)))}return t.rows.push([new Hg(r,a)]),this._markAsTarget(e,t).nextSibling}_compileElement(e,t){const s=e.nextSibling,i=(e.getAttribute("as-element")??e.nodeName).toLowerCase(),r=t._findElement(i),o=r!==null,a=o&&r.shadowOptions!=null,c=r?.capture,l=c!=null&&typeof c!="boolean",h=c?[]:X,u=t._exprParser,d=this.debug?wt:()=>{e.removeAttribute(I),--g,--f};let p=e.attributes,m,f=p.length,g=0,w,I,M,A,S,P,T=null,N=!1,j,H,he,Ie,pe,ue,ke,Y=null,$,ne,F,ie,Me=!0,b=!1,y=!1,_=!1,C,v=0;if(i==="slot"){if(t.root.def.shadowOptions==null)throw xe(717,t.root.def.name);t.root.hasSlot=!0}for(o&&(C={},Me=r.processContent?.call(r.Type,e,t.p,C),p=e.attributes,f=p.length);f>g;++g){switch(w=p[g],I=w.name,M=w.value,I){case"as-element":case"containerless":d(),b=b||I==="containerless";continue}if(A=t._attrParser.parse(I,M),Y=t._getCommand(A),F=A.target,ie=A.rawValue,c&&(!l||l&&c(F))){if(Y!=null&&Y.ignoreAttr){d(),h.push(A);continue}if(y=F!==Un&&F!=="slot"&&((v=F.indexOf("..."))===-1||v===0&&F==="...$attrs"),y&&($=t._getBindables(r),$.attrs[F]==null&&!t._findAttr(F)?.isTemplateController)){d(),h.push(A);continue}}if(F==="...$attrs"){(S??=[]).push(new Ml),d();continue}if(Y?.ignoreAttr){D.node=e,D.attr=A,D.bindable=null,D.def=null,(S??=[]).push(Y.build(D,t._exprParser,t._attrMapper)),d();continue}if(F.indexOf("...")===0){if(o&&(F=F.slice(3))!=="$element"){(P??=[]).push(new Oo("$bindables",F==="$bindables"?ie:F)),d();continue}throw(F==="$bindable"||F==="bindables")&&console.warn(`[DEV:aurelia] Detected usage of ${F} on <${e.nodeName}>, did you mean "$bindables"?`),xe(720,F)}if(o){if($=t._getBindables(r),j=$.attrs[F],j!==void 0){Y===null?(ue=u.parse(ie,Ct),(P??=[]).push(ue==null?new cn(ie,j.name):new Kt(ue,j.name))):(D.node=e,D.attr=A,D.bindable=j,D.def=r,(P??=[]).push(Y.build(D,t._exprParser,t._attrMapper))),d(),T=t._findAttr(F),T!==null&&console.warn(`[DEV:aurelia] Binding with bindable "${F}" on custom element "${r.name}" is ambiguous.There is a custom attribute with the same name.`);continue}if(F==="$bindables"){if(Y!=null){D.node=e,D.attr=A,D.bindable=null,D.def=r;{const O=Y.build(D,t._exprParser,t._attrMapper);O instanceof Oo||console.warn(`[DEV:aurelia] Binding with "$bindables" on custom element "${r.name}" with command ${A.command}  did not result in a spread binding instruction. This likely won't work as expected.`),(P??=[]).push(O)}}else console.warn(`[DEV:aurelia] Usage of "$bindables" on custom element "<${r.name}>" is ignored.`);d();continue}}if(F==="$bindables")throw xe(721,e.nodeName,F,ie);if(T=t._findAttr(F),T!==null){$=t._getBindables(T),N=T.noMultiBindings===!1&&Y===null&&to(ie),N?he=this._compileMultiBindings(e,ie,T,t):(ne=$.primary,Y===null?(ue=u.parse(ie,Ct),he=ue===null?ie===""?[]:[new cn(ie,ne.name)]:[new Kt(ue,ne.name)]):(D.node=e,D.attr=A,D.bindable=ne,D.def=T,he=[Y.build(D,t._exprParser,t._attrMapper)])),d(),T.isTemplateController?(Ie??=[]).push(new Vg(Kg,this.resolveResources?T:T.name,void 0,he)):(H??=[]).push(new Xr(this.resolveResources?T:T.name,T.aliases!=null&&T.aliases.includes(F)?F:void 0,he));continue}if(Y===null){ue=u.parse(ie,Ct),ue!=null&&(d(),(S??=[]).push(new Kt(ue,t._attrMapper.map(e,F)??je(F))));continue}D.node=e,D.attr=A,D.bindable=null,D.def=null,(S??=[]).push(Y.build(D,t._exprParser,t._attrMapper)),d()}Fi(),this._shouldReorderAttrs(e,S)&&S!=null&&S.length>1&&this._reorder(e,S),o&&(ke=new jg(this.resolveResources?r:r.name,P??X,null,b,h,C)),(S!=null||ke!=null||H!=null)&&(m=X.concat(ke??X,H??X,S??X),_=!0);let k;if(Ie!=null){f=Ie.length-1,g=f,pe=Ie[g];let O;Nl(e)?(O=t.t(),Ol(O,[t._marker(),t._comment(Gr),t._comment(Jr)])):(this._replaceByMarker(e,t),e.nodeName==="TEMPLATE"?O=e:(O=t.t(),Fs(O,e)));const Ne=O,be=t._createChild(m==null?[]:[m]);let x,L,z=!1,U,K,ee,G,Ue,Te,We=0,It=0,_e=e.firstChild,us=!1;if(Me!==!1)for(;_e!==null;){if(L=Ll(_e)?_e.getAttribute(Un):null,z=L!==null||o&&!a,x=_e.nextSibling,z){if(!o)throw xe(706,L,i);_e.removeAttribute?.(Un),us=Dl(_e)&&_e.textContent.trim()==="",us||((K??={})[L||Fl]??=[]).push(_e),e.removeChild(_e)}_e=x}if(K!=null){U={};for(L in K){for(O=t.t(),ee=K[L],We=0,It=ee.length;It>We;++We)G=ee[We],G.nodeName==="TEMPLATE"?G.attributes.length>0?Fs(O,G):Fs(O,G.content):Fs(O,G);Te=t._createChild(),this._compileNode(O.content,Te),U[L]={name:Wn(),type:dn,template:O,instructions:Te.rows,needsCompile:!1}}ke.projections=U}if(_&&(o&&(b||r.containerless)?this._replaceByMarker(e,t):this._markAsTarget(e,t)),k=!o||!r.containerless&&!b&&Me!==!1,k)if(e.nodeName===eo)this._compileNode(e.content,be);else for(_e=e.firstChild;_e!==null;)_e=this._compileNode(_e,be);for(pe.def={name:Wn(),type:dn,template:Ne,instructions:be.rows,needsCompile:!1};g-- >0;)pe=Ie[g],O=t.t(),Ue=t._marker(),Ol(O,[Ue,t._comment(Gr),t._comment(Jr)]),pe.def={name:Wn(),type:dn,template:O,needsCompile:!1,instructions:[[Ie[g+1]]]};t.rows.push([pe])}else{m!=null&&t.rows.push(m);let O=e.firstChild,Ne,be,x=!1,L=null,z,U,K,ee,G,Ue=!1,Te=0,We=0;if(Me!==!1)for(;O!==null;){if(be=Ll(O)?O.getAttribute(Un):null,x=be!==null||o&&!a,Ne=O.nextSibling,x){if(!o)throw xe(706,be,i);O.removeAttribute?.(Un),Ue=Dl(O)&&O.textContent.trim()==="",Ue||((z??={})[be||Fl]??=[]).push(O),e.removeChild(O)}O=Ne}if(z!=null){L={};for(be in z){for(ee=t.t(),U=z[be],Te=0,We=U.length;We>Te;++Te)K=U[Te],K.nodeName===eo?K.attributes.length>0?Fs(ee,K):Fs(ee,K.content):Fs(ee,K);G=t._createChild(),this._compileNode(ee.content,G),L[be]={name:Wn(),type:dn,template:ee,instructions:G.rows,needsCompile:!1}}ke.projections=L}if(_&&(o&&(b||r.containerless)?this._replaceByMarker(e,t):this._markAsTarget(e,t)),k=!o||!r.containerless&&!b&&Me!==!1,k&&e.childNodes.length>0)for(O=e.firstChild;O!==null;)O=this._compileNode(O,t)}return s}_compileText(e,t){const s=e.parentNode,i=t._exprParser.parse(e.textContent,Ct),r=e.nextSibling;let o,a,c,l,h;if(i!==null){for({parts:o,expressions:a}=i,(h=o[0])&&Zr(s,t._text(h),e),c=0,l=a.length;l>c;++c)Rl(s,e,[t._marker(),t._text(" ")]),(h=o[c+1])&&Zr(s,t._text(h),e),t.rows.push([new Ug(a[c])]);s.removeChild(e)}return r}_compileMultiBindings(e,t,s,i){const r=i._getBindables(s),o=t.length,a=[];let c,l,h=0,u=0,d,p,m,f;for(let g=0;g<o;++g)if(u=t.charCodeAt(g),u===92)++g;else if(u===58){for(c=t.slice(h,g);t.charCodeAt(++g)<=32;);for(h=g;g<o;++g)if(u=t.charCodeAt(g),u===92)++g;else if(u===59){l=t.slice(h,g);break}if(l===void 0&&(l=t.slice(h)),p=i._attrParser.parse(c,l),m=i._getCommand(p),f=r.attrs[p.target],f==null)throw xe(707,p.target,s.name);for(m===null?(d=i._exprParser.parse(l,Ct),a.push(d===null?new cn(l,f.name):new Kt(d,f.name))):(D.node=e,D.attr=p,D.bindable=f,D.def=s,a.push(m.build(D,i._exprParser,i._attrMapper)));g<o&&t.charCodeAt(++g)<=32;);h=g,c=void 0,l=void 0}return Fi(),a}_compileLocalElement(e,t){const s=t.root.def.name,i=e,r=Ur(i.querySelectorAll("template[as-custom-element]")),o=r.length;if(o===0)return;if(o===i.childElementCount)throw xe(708,s);const a=new Set,c=[];for(const h of r){if(h.parentNode!==i)throw xe(709,s);const u=Gg(s,h,a),d=h.content,p=Ur(d.querySelectorAll("bindable")),m=new Set,f=new Set,g=p.reduce((I,M)=>{if(M.parentNode!==d)throw xe(710,u);const A=M.getAttribute("name");if(A===null)throw xe(711,M,u);const S=M.getAttribute("attribute");if(S!==null&&f.has(S)||m.has(A))throw xe(712,m,S);S!==null&&f.add(S),m.add(A);const P=Ur(M.attributes).filter(T=>!jl.includes(T.name));return P.length>0&&console.warn(`[DEV:aurelia] The attribute(s) ${P.map(T=>T.name).join(", ")} will be ignored for ${M.outerHTML}. Only ${jl.join(", ")} are processed.`),M.remove(),I[A]={name:A,attribute:S??void 0,mode:M.getAttribute("mode")??"default"},I},{});class w{}w.$au={type:dn,name:u,template:h,bindables:g},Reflect.defineProperty(w,"name",{value:Hc(u)}),c.push(w),i.removeChild(h)}const l=(t.root.def.dependencies??[]).concat(t.root.def.Type==null?X:[t.root.def.Type]);for(const h of c)h.dependencies=l.concat(c.filter(u=>u!==h)),t._addLocalDep(h)}_shouldReorderAttrs(e,t){const s=e.nodeName;return s==="INPUT"&&Yg[e.type]===1||s==="SELECT"&&(e.hasAttribute("multiple")||t?.some(i=>i.type===pa&&i.to==="multiple"))}_reorder(e,t){switch(e.nodeName){case"INPUT":{const s=t;let i,r,o=0,a;for(let c=0;c<s.length&&o<3;c++)switch(a=s[c],a.to){case"model":case"value":case"matcher":i=c,o++;break;case"checked":r=c,o++;break}r!==void 0&&i!==void 0&&r<i&&([s[i],s[r]]=[s[r],s[i]]);break}case"SELECT":{const s=t;let i=0,r=0,o=0,a;for(let c=0;c<s.length&&o<2;++c){switch(a=s[c],a.to){case"multiple":r=c,o++;break;case"value":i=c,o++;break}o===2&&i<r&&([s[r],s[i]]=[s[i],s[r]])}}}}_markAsTarget(e,t){return Zr(e.parentNode,t._comment("au*"),e),e}_replaceByMarker(e,t){if(Nl(e))return e;const s=e.parentNode,i=t._marker();return Rl(s,e,[i,t._comment(Gr),t._comment(Jr)]),s.removeChild(e),i}}ru.register=Ii(kr);const eo="TEMPLATE",Nl=n=>n.nodeValue==="au*";class ar{constructor(e,t,s,i,r){this.hasSlot=!1,this.deps=null;const o=s!==null;if(this.c=t,this.root=i===null?this:i,this.def=e,this.parent=s,this._resourceResolver=o?s._resourceResolver:t.get(ou),this._commandResolver=o?s._commandResolver:t.get(Xg),this._templateFactory=o?s._templateFactory:t.get(zg),this._attrParser=o?s._attrParser:t.get(fa),this._exprParser=o?s._exprParser:t.get(Ln),this._attrMapper=o?s._attrMapper:t.get(wh),this._logger=o?s._logger:t.get(Xs),typeof(this.p=o?s.p:t.get(On)).document?.nodeType!="number")throw xe(722);this.localEls=o?s.localEls:new Set,this.rows=r??[]}_addLocalDep(e){return(this.root.deps??=[]).push(e),this.root.c.register(e),this}_text(e){return this.p.document.createTextNode(e)}_comment(e){return this.p.document.createComment(e)}_marker(){return this._comment("au*")}h(e){const t=this.p.document.createElement(e);return e==="template"&&this.p.document.adoptNode(t.content),t}t(){return this.h("template")}_findElement(e){return this._resourceResolver.el(this.c,e)}_findAttr(e){return this._resourceResolver.attr(this.c,e)}_getBindables(e){return this._resourceResolver.bindables(e)}_createChild(e){return new ar(this.def,this.c,this,this.root,e)}_getCommand(e){const t=e.command;return t===null?null:this._commandResolver.get(this.c,t)}}const to=n=>{const e=n.length;let t=0,s=0;for(;e>s;){if(t=n.charCodeAt(s),t===92)++s;else{if(t===58)return!0;if(t===36&&n.charCodeAt(s+1)===123)return!1}++s}return!1},Fi=()=>{D.node=D.attr=D.bindable=D.def=null},Kg={name:"unnamed",type:dn},D={node:null,attr:null,bindable:null,def:null},Qg={id:!0,name:!0,"au-slot":!0,"as-element":!0},Yg={checkbox:1,radio:1},ou=Ut("IResourceResolver"),Xg=Ut("IBindingCommandResolver",n=>{class e{constructor(){this._cache=new WeakMap}get(s,i){let r=this._cache.get(s);return r||this._cache.set(s,r={}),i in r?r[i]:r[i]=Wg.get(s,i)}}return n.singleton(e)}),jl=Dn(["name","attribute","mode"]),Do="as-custom-element",Gg=(n,e,t)=>{const s=e.getAttribute(Do);if(s===null||s==="")throw xe(715,n);if(t.has(s))throw xe(716,s,n);return t.add(s),e.removeAttribute(Do),s},Vl=Ut("ITemplateCompilerHooks"),Jg=Dn({name:rn("compiler-hooks"),define(n){return{register(e){ha(Vl,n).register(e)}}},findAll(n){return n.get(qf(Vl))}}),Zg=Object.prototype.hasOwnProperty,Cs=Reflect.defineProperty;function Ft(n,e,t){return Cs(n,e,{configurable:!0,writable:!0,value:t}),t}function Zt(n,e,t){e in n||Ft(n,e,t)}const au=Object.assign,ma=Object.freeze,En=String,Cr=Ts.createInterface,em=as.get,tm=as.define,Q=(n,...e)=>new Error(`AUR${En(n).padStart(4,"0")}: ${nm(n,...e)}`),sm={99:"Method {{0}} not implemented",101:'Ast eval error: binding behavior "{{0}}" could not be found. Did you forget to register it as a dependency?',102:'Ast eval error: binding behavior "{{0}}" already applied.',103:'Ast eval error: value converter "{{0}}" could not be found. Did you forget to register it as a dependency?',105:"Ast eval error: unable to find $host context. Did you forget [au-slot] attribute?",106:'Ast eval error: invalid assignment. "$host" is a reserved keyword.',107:"Ast eval error: expression is not a function.",109:'Ast eval error: unknown unary operator: "{{0}}"',108:'Ast eval error: unknown binary operator: "{{0}}"',110:"Ast eval error: left-hand side of tagged template expression is not a function.",111:'Ast eval error: expected "{{0}}" to be a function',112:"Ast eval error: cannot use non-object value for destructuring assignment.",113:"Ast eval error: infinite loop detected. Increment operators should only be used in event handlers.",114:'Ast eval error: cannot access property "{{0}}" of {{1}}.',115:'Ast eval error: cannot access key "{{0}}" of {{1}}.',116:'Ast eval error: cannot assign value to property "{{0}}" of null/undefined.',151:'Expression error: invalid start: "{{0}}"',152:'Expression error: spread operator is not supported: "{{0}}"',153:'Expression error: expected identifier: "{{0}}"',154:'Expression error: invalid member expression: "{{0}}"',155:'Expression error: unexpected end of expression: "{{0}}"',156:'Expression error: unconsumed token: "{{0}}" at position {{1}} of "{{2}}"',157:"Expression error: invalid empty expression. Empty expression is only valid in event bindings (trigger, delegate, capture etc...)",158:'Expression error: left hand side of expression is not assignable: "{{0}}"',159:'Expression error: expected identifier to come after value converter operator: "{{0}}"',160:"Expression error: expected identifier to come after binding behavior operator: {{0}}",161:'Expression error: unexpected keyword "of": "{{0}}"',162:'Expression error: unexpected keyword "import": "{{0}}"',163:'Expression error: invalid BindingIdentifier at left hand side of "of": "{{0}}" | kind: {{1}}',164:'Expression error: invalid or unsupported property definition in object literal: "{{0}}"',165:'Expression error: unterminated quote in string literal: "{{0}}"',166:'Expression error: unterminated template string: "{{0}}"',167:'Expression error: missing expected token "{{0}}" in "{{1}}"',168:'Expression error: unexpected character: "{{0}}"',170:'Expression error: unexpected "{{0}}" at position "{{1}}" for destructuring assignment in "{{2}}"',171:'Expression error: unexpected {{0}} at position "{{1}}" for optional chain in "{{2}}"',172:'Expression error: invalid tagged template on optional chain in "{{1}}"',173:'Expression error: invalid arrow parameter list in "{{0}}"',174:'Expression error: arrow function with default parameters is not supported: "{{0}}"',175:'Expression error: arrow function with destructuring parameters is not supported: "{{0}}"',176:'Expression error: rest parameter must be last formal parameter in arrow function: "{{0}}"',178:'Expression error: arrow function with function body is not supported: "{{0}}"',179:`Expression error: unexpected token '.' at position "{{1}}" in "{{0}}"`,199:"Trying to observe property {{0}} on null/undefined",203:"Trying to retrieve a property or build a scope from a null/undefined scope",204:"Trying to create a scope with null/undefined binding context",206:"Trying to switch to a null/undefined connectable",207:"Trying to enter an active connectable",208:"Trying to pop a null/undefined connectable",209:"Trying to exit an inactive connectable",210:"Unrecognised collection type {{0:toString}}.",217:"There is no registration for IDirtyChecker interface. If you want to use your own dirty checker, make sure you register it.",218:"Dirty checked is not permitted in this application. Property key {{0}} is being dirty checked.",219:"Trying to set value for property {{0}} in dirty checker",220:'Map/Set "size" is a readonly property',221:'Trying to assign value to readonly property "{{0}}" through computed observer.',224:"Invalid @observable decorator usage, cannot determine property name",225:"Trying to stop an effect that has already been stopped",226:"Maximum number of recursive effect run reached. Consider handle effect dependencies differently."},nm=(n,...e)=>{let t=sm[n];for(let s=0;s<e.length;++s){const i=new RegExp(`{{${s}(:.*)?}}`,"g");let r=i.exec(t);for(;r!=null;){const o=r[1]?.slice(1);let a=e[s];if(a!=null)switch(o){case"typeof":a=typeof a;break;case"toString":a=Object.prototype.toString.call(a);break;case"join(!=)":a=a.join("!=");break;case"element":a=a==="*"?"all elements":`<${a} />`;break;default:o?.startsWith(".")?a=En(a[o.slice(1)]):a=En(a)}t=t.slice(0,r.index)+a+t.slice(i.lastIndex),r=i.exec(t)}}return t};class Oe{constructor(e,t,s,i){this.parent=e,this.bindingContext=t,this.overrideContext=s,this.isBoundary=i}static getContext(e,t,s){if(e==null)throw Q(203);let i=e.overrideContext,r=e;if(s>0){for(;s>0;)if(s--,r=r.parent,r==null)return;return i=r.overrideContext,t in i?i:r.bindingContext}for(;r!=null&&!r.isBoundary&&!(t in r.overrideContext)&&!(t in r.bindingContext);)r=r.parent;return r==null?e.bindingContext:(i=r.overrideContext,t in i?i:r.bindingContext)}static create(e,t,s){if(e==null)throw Q(204);return new Oe(null,e,t??new Ul,s??!1)}static fromParent(e,t,s=new Ul){if(e==null)throw Q(203);return new Oe(e,t,s,!1)}}class Hl{constructor(e,t){e!==void 0&&(this[e]=t)}}class Ul{}const{astAssign:xi,astEvaluate:ye,astBind:Ms,astUnbind:Bs}=(()=>{const n="AccessThis",e="AccessBoundary",t="AccessGlobal",s="AccessScope",i="ArrayLiteral",r="ObjectLiteral",o="PrimitiveLiteral",c="Template",l="Unary",h="CallScope",u="CallMember",d="CallFunction",p="CallGlobal",m="AccessMember",f="AccessKeyed",g="TaggedTemplate",w="Binary",I="Conditional",M="Assign",A="ArrowFunction",S="ValueConverter",P="BindingBehavior",T="ArrayBindingPattern",N="ObjectBindingPattern",j="BindingIdentifier",H="ForOfStatement",he="Interpolation",Ie="ArrayDestructuring",pe="ObjectDestructuring",ue="DestructuringAssignmentLeaf",ke="Custom",Y=Oe.getContext;function $(b,y,_,C){switch(b.$kind){case n:{let v=y.overrideContext,k=y,O=b.ancestor;for(;O--&&v;)k=k.parent,v=k?.overrideContext??null;return O<1&&k?k.bindingContext:void 0}case e:{let v=y;for(;v!=null&&!v.isBoundary;)v=v.parent;return v?v.bindingContext:void 0}case s:{const v=Y(y,b.name,b.ancestor);C!==null&&C.observe(v,b.name);const k=v[b.name];if(k==null){if(b.name==="$host")throw Q(105);return k}return _?.boundFn&&ce(k)?k.bind(v):k}case t:return globalThis[b.name];case p:{const v=globalThis[b.name];if(ce(v))return v(...b.args.map(k=>$(k,y,_,C)));if(!_?.strict&&v==null)return;throw Q(107)}case i:return b.elements.map(v=>$(v,y,_,C));case r:{const v={};for(let k=0;k<b.keys.length;++k)v[b.keys[k]]=$(b.values[k],y,_,C);return v}case o:return b.value;case"New":{const v=$(b.func,y,_,C);if(ce(v))return new v(...b.args.map(k=>$(k,y,_,C)));throw Q(107)}case c:{let v=b.cooked[0];for(let k=0;k<b.expressions.length;++k)v+=En($(b.expressions[k],y,_,C)),v+=b.cooked[k+1];return v}case l:{const v=$(b.expression,y,_,C);switch(b.operation){case"void":return;case"typeof":return typeof v;case"!":return!v;case"-":return-v;case"+":return+v;case"--":if(C!=null)throw Q(113);return ne(b.expression,y,_,C,v-1)+b.pos;case"++":if(C!=null)throw Q(113);return ne(b.expression,y,_,C,v+1)-b.pos;default:throw Q(109,b.operation)}}case h:{const v=Y(y,b.name,b.ancestor);if(v==null){if(_?.strict)throw Q(114,b.name,v);return}const k=v[b.name];if(ce(k))return k.apply(v,b.args.map(O=>$(O,y,_,C)));if(k==null){if(_?.strict&&!b.optional)throw Q(111,b.name);return}throw Q(111,b.name)}case u:{const v=$(b.object,y,_,C);if(v==null&&_?.strict&&!b.optionalMember)throw Q(114,b.name,v);const k=v?.[b.name];if(k==null){if(!b.optionalCall&&_?.strict)throw Q(111,b.name);return}if(!ce(k))throw Q(111,b.name);const O=k.apply(v,b.args.map(Ne=>$(Ne,y,_,C)));return Ee(v)&&Me.includes(b.name)&&C?.observeCollection(v),O}case d:{const v=$(b.func,y,_,C);if(ce(v))return v(...b.args.map(k=>$(k,y,_,C)));if(v==null){if(!b.optional&&_?.strict)throw Q(107);return}throw Q(107)}case A:return(...k)=>{const O=b.args,Ne=b.rest,be=O.length-1,x=O.reduce((z,U,K)=>(Ne&&K===be?z[U.name]=k.slice(K):z[U.name]=k[K],z),{}),L=Oe.fromParent(y,x);return $(b.body,L,_,C)};case m:{const v=$(b.object,y,_,C);if(v==null){if(!b.optional&&_?.strict)throw Q(114,b.name,v);return}C!==null&&!b.accessGlobal&&C.observe(v,b.name);const k=v[b.name];return _?.boundFn&&ce(k)?k.bind(v):k}case f:{const v=$(b.object,y,_,C),k=$(b.key,y,_,C);if(v==null){if(!b.optional&&_?.strict)throw Q(115,k,v);return}return C!==null&&!b.accessGlobal&&C.observe(v,k),v[k]}case g:{const v=b.expressions.map(O=>$(O,y,_,C)),k=$(b.func,y,_,C);if(!ce(k))throw Q(110);return k(b.cooked,...v)}case w:{const v=b.left,k=b.right;switch(b.operation){case"&&":return $(v,y,_,C)&&$(k,y,_,C);case"||":return $(v,y,_,C)||$(k,y,_,C);case"??":return $(v,y,_,C)??$(k,y,_,C);case"==":return $(v,y,_,C)==$(k,y,_,C);case"===":return $(v,y,_,C)===$(k,y,_,C);case"!=":return $(v,y,_,C)!=$(k,y,_,C);case"!==":return $(v,y,_,C)!==$(k,y,_,C);case"instanceof":{const O=$(k,y,_,C);return ce(O)?$(v,y,_,C)instanceof O:!1}case"in":{const O=$(k,y,_,C);return er(O)?$(v,y,_,C)in O:!1}case"+":return $(v,y,_,C)+$(k,y,_,C);case"-":return $(v,y,_,C)-$(k,y,_,C);case"*":return $(v,y,_,C)*$(k,y,_,C);case"/":return $(v,y,_,C)/$(k,y,_,C);case"%":return $(v,y,_,C)%$(k,y,_,C);case"**":return $(v,y,_,C)**$(k,y,_,C);case"<":return $(v,y,_,C)<$(k,y,_,C);case">":return $(v,y,_,C)>$(k,y,_,C);case"<=":return $(v,y,_,C)<=$(k,y,_,C);case">=":return $(v,y,_,C)>=$(k,y,_,C);default:throw Q(108,b.operation)}}case I:return $(b.condition,y,_,C)?$(b.yes,y,_,C):$(b.no,y,_,C);case M:{let v=$(b.value,y,_,C);if(b.op!=="="){if(C!=null)throw Q(113);const k=$(b.target,y,_,C);switch(b.op){case"/=":v=k/v;break;case"*=":v=k*v;break;case"+=":v=k+v;break;case"-=":v=k-v;break;default:throw Q(108,b.op)}}return ne(b.target,y,_,C,v)}case S:return _?.useConverter?.(b.name,"toView",$(b.expression,y,_,C),b.args.map(v=>$(v,y,_,C)));case P:return $(b.expression,y,_,C);case j:return b.name;case H:return $(b.iterable,y,_,C);case he:if(b.isMulti){let v=b.parts[0],k=0;for(;k<b.expressions.length;++k)v+=En($(b.expressions[k],y,_,C)),v+=b.parts[k+1];return v}else return`${b.parts[0]}${$(b.firstExpression,y,_,C)}${b.parts[1]}`;case ue:return $(b.target,y,_,C);case Ie:return b.list.map(v=>$(v,y,_,C));case T:case N:case pe:default:return;case ke:return b.evaluate(y,_,C)}}function ne(b,y,_,C,v){switch(b.$kind){case s:{if(b.name==="$host")throw Q(106);const k=Y(y,b.name,b.ancestor);return k[b.name]=v}case m:{const k=$(b.object,y,_,C);if(k==null){if(_?.strict)throw Q(116,b.name);ne(b.object,y,_,C,{[b.name]:v})}else er(k)&&(b.name==="length"&&Ee(k)&&!isNaN(v)?k.splice(v):k[b.name]=v);return v}case f:{const k=$(b.object,y,_,C),O=$(b.key,y,_,C);if(k==null){if(_?.strict)throw Q(116,O);return ne(b.object,y,_,C,{[O]:v}),v}if(Ee(k)){if(O==="length"&&!isNaN(v))return k.splice(v),v;if(wi(O))return k.splice(O,1,v),v}return k[O]=v}case M:return ne(b.value,y,_,C,v),ne(b.target,y,_,C,v);case S:return v=_?.useConverter?.(b.name,"fromView",v,b.args.map(k=>$(k,y,_,C))),ne(b.expression,y,_,C,v);case P:return ne(b.expression,y,_,C,v);case Ie:case pe:{const k=b.list,O=k.length;let Ne,be;for(Ne=0;Ne<O;Ne++)switch(be=k[Ne],be.$kind){case ue:ne(be,y,_,C,v);break;case Ie:case pe:{if(typeof v!="object"||v===null)throw Q(112);let x=$(be.source,Oe.create(v),_,null);x===void 0&&be.initializer&&(x=$(be.initializer,y,_,null)),ne(be,y,_,C,x);break}}break}case ue:{if(b instanceof ch){if(v==null)return;if(typeof v!="object")throw Q(112);let k=$(b.source,Oe.create(v),_,C);k===void 0&&b.initializer&&(k=$(b.initializer,y,_,C)),ne(b.target,y,_,C,k)}else{if(v==null)return;if(typeof v!="object")throw Q(112);const k=b.indexOrProperties;let O;if(wi(k)){if(!Array.isArray(v))throw Q(112);O=v.slice(k)}else O=Object.entries(v).reduce((Ne,[be,x])=>(k.includes(be)||(Ne[be]=x),Ne),{});ne(b.target,y,_,C,O)}break}case ke:return b.assign(y,_,v);default:return}}function F(b,y,_){switch(b.$kind){case P:{_.bindBehavior?.(b.name,y,b.args.map(C=>$(C,y,_,null))),F(b.expression,y,_);break}case S:{_.bindConverter?.(b.name),F(b.expression,y,_);break}case H:{F(b.iterable,y,_);break}case ke:b.bind?.(y,_)}}function ie(b,y,_){switch(b.$kind){case P:{_.unbindBehavior?.(b.name,y),ie(b.expression,y,_);break}case S:{_.unbindConverter?.(b.name),ie(b.expression,y,_);break}case H:{ie(b.iterable,y,_);break}case ke:b.unbind?.(y,_)}}const Me="at map filter includes indexOf lastIndexOf findIndex find flat flatMap join reduce reduceRight slice every some sort".split(" ");return{astEvaluate:$,astAssign:ne,astBind:F,astUnbind:ie}})(),im=n=>{const e=n.prototype;["bindBehavior","unbindBehavior","bindConverter","unbindConverter","useConverter"].forEach(t=>{Ft(e,t,()=>{throw Q(99,t)})})},so="pending",rm="running",Wl="completed",Qn="canceled",lu=Promise.resolve();let no=!1,Fo=!1;const tt=[];let ys=0,ms=null,ks=[],lr=null,Mn=null;const cr=()=>{no||(no=!0,lu.then(()=>{no=!1,Fo=!0,om()}))},li=n=>{if(ms&&tt.length===0&&ys===0)if(ms=null,ks.length>0){const e=ks;ks=[],e.length===1?Mn(e[0]):Mn(new AggregateError(e,"One or more tasks failed."))}else lr(n)},om=()=>{const n=!Fo;Fo=!1,ms??=new Promise((i,r)=>{lr=i,Mn=r});let e=-tt.length;const t=tt.length===0;for(;tt.length>0;){if(++e>1e4){const r=new Error("Potential deadlock detected. More than 10000 extra tasks were queued from within tasks.");throw tt.length=0,Mn?.(r),ms=null,r}const i=tt.shift();if(typeof i=="function")try{i()}catch(r){ks.push(r)}else i.run()}const s=ks.slice();if(li(!t),n&&s.length>0)throw s.length===1?s[0]:new AggregateError(s,"One or more tasks failed.")},am=()=>ms||(tt.length>0||ys>0?ms??=new Promise((n,e)=>{lr=n,Mn=e}):lu.then(()=>tt.length>0||ys>0?ms??=new Promise((n,e)=>{lr=n,Mn=e}):!1)),Nt=n=>{cr(),tt.push(n)},ci=(n,e)=>{const t=new cu(n,e?.delay);return t.delay!=null&&t.delay>0?(++ys,t._timerId=setTimeout(()=>{if(--ys,t._timerId=void 0,t.status===Qn){li(!0);return}tt.push(t),cr()},t.delay)):(tt.push(t),cr()),t};let zl=class extends Error{constructor(e){super(`Task ${e.id} was canceled.`),this.task=e}},cu=class hu{get result(){return this._result}get status(){return this._status}constructor(e,t){this.callback=e,this.delay=t,this.id=++hu._taskId,this._status=so,this._result=new Promise((s,i)=>{this._resolve=s,this._reject=i})}run(){if(this._status!==so)throw new Error(`Cannot run task in ${this._status} state`);this._status=rm;let e;try{e=this.callback()}catch(t){this._status=Qn,this._reject(t),ks.push(t);return}e instanceof Promise?(++ys,e.then(t=>{this._status=Wl,this._resolve(t)}).catch(t=>{this._status=Qn,this._reject(t),ks.push(t)}).finally(()=>{--ys,li(!0)})):(this._status=Wl,this._resolve(e))}cancel(){if(this._timerId!==void 0){clearTimeout(this._timerId),--ys,this._timerId=void 0,this._status=Qn;const e=new zl(this);return this._reject(e),this._result.catch(wt),li(!0),!0}if(this._status===so){const e=tt.indexOf(this);if(e>-1){tt.splice(e,1),this._status=Qn;const t=new zl(this);return this._reject(t),this._result.catch(wt),li(!0),!0}}return!1}};cu._taskId=0;const lm=(n,e)=>{const t=new xr(n,Math.max(e?.interval,0));return t._start(),t};class xr{constructor(e,t){this._callback=e,this._interval=t,this.id=++xr._nextId,this._canceled=!1,this._nextResolvers=[]}run(){try{this._callback()}catch(e){ks.push(e);return}}_start(){this._canceled||(this._timerId=setTimeout(()=>{this._tick(),this._canceled||this._start()},this._interval))}_tick(){tt.push(this),cr();const e=this._nextResolvers.splice(0);for(const t of e)t()}next(){return this._canceled?Promise.resolve():new Promise(e=>this._nextResolvers.push(e))}cancel(){this._canceled=!0,this._timerId!==void 0&&(clearTimeout(this._timerId),this._timerId=void 0);const e=this._nextResolvers.splice(0);for(const t of e)t()}}xr._nextId=0;const uu=Ts.createInterface("ICoercionConfiguration"),Sr=0,Ps=1,cm=2,hm=4,ba=ma({None:Sr,Observer:Ps,Node:cm,Layout:hm});function Zs(n=0){const e=Array(n);let t=0;for(;t<n;)e[t]=t++;return e.deletedIndices=[],e.deletedItems=[],e.isIndexMap=!0,e}let um=!1;const At=(()=>{function n(a,c){return a==null?r:r(a)}function e(){return Ft(this,"subs",new o)}function t(a){return this.subs.add(a)}function s(a){return this.subs.remove(a)}const i=new WeakSet;function r(a,c){if(!i.has(a)){i.add(a);const l=a.prototype;Cs(l,"subs",{get:e}),Zt(l,"subscribe",t),Zt(l,"unsubscribe",s)}return a}class o{constructor(){this.count=0,this._subs=[],this._requestDirtySubs=[],this._hasDirtySubs=!1}add(c){return this._subs.includes(c)?!1:(this._subs[this._subs.length]=c,"handleDirty"in c&&(this._requestDirtySubs[this._requestDirtySubs.length]=c,this._hasDirtySubs=!0),++this.count,!0)}remove(c){let l=this._subs.indexOf(c);return l!==-1?(this._subs.splice(l,1),l=this._requestDirtySubs.indexOf(c),l!==-1&&(this._requestDirtySubs.splice(l,1),this._hasDirtySubs=this._requestDirtySubs.length>0),--this.count,!0):!1}notify(c,l){for(const h of this._subs.slice(0))h.handleChange(c,l)}notifyCollection(c,l){const h=this._subs.slice(0),u=h.length;let d=0;for(;d<u;++d)h[d].handleCollectionChange(c,l)}notifyDirty(){if(this._hasDirtySubs)for(const c of this._requestDirtySubs.slice(0))c.handleDirty()}}return n})();class du{constructor(e){this.owner=e,this.type=Ps,this._value=(this._obj=e.collection).length}getValue(){return this._obj.length}setValue(e){e!==this._value&&(Number.isNaN(e)?console.warn(`Invalid value "${e}" for array length`):(this._obj.splice(e),this._value=this._obj.length))}handleDirty(){this._value!==this._obj.length&&this.subs.notifyDirty()}handleCollectionChange(e,t){const s=this._value,i=this._obj.length;(this._value=i)!==s&&(this.subs.notifyDirty(),this.subs.notify(this._value,s))}}fu(du);class va{constructor(e){this.owner=e,this.type=Ps,this._value=(this._obj=e.collection).size}getValue(){return this._obj.size}setValue(){throw Q(220)}handleDirty(){this._value!==this._obj.size&&this.subs.notifyDirty()}handleCollectionChange(e,t){const s=this._value,i=this._obj.size;(this._value=i)!==s&&this.subs.notify(this._value,s)}}fu(va);function fu(n){const e=n.prototype;return Zt(e,"subscribe",dm),Zt(e,"unsubscribe",fm),At(n,null)}function dm(n){this.subs.add(n)&&this.subs.count===1&&this.owner.subscribe(this)}function fm(n){this.subs.remove(n)&&this.subs.count===0&&this.owner.subscribe(this)}const hi=(()=>{const n=Symbol.for("__au_arr_obs__"),e=Array[n]??Ft(Array,n,new WeakMap);function t(f,g){return f===g?0:(f=f===null?"null":f.toString(),g=g===null?"null":g.toString(),f<g?-1:1)}function s(f,g){return f===void 0?g===void 0?0:1:g===void 0?-1:0}function i(f,g,w,I,M){let A,S,P,T,N,j,H;for(j=w+1;j<I;j++){for(A=f[j],S=g[j],H=j-1;H>=w&&(P=f[H],T=g[H],N=M(P,A),N>0);H--)f[H+1]=P,g[H+1]=T;f[H+1]=A,g[H+1]=S}}function r(f,g,w,I,M){let A=0,S=0,P,T,N,j,H,he,Ie,pe,ue,ke,Y,$,ne,F,ie,Me,b,y,_;for(;;){if(I-w<=10){i(f,g,w,I,M);return}A=w+(I-w>>1),P=f[w],j=g[w],T=f[I-1],H=g[I-1],N=f[A],he=g[A],Ie=M(P,T),Ie>0&&(ke=P,Y=j,P=T,j=H,T=ke,H=Y),pe=M(P,N),pe>=0?(ke=P,Y=j,P=N,j=he,N=T,he=H,T=ke,H=Y):(ue=M(T,N),ue>0&&(ke=T,Y=H,T=N,H=he,N=ke,he=Y)),f[w]=P,g[w]=j,f[I-1]=N,g[I-1]=he,$=T,ne=H,F=w+1,ie=I-1,f[A]=f[F],g[A]=g[F],f[F]=$,g[F]=ne;e:for(S=F+1;S<ie;S++)if(Me=f[S],b=g[S],y=M(Me,$),y<0)f[S]=f[F],g[S]=g[F],f[F]=Me,g[F]=b,F++;else if(y>0){do{if(ie--,ie==S)break e;_=f[ie],y=M(_,$)}while(y>0);f[S]=f[ie],g[S]=g[ie],f[ie]=Me,g[ie]=b,y<0&&(Me=f[S],b=g[S],f[S]=f[F],g[S]=g[F],f[F]=Me,g[F]=b,F++)}I-ie<F-w?(r(f,g,ie,I,M),I=F):(r(f,g,w,F,M),w=ie)}}const o=Array.prototype,a=["push","unshift","pop","shift","splice","reverse","sort"];let c;function l(){const f=o.push,g=o.unshift,w=o.pop,I=o.shift,M=o.splice,A=o.reverse,S=o.sort;c={push:function(...P){const T=e.get(this);if(T===void 0)return f.apply(this,P);const N=this.length,j=P.length;if(j===0)return N;this.length=T.indexMap.length=N+j;let H=N;for(;H<this.length;)this[H]=P[H-N],T.indexMap[H]=-2,H++;return T.notify(),this.length},unshift:function(...P){const T=e.get(this);if(T===void 0)return g.apply(this,P);const N=P.length,j=new Array(N);let H=0;for(;H<N;)j[H++]=-2;g.apply(T.indexMap,j);const he=g.apply(this,P);return T.notify(),he},pop:function(){const P=e.get(this);if(P===void 0)return w.call(this);const T=P.indexMap,N=w.call(this),j=T.length-1;return T[j]>-1&&(T.deletedIndices.push(T[j]),T.deletedItems.push(N)),w.call(T),P.notify(),N},shift:function(){const P=e.get(this);if(P===void 0)return I.call(this);const T=P.indexMap,N=I.call(this);return T[0]>-1&&(T.deletedIndices.push(T[0]),T.deletedItems.push(N)),I.call(T),P.notify(),N},splice:function(...P){const T=P[0],N=P[1],j=e.get(this);if(j===void 0)return M.apply(this,P);const H=this.length,he=T|0,Ie=he<0?Math.max(H+he,0):Math.min(he,H),pe=j.indexMap,ue=P.length,ke=ue===0?0:ue===1?H-Ie:N;let Y=Ie;if(ke>0){const ne=Y+ke;for(;Y<ne;)pe[Y]>-1&&(pe.deletedIndices.push(pe[Y]),pe.deletedItems.push(this[Y])),Y++}if(Y=0,ue>2){const ne=ue-2,F=new Array(ne);for(;Y<ne;)F[Y++]=-2;M.call(pe,T,N,...F)}else M.apply(pe,P);const $=M.apply(this,P);return(ke>0||Y>0)&&j.notify(),$},reverse:function(){const P=e.get(this);if(P===void 0)return A.call(this),this;const T=this.length,N=T/2|0;let j=0;for(;j!==N;){const H=T-j-1,he=this[j],Ie=P.indexMap[j],pe=this[H],ue=P.indexMap[H];this[j]=pe,P.indexMap[j]=ue,this[H]=he,P.indexMap[H]=Ie,j++}return P.notify(),this},sort:function(P){const T=e.get(this);if(T===void 0)return S.call(this,P),this;let N=this.length;if(N<2)return this;r(this,T.indexMap,0,N,s);let j=0;for(;j<N&&this[j]!==void 0;)j++;(P===void 0||!ce(P))&&(P=t),r(this,T.indexMap,0,j,P);let H=!1;for(j=0,N=T.indexMap.length;N>j;++j)if(T.indexMap[j]!==j){H=!0;break}return(H||um)&&T.notify(),this}};for(const P of a)Cs(c[P],"observing",{value:!0})}let h=!1;const u="__au_arr_on__";function d(){if(c===void 0&&l(),!(em(u,Array)??!1)){tm(!0,Array,u);for(const f of a)o[f].observing!==!0&&Ft(o,f,c[f])}}class p{constructor(g){this.type=Ps,h||(h=!0,d()),this.indexObservers={},this.collection=g,this.indexMap=Zs(g.length),this.lenObs=void 0,e.set(g,this)}notify(){const g=this.subs;g.notifyDirty();const w=this.indexMap,I=this.collection,M=I.length;this.indexMap=Zs(M),g.notifyCollection(I,w)}getLengthObserver(){return this.lenObs??=new du(this)}getIndexObserver(g){return this.indexObservers[g]??=new m(this,g)}}At(p,null);class m{constructor(g,w){this.owner=g,this.index=w,this.doNotCache=!0,this.value=this.getValue()}getValue(){return this.owner.collection[this.index]}setValue(g){if(g===this.getValue())return;const w=this.owner,I=this.index,M=w.indexMap;M[I]>-1&&M.deletedIndices.push(M[I]),M[I]=-2,w.collection[I]=g,w.notify()}handleDirty(){this.value!==this.getValue()&&this.subs.notifyDirty()}handleCollectionChange(g,w){const I=this.index;if(w[I]===I)return;const A=this.value,S=this.value=this.getValue();A!==S&&this.subs.notify(S,A)}subscribe(g){this.subs.add(g)&&this.subs.count===1&&this.owner.subscribe(this)}unsubscribe(g){this.subs.remove(g)&&this.subs.count===0&&this.owner.unsubscribe(this)}}return At(m,null),function(g){let w=e.get(g);return w===void 0&&(e.set(g,w=new p(g)),d()),w}})(),hr=(()=>{const n=Symbol.for("__au_set_obs__"),e=Set[n]??Ft(Set,n,new WeakMap),{add:t,clear:s,delete:i}=Set.prototype,r=["add","clear","delete"],o={add:function(l){const h=e.get(this);if(h===void 0)return t.call(this,l),this;const u=this.size;return t.call(this,l),this.size===u?this:(h.indexMap[u]=-2,h.notify(),this)},clear:function(){const l=e.get(this);if(l===void 0)return s.call(this);if(this.size>0){const u=l.indexMap;let d=0;for(const p of this.keys())u[d]>-1&&(u.deletedIndices.push(u[d]),u.deletedItems.push(p)),d++;s.call(this),u.length=0,l.notify()}},delete:function(l){const h=e.get(this);if(h===void 0)return i.call(this,l);if(this.size===0)return!1;let d=0;const p=h.indexMap;for(const m of this.keys()){if(m===l){p[d]>-1&&(p.deletedIndices.push(p[d]),p.deletedItems.push(m)),p.splice(d,1);const f=i.call(this,l);return f===!0&&h.notify(),f}d++}return!1}};function a(l){for(const h of r)Ft(l,h,o[h])}class c{constructor(h){this.type=Ps,this.collection=h,this.indexMap=Zs(h.size),this.lenObs=void 0}notify(){const h=this.subs;h.notifyDirty();const u=this.indexMap,d=this.collection,p=d.size;this.indexMap=Zs(p),h.notifyCollection(d,u)}getLengthObserver(){return this.lenObs??=new va(this)}}return At(c,null),function(h){let u=e.get(h);return u===void 0&&(e.set(h,u=new c(h)),a(h)),u}})(),ur=(()=>{const n=Symbol.for("__au_map_obs__"),e=Map[n]??Ft(Map,n,new WeakMap),{set:t,clear:s,delete:i}=Map.prototype,r=["set","clear","delete"],o={set:function(l,h){const u=e.get(this);if(u===void 0)return t.call(this,l,h),this;const d=this.get(l),p=this.size;if(t.call(this,l,h),this.size===p){let f=0;for(const g of this.entries()){if(g[0]===l)return g[1]!==d&&(u.indexMap.deletedIndices.push(u.indexMap[f]),u.indexMap.deletedItems.push(g),u.indexMap[f]=-2,u.notify()),this;f++}return this}return u.indexMap[p]=-2,u.notify(),this},clear:function(){const l=e.get(this);if(l===void 0)return s.call(this);if(this.size>0){const u=l.indexMap;let d=0;for(const p of this.keys())u[d]>-1&&(u.deletedIndices.push(u[d]),u.deletedItems.push(p)),d++;s.call(this),u.length=0,l.notify()}},delete:function(l){const h=e.get(this);if(h===void 0)return i.call(this,l);if(this.size===0)return!1;let d=0;const p=h.indexMap;for(const m of this.keys()){if(m===l){p[d]>-1&&(p.deletedIndices.push(p[d]),p.deletedItems.push(m)),p.splice(d,1);const f=i.call(this,l);return f===!0&&h.notify(),f}++d}return!1}};function a(l){for(const h of r)Ft(l,h,o[h])}class c{constructor(h){this.type=Ps,this.collection=h,this.indexMap=Zs(h.size),this.lenObs=void 0}notify(){const h=this.subs;h.notifyDirty();const u=this.indexMap,d=this.collection,p=d.size;this.indexMap=Zs(p),h.notifyCollection(d,u)}getLengthObserver(){return this.lenObs??=new va(this)}}return At(c,null),function(h){let u=e.get(h);return u===void 0&&(e.set(h,u=new c(h)),a(h)),u}})(),ql=(()=>{class n{constructor(h){this.version=0,this.count=0,this.o=new Map,this.b=h}add(h){this.o.has(h)||(h.subscribe(this.b),++this.count),this.o.set(h,this.version)}clear(){this.o.forEach(t,this),this.count=this.o.size}clearAll(){this.o.forEach(e,this),this.o.clear(),this.count=0}}function e(l,h){h.unsubscribe(this.b)}function t(l,h){this.version!==l&&(h.unsubscribe(this.b),this.o.delete(h))}function s(){return Ft(this,"obs",new n(this))}function i(l,h){this.obs.add(this.oL.getObserver(l,h))}function r(l){let h;if(Ee(l))h=hi(l);else if(Rn(l))h=hr(l);else if(_s(l))h=ur(l);else throw Q(210,l);this.obs.add(h)}function o(l){this.obs.add(l)}function a(){throw Q(99,"handleChange")}function c(){throw Q(99,"handleCollectionChange")}return function(h,u){const d=h.prototype;return Zt(d,"observe",i),Zt(d,"observeCollection",r),Zt(d,"subscribeTo",o),Cs(d,"obs",{get:s}),Zt(d,"handleChange",a),Zt(d,"handleCollectionChange",c),h}})();function yt(n,e){return n==null?ql:ql(n,e)}let te=null;const vn=[];let rs=!1;function pm(){rs=!1}function gm(){rs=!0}function _a(){return te}function wa(n){if(n==null)throw Q(206);if(te==null){te=n,vn[0]=te,rs=!0;return}if(te===n)throw Q(207);vn.push(n),te=n,rs=!0}function ya(n){if(n==null)throw Q(208);if(te!==n)throw Q(209);vn.pop(),te=vn.length>0?vn[vn.length-1]:null,rs=te!=null}const mm=ma({get current(){return te},get connecting(){return rs},enter:wa,exit:ya,pause:pm,resume:gm}),Bn=Reflect.get,bm=Object.prototype.toString,No=new WeakMap,vm="__au_nw__",_m="__au_nw";function pu(n){switch(bm.call(n)){case"[object Object]":return n.constructor[vm]!==!0;case"[object Array]":case"[object Map]":case"[object Set]":return!0;default:return!1}}const Nn="__raw__";function Z(n){return pu(n)?Ar(n):n}function Ar(n){return No.get(n)??wm(n)}function ae(n){return n[Nn]??n}function Ze(n){return pu(n)&&n[Nn]||n}function ka(n,e){if(e==="constructor"||e==="__proto__"||e==="$observers"||e===Symbol.toPrimitive||e===Symbol.toStringTag||n.constructor[`${_m}_${En(e)}__`]===!0)return!0;const t=Reflect.getOwnPropertyDescriptor(n,e);return t?.configurable===!1&&t.writable===!1}function wm(n){const e=Ee(n)?km:_s(n)||Rn(n)?zm:ym,t=new Proxy(n,e);return No.set(n,t),No.set(t,t),t}const ym={get(n,e,t){if(e===Nn)return n;const s=_a();return!rs||ka(n,e)||s==null?Bn(n,e,t):(s.observe(n,e),Z(Bn(n,e,t)))},deleteProperty(n,e){return console.warn("[DEV:aurelia] deletion of a property will not always be working with Aurelia observation system, as it depends on getter/setter installation."),delete n[e]}},km={get(n,e,t){if(e===Nn)return n;if(!rs||ka(n,e)||te==null)return Bn(n,e,t);switch(e){case"length":return te.observe(n,"length"),n.length;case"map":return Cm;case"includes":return Am;case"indexOf":return $m;case"lastIndexOf":return Im;case"every":return xm;case"filter":return Sm;case"find":return Em;case"findIndex":return Tm;case"flat":return Mm;case"flatMap":return Bm;case"join":return Pm;case"push":return Om;case"pop":return Rm;case"reduce":return Um;case"reduceRight":return Wm;case"reverse":return Nm;case"shift":return Lm;case"unshift":return Dm;case"slice":return Hm;case"splice":return Fm;case"some":return jm;case"sort":return Vm;case"keys":return gu;case"values":case Symbol.iterator:return jo;case"entries":return Vo}return te.observe(n,e),Z(Bn(n,e,t))},ownKeys(n){return _a()?.observe(n,"length"),Reflect.ownKeys(n)}};function Cm(n,e){const t=ae(this),s=t.map((i,r)=>Ze(n.call(e,Z(i),r,this)));return $e(te,t),Z(s)}function xm(n,e){const t=ae(this),s=t.every((i,r)=>n.call(e,Z(i),r,this));return $e(te,t),s}function Sm(n,e){const t=ae(this),s=t.filter((i,r)=>Ze(n.call(e,Z(i),r,this)));return $e(te,t),Z(s)}function Am(n){const e=ae(this),t=e.includes(Ze(n));return $e(te,e),t}function $m(n){const e=ae(this),t=e.indexOf(Ze(n));return $e(te,e),t}function Im(n){const e=ae(this),t=e.lastIndexOf(Ze(n));return $e(te,e),t}function Tm(n,e){const t=ae(this),s=t.findIndex((i,r)=>Ze(n.call(e,Z(i),r,this)));return $e(te,t),s}function Em(n,e){const t=ae(this),s=t.find((i,r)=>n(Z(i),r,this),e);return $e(te,t),Z(s)}function Mm(){const n=ae(this);return $e(te,n),Z(n.flat())}function Bm(n,e){const t=ae(this);return $e(te,t),Ar(t.flatMap((s,i)=>Z(n.call(e,Z(s),i,this))))}function Pm(n){const e=ae(this);return $e(te,e),e.join(n)}function Rm(){return Z(ae(this).pop())}function Om(...n){return ae(this).push(...n)}function Lm(){return Z(ae(this).shift())}function Dm(...n){return ae(this).unshift(...n)}function Fm(...n){return Z(ae(this).splice(...n))}function Nm(...n){return Z(ae(this).reverse())}function jm(n,e){const t=ae(this),s=t.some((i,r)=>Ze(n.call(e,Z(i),r,this)));return $e(te,t),s}function Vm(n){const e=ae(this),t=e.sort(n);return $e(te,e),Z(t)}function Hm(n,e){const t=ae(this);return $e(te,t),Ar(t.slice(n,e))}function Um(n,e){const t=ae(this),s=t.reduce((i,r,o)=>n(i,Z(r),o,this),e);return $e(te,t),Z(s)}function Wm(n,e){const t=ae(this),s=t.reduceRight((i,r,o)=>n(i,Z(r),o,this),e);return $e(te,t),Z(s)}const zm={get(n,e,t){if(e===Nn)return n;const s=_a();if(!rs||ka(n,e)||s==null)return Bn(n,e,t);switch(e){case"size":return s.observe(n,"size"),n.size;case"clear":return Gm;case"delete":return Jm;case"forEach":return qm;case"add":if(Rn(n))return Xm;break;case"get":if(_s(n))return Qm;break;case"set":if(_s(n))return Ym;break;case"has":return Km;case"keys":return gu;case"values":return jo;case"entries":return Vo;case Symbol.iterator:return _s(n)?Vo:jo}return Z(Bn(n,e,t))}};function qm(n,e){const t=ae(this);return $e(te,t),t.forEach((s,i)=>{n.call(e,Z(s),Z(i),this)})}function Km(n){const e=ae(this);return $e(te,e),e.has(Ze(n))}function Qm(n){const e=ae(this);return $e(te,e),Z(e.get(Ze(n)))}function Ym(n,e){return Z(ae(this).set(Ze(n),Ze(e)))}function Xm(n){return Z(ae(this).add(Ze(n)))}function Gm(){return Z(ae(this).clear())}function Jm(n){return Z(ae(this).delete(Ze(n)))}function gu(){const n=ae(this);$e(te,n);const e=n.keys();return{next(){const t=e.next(),s=t.value,i=t.done;return i?{value:void 0,done:i}:{value:Z(s),done:i}},[Symbol.iterator](){return this}}}function jo(){const n=ae(this);$e(te,n);const e=n.values();return{next(){const t=e.next(),s=t.value,i=t.done;return i?{value:void 0,done:i}:{value:Z(s),done:i}},[Symbol.iterator](){return this}}}function Vo(){const n=ae(this);$e(te,n);const e=n.entries();return{next(){const t=e.next(),s=t.value,i=t.done;return i?{value:void 0,done:i}:{value:[Z(s[0]),Z(s[1])],done:i}},[Symbol.iterator](){return this}}}const $e=(n,e)=>n?.observeCollection(e),Zm=ma({getProxy:Ar,getRaw:ae,wrap:Z,unwrap:Ze,rawKey:Nn});class dr{constructor(e,t,s,i,r="async"){this.type=Ps,this._oldValue=void 0,this._value=void 0,this._notified=!1,this._isQueued=!1,this._isDirty=!1,this._callback=void 0,this._coercer=void 0,this._coercionConfig=void 0,this._obj=e,this._wrapped=Z(e),this.$get=t,this.$set=s,this.oL=i,this._flush=r}init(e){this._value=e,this._isDirty=!1}getValue(){return this.subs.count===0?this.$get.call(this._obj,this._obj,this):(this._isDirty&&(this.compute(),this._isDirty=!1,this._notified=!1),this._value)}setValue(e){if(ce(this.$set))this._coercer!==void 0&&(e=this._coercer.call(null,e,this._coercionConfig)),is(e,this._value)||(this.$set.call(this._obj,e),this.run());else throw Q(221)}useCoercer(e,t){return this._coercer=e,this._coercionConfig=t,!0}useCallback(e){return this._callback=e,!0}handleDirty(){this._isDirty||(this._isDirty=!0,this.subs.notifyDirty())}handleChange(){this._isDirty=!0,this.subs.count>0&&this.run()}handleCollectionChange(){this._isDirty=!0,this.subs.count>0&&this.run()}subscribe(e){this.subs.add(e)&&this.subs.count===1&&(this._oldValue=this.compute(),this._isDirty=!1,this._notified=!1)}unsubscribe(e){this.subs.remove(e)&&this.subs.count===0&&(this._isDirty=!0,this.obs.clearAll(),this._oldValue=void 0,this._notified=!0)}run(){if(this._flush==="sync"){this._run();return}this._isQueued||(this._isQueued=!0,Nt(()=>{this._isQueued=!1,this._run()}))}_run(){const e=this._value,t=this._oldValue,s=this.compute();this._isDirty=!1,(!this._notified||!is(s,e))&&(this._callback?.(s,t),this.subs.notify(s,t),this._oldValue=this._value=s,this._notified=!0)}compute(){this.obs.version++;try{return wa(this),this._value=Ze(this.$get.call(this._wrapped,this._wrapped,this))}finally{this.obs.clear(),ya(this)}}}yt(dr,null),At(dr,null);const eb=(()=>{const n=new WeakMap,e=t=>vf(t)?t:String(t);return{get:(t,s)=>n.get(t)?.get(e(s)),_getFlush:(t,s)=>n.get(t)?.get(e(s))?.flush,set:(t,s,i)=>{n.has(t)||n.set(t,new Map),n.get(t).set(e(s),i)}}})(),Ca=Cr("IDirtyChecker",n=>n.callback(()=>{throw Q(217)})),tb={timeoutsPerCheck:25};class sb{static register(e){e.register(Ys.singleton(this,this),Ys.aliasTo(this,Ca))}constructor(){this.tracked=[],this._task=null,this._elapsedFrames=0,this.p=E(On),this.check=()=>{if(++this._elapsedFrames<tb.timeoutsPerCheck)return;this._elapsedFrames=0;const e=this.tracked.slice(0),t=e.length;let s,i=0;for(;i<t;++i)s=e[i],s.isDirty()&&s.flush()},At(Kl,null)}createProperty(e,t){return new Kl(this,e,t)}addProperty(e){this.tracked.push(e),this.tracked.length===1&&(this._task=lm(this.check,{interval:0}))}removeProperty(e){this.tracked.splice(this.tracked.indexOf(e),1),this.tracked.length===0&&(this._task.cancel(),this._task=null)}}class Kl{constructor(e,t,s){this.obj=t,this.key=s,this.type=Sr,this._oldValue=void 0,this._dirtyChecker=e}getValue(){return this.obj[this.key]}setValue(e){throw Q(219,this.key)}isDirty(){return this._oldValue!==this.obj[this.key]}flush(){const e=this._oldValue,t=this.getValue();this._oldValue=t,this.subs.notify(t,e)}subscribe(e){this.subs.add(e)&&this.subs.count===1&&(this._oldValue=this.obj[this.key],this._dirtyChecker.addProperty(this))}unsubscribe(e){this.subs.remove(e)&&this.subs.count===0&&this._dirtyChecker.removeProperty(this)}}class nb{get doNotCache(){return!0}constructor(e,t){this.type=Sr,this._obj=e,this._key=t}getValue(){return this._obj[this._key]}setValue(){}subscribe(){}unsubscribe(){}}class mu{constructor(){this.type=Sr}getValue(e,t){return e[t]}setValue(e,t,s){t[s]=e}}class xa{constructor(e,t){this.type=Ps,this._value=void 0,this._observing=!1,this._callback=void 0,this._coercer=void 0,this._coercionConfig=void 0,this._obj=e,this._key=t}getValue(){return this._value}setValue(e){this._coercer!==void 0&&(e=this._coercer.call(void 0,e,this._coercionConfig));const t=this._value;if(this._observing){if(is(e,this._value))return;this._value=e,this.subs.notifyDirty(),this.subs.notify(e,t),is(e,this._value)&&this._callback?.(e,t)}else this._value=this._obj[this._key]=e,this._callback?.(e,t)}useCallback(e){return this._callback=e,this.start(),!0}useCoercer(e,t){return this._coercer=e,this._coercionConfig=t,this.start(),!0}subscribe(e){this._observing===!1&&this.start(),this.subs.add(e)}start(){return this._observing===!1&&(this._observing=!0,this._value=this._obj[this._key],Cs(this._obj,this._key,{enumerable:!0,configurable:!0,get:au(()=>this.getValue(),{getObserver:()=>this}),set:e=>{this.setValue(e)}})),this}stop(){return this._observing&&(Cs(this._obj,this._key,{enumerable:!0,configurable:!0,writable:!0,value:this._value}),this._observing=!1),this}}At(xa,null);const Ho=new mu,jn=Cr("IObserverLocator",n=>n.singleton(ob)),Sa=Cr("INodeObserverLocator",n=>n.cachedCallback(e=>(e.getAll(Xs).forEach(t=>{t.error("Using default INodeObserverLocator implementation. Will not be able to observe nodes (HTML etc...).")}),new ib)));class ib{handles(){return!1}getObserver(){return Ho}getAccessor(){return Ho}}const rb=Cr("IComputedObserverLocator",n=>n.singleton(class{getObserver(t,s,i,r){const o=new dr(t,i.get,i.set,r,eb._getFlush(t,s));return Cs(t,s,{enumerable:i.enumerable,configurable:!0,get:au((()=>o.getValue()),{getObserver:()=>o}),set:a=>{o.setValue(a)}}),o}}));class ob{constructor(){this._adapters=[],this._dirtyChecker=E(Ca),this._nodeObserverLocator=E(Sa),this._computedObserverLocator=E(rb)}addAdapter(e){this._adapters.push(e)}getObserver(e,t){if(e==null)throw Q(199,t);if(!jc(e))return new nb(e,ce(t)?"":t);if(ce(t))return new dr(e,t,void 0,this);const s=bu(e);let i=s[t];return i===void 0&&(i=this.createObserver(e,t),i.doNotCache||(s[t]=i)),i}getAccessor(e,t){const s=e.$observers?.[t];return s!==void 0?s:this._nodeObserverLocator.handles(e,t,this)?this._nodeObserverLocator.getAccessor(e,t,this):Ho}getArrayObserver(e){return hi(e)}getMapObserver(e){return ur(e)}getSetObserver(e){return hr(e)}createObserver(e,t){if(this._nodeObserverLocator.handles(e,t,this))return this._nodeObserverLocator.getObserver(e,t,this);switch(t){case"length":if(Ee(e))return hi(e).getLengthObserver();break;case"size":if(_s(e))return ur(e).getLengthObserver();if(Rn(e))return hr(e).getLengthObserver();break;default:if(Ee(e)&&wi(t))return hi(e).getIndexObserver(Number(t));break}let s=Yl(e,t);if(s===void 0){let i=Ql(e);for(;i!==null&&(s=Yl(i,t),s===void 0);)i=Ql(i)}if(s!==void 0&&!Zg.call(s,"value")){let i=this._getAdapterObserver(e,t,s);return i==null&&(i=s.get?.getObserver?.(e)),i??(s.configurable?this._computedObserverLocator.getObserver(e,t,s,this):this._dirtyChecker.createProperty(e,t))}return new xa(e,t)}_getAdapterObserver(e,t,s){if(this._adapters.length>0)for(const i of this._adapters){const r=i.getObserver(e,t,s,this);if(r!=null)return r}return null}}const Aa=n=>{let e;return Ee(n)?e=hi(n):_s(n)?e=ur(n):Rn(n)&&(e=hr(n)),e},Ql=Object.getPrototypeOf,Yl=Object.getOwnPropertyDescriptor,bu=n=>{let e=n.$observers;return e===void 0&&Cs(n,"$observers",{value:e=de()}),e};class ab{constructor(e,t){this.oL=e,this.fn=t,this.maxRunCount=10,this.queued=!1,this.running=!1,this.runCount=0,this.stopped=!1,this._cleanupTask=void 0,this.run=()=>{if(this.stopped)throw Q(225);if(!this.running){++this.runCount,this.running=!0,this.queued=!1,++this.obs.version;try{this._cleanupTask?.call(void 0),wa(this),this._cleanupTask=this.fn(this)}finally{this.obs.clear(),this.running=!1,ya(this)}if(this.queued){if(this.runCount>this.maxRunCount)throw this.runCount=0,Q(226);this.run()}else this.runCount=0}},this.stop=()=>{this._cleanupTask?.call(void 0),this._cleanupTask=void 0,this.stopped=!0,this.obs.clearAll()}}handleChange(){this.queued=!0,this.run()}handleCollectionChange(){this.queued=!0,this.run()}}yt(ab,null);class Xl{constructor(e,t,s,i){this.oL=t,this._value=void 0,this.boundFn=!1,this._scope=e,this.ast=s,this._callback=i}handleChange(){this.run()}handleCollectionChange(){this.run()}run(){this.obs.version++;const e=this._value,t=ye(this.ast,this._scope,this,this);this.obs.clear(),is(t,e)||(this._value=t,this._callback.call(void 0,t,e))}stop(){this.obs.clearAll(),this._value=void 0}}yt(Xl,null),im(Xl);const zn="pending",Gi="running",io="completed",Ni="canceled",ro=new Map,Gl=n=>()=>{throw en(`AUR1005: The PLATFORM did not receive a valid reference to the global function '${n}'.`)};class $a{constructor(e,t={}){this.macroTaskRequested=!1,this.macroTaskHandle=-1,this.globalThis=e,"decodeURI decodeURIComponent encodeURI encodeURIComponent Date Reflect console".split(" ").forEach(s=>{this[s]=s in t?t[s]:e[s]}),"clearInterval clearTimeout queueMicrotask setInterval setTimeout".split(" ").forEach(s=>{this[s]=s in t?t[s]:e[s]?.bind(e)??Gl(s)}),this.performanceNow="performanceNow"in t?t.performanceNow:e.performance?.now?.bind(e.performance)??Gl("performance.now"),this.flushMacroTask=this.flushMacroTask.bind(this),this.taskQueue=new Ia(this,this.requestMacroTask.bind(this),this.cancelMacroTask.bind(this))}static getOrCreate(e,t={}){let s=ro.get(e);return s===void 0&&ro.set(e,s=new $a(e,t)),s}static set(e,t){ro.set(e,t)}requestMacroTask(){this.macroTaskRequested=!0,this.macroTaskHandle===-1&&(this.macroTaskHandle=this.setTimeout(this.flushMacroTask,0))}cancelMacroTask(){this.macroTaskRequested=!1,this.macroTaskHandle>-1&&(this.clearTimeout(this.macroTaskHandle),this.macroTaskHandle=-1)}flushMacroTask(){this.macroTaskHandle=-1,this.macroTaskRequested===!0&&(this.macroTaskRequested=!1,this.taskQueue.flush())}}class Ia{get isEmpty(){return this._pendingAsyncCount===0&&this._processing.length===0&&this._pending.length===0&&this._delayed.length===0}get _hasNoMoreFiniteWork(){return this._pendingAsyncCount===0&&this._processing.every(oo)&&this._pending.every(oo)&&this._delayed.every(oo)}constructor(e,t,s){this.platform=e,this.$request=t,this.$cancel=s,this._suspenderTask=void 0,this._pendingAsyncCount=0,this._processing=[],this._pending=[],this._delayed=[],this._flushRequested=!1,this._yieldPromise=void 0,this._lastRequest=0,this._lastFlush=0,this._requestFlush=()=>{this._tracer.enabled&&this._tracer.enter(this,"requestFlush"),this._flushRequested||(this._flushRequested=!0,this._lastRequest=this._now(),this.$request()),this._tracer.enabled&&this._tracer.leave(this,"requestFlush")},this._now=e.performanceNow,this._tracer=new hb(e.console)}flush(e=this._now()){if(this._tracer.enabled&&this._tracer.enter(this,"flush"),this._flushRequested=!1,this._lastFlush=e,this._suspenderTask===void 0){let t;if(this._pending.length>0&&(this._processing.push(...this._pending),this._pending.length=0),this._delayed.length>0)for(let i=0;i<this._delayed.length;++i)t=this._delayed[i],t.queueTime<=e&&(this._processing.push(t),this._delayed.splice(i--,1));let s;for(;this._processing.length>0;)if((s=this._processing.shift()).run(),s.status===Gi)if(s.suspend===!0){this._suspenderTask=s,this._requestFlush(),this._tracer.enabled&&this._tracer.leave(this,"flush early async");return}else++this._pendingAsyncCount;if(this._pending.length>0&&(this._processing.push(...this._pending),this._pending.length=0),this._delayed.length>0)for(let i=0;i<this._delayed.length;++i)t=this._delayed[i],t.queueTime<=e&&(this._processing.push(t),this._delayed.splice(i--,1));if((this._processing.length>0||this._delayed.length>0||this._pendingAsyncCount>0)&&this._requestFlush(),this._yieldPromise!==void 0&&this._hasNoMoreFiniteWork){const i=this._yieldPromise;this._yieldPromise=void 0,i.resolve()}}else this._requestFlush();this._tracer.enabled&&this._tracer.leave(this,"flush full")}cancel(){this._tracer.enabled&&this._tracer.enter(this,"cancel"),this._flushRequested&&(this.$cancel(),this._flushRequested=!1),this._tracer.enabled&&this._tracer.leave(this,"cancel")}async yield(){this._tracer.enabled&&this._tracer.enter(this,"yield"),this.isEmpty?this._tracer.enabled&&this._tracer.leave(this,"yield empty"):(this._yieldPromise===void 0&&(this._tracer.enabled&&this._tracer.trace(this,"yield - creating promise"),this._yieldPromise=wu()),await this._yieldPromise,this._tracer.enabled&&this._tracer.leave(this,"yield task"))}queueTask(e,t){this._tracer.enabled&&this._tracer.enter(this,"queueTask");const{delay:s,preempt:i,persistent:r,suspend:o}={...ub,...t};if(i){if(s>0)throw fb();if(r)throw pb()}this._processing.length===0&&this._requestFlush();const a=this._now(),c=new cb(this._tracer,this,a,a+s,i,r,o,e);return i?this._processing[this._processing.length]=c:s===0?this._pending[this._pending.length]=c:this._delayed[this._delayed.length]=c,this._tracer.enabled&&this._tracer.leave(this,"queueTask"),c}remove(e){this._tracer.enabled&&this._tracer.enter(this,"remove");let t=this._processing.indexOf(e);if(t>-1){this._processing.splice(t,1),this._tracer.enabled&&this._tracer.leave(this,"remove processing");return}if(t=this._pending.indexOf(e),t>-1){this._pending.splice(t,1),this._tracer.enabled&&this._tracer.leave(this,"remove pending");return}if(t=this._delayed.indexOf(e),t>-1){this._delayed.splice(t,1),this._tracer.enabled&&this._tracer.leave(this,"remove delayed");return}throw this._tracer.enabled&&this._tracer.leave(this,"remove error"),en(`Task #${e.id} could not be found`)}_resetPersistentTask(e){this._tracer.enabled&&this._tracer.enter(this,"resetPersistentTask"),e.reset(this._now()),e.createdTime===e.queueTime?this._pending[this._pending.length]=e:this._delayed[this._delayed.length]=e,this._tracer.enabled&&this._tracer.leave(this,"resetPersistentTask")}_completeAsyncTask(e){if(this._tracer.enabled&&this._tracer.enter(this,"completeAsyncTask"),e.suspend===!0){if(this._suspenderTask!==e)throw this._tracer.enabled&&this._tracer.leave(this,"completeAsyncTask error"),en(`Async task completion mismatch: suspenderTask=${this._suspenderTask?.id}, task=${e.id}`);this._suspenderTask=void 0}else--this._pendingAsyncCount;if(this._yieldPromise!==void 0&&this._hasNoMoreFiniteWork){const t=this._yieldPromise;this._yieldPromise=void 0,t.resolve()}this.isEmpty&&this.cancel(),this._tracer.enabled&&this._tracer.leave(this,"completeAsyncTask")}}class Jl extends Error{constructor(e){super("Task was canceled."),this.task=e}}let lb=0;class cb{get result(){const e=this._result;if(e===void 0)switch(this._status){case zn:{const t=this._result=wu();return this._resolve=t.resolve,this._reject=t.reject,t}case Gi:throw en("Trying to await task from within task will cause a deadlock.");case io:return this._result=Promise.resolve();case Ni:return this._result=Promise.reject(new Jl(this))}return e}get status(){return this._status}constructor(e,t,s,i,r,o,a,c){this.taskQueue=t,this.createdTime=s,this.queueTime=i,this.preempt=r,this.persistent=o,this.suspend=a,this.callback=c,this.id=++lb,this._resolve=void 0,this._reject=void 0,this._result=void 0,this._status=zn,this._tracer=e}run(e=this.taskQueue.platform.performanceNow()){if(this._tracer.enabled&&this._tracer.enter(this,"run"),this._status!==zn)throw this._tracer.enabled&&this._tracer.leave(this,"run error"),en(`Cannot run task in ${this._status} state`);const{persistent:t,taskQueue:s,callback:i,_resolve:r,_reject:o,createdTime:a}=this;let c;this._status=Gi;try{c=i(e-a),c instanceof Promise?c.then(l=>{this.persistent?s._resetPersistentTask(this):(t?this._status=Ni:this._status=io,this.dispose()),s._completeAsyncTask(this),this._tracer.enabled&&this._tracer.leave(this,"run async then"),r!==void 0&&r(l)}).catch(l=>{if(this.persistent||this.dispose(),s._completeAsyncTask(this),this._tracer.enabled&&this._tracer.leave(this,"run async catch"),o!==void 0)o(l);else throw l}):(this.persistent?s._resetPersistentTask(this):(t?this._status=Ni:this._status=io,this.dispose()),this._tracer.enabled&&this._tracer.leave(this,"run sync success"),r!==void 0&&r(c))}catch(l){if(this.persistent||this.dispose(),this._tracer.enabled&&this._tracer.leave(this,"run sync error"),o!==void 0)o(l);else throw l}}cancel(){if(this._tracer.enabled&&this._tracer.enter(this,"cancel"),this._status===zn){const e=this.taskQueue,t=this._reject;return e.remove(this),e.isEmpty&&e.cancel(),this._status=Ni,this.dispose(),t!==void 0&&t(new Jl(this)),this._tracer.enabled&&this._tracer.leave(this,"cancel true =pending"),!0}else if(this._status===Gi&&this.persistent)return this.persistent=!1,this._tracer.enabled&&this._tracer.leave(this,"cancel true =running+persistent"),!0;return this._tracer.enabled&&this._tracer.leave(this,"cancel false"),!1}reset(e){this._tracer.enabled&&this._tracer.enter(this,"reset");const t=this.queueTime-this.createdTime;this.createdTime=e,this.queueTime=e+t,this._status=zn,this._resolve=void 0,this._reject=void 0,this._result=void 0,this._tracer.enabled&&this._tracer.leave(this,"reset")}dispose(){this._tracer.enabled&&this._tracer.trace(this,"dispose"),this.callback=void 0,this._resolve=void 0,this._reject=void 0,this._result=void 0}}class hb{constructor(e){this.console=e,this.enabled=!1,this.depth=0}enter(e,t){this.log(`${"  ".repeat(this.depth++)}> `,e,t)}leave(e,t){this.log(`${"  ".repeat(--this.depth)}< `,e,t)}trace(e,t){this.log(`${"  ".repeat(this.depth)}- `,e,t)}log(e,t,s){if(t instanceof Ia){const i=t._processing.length,r=t._pending.length,o=t._delayed.length,a=t._flushRequested,c=!!t._suspenderTask,l=`processing=${i} pending=${r} delayed=${o} flushReq=${a} susTask=${c}`;this.console.log(`${e}[Q.${s}] ${l}`)}else{const i=t.id,r=Math.round(t.createdTime*10)/10,o=Math.round(t.queueTime*10)/10,a=t.preempt,c=t.persistent,l=t.suspend,h=t._status,u=`id=${i} created=${r} queue=${o} preempt=${a} persistent=${c} status=${h} suspend=${l}`;this.console.log(`${e}[T.${s}] ${u}`)}}}const ub={delay:0,preempt:!1,persistent:!1,suspend:!1};let vu,_u;const db=(n,e)=>{vu=n,_u=e},wu=()=>{const n=new Promise(db);return n.resolve=vu,n.reject=_u,n},oo=n=>n.persistent,fb=()=>en("AUR1006: Invalid arguments: preempt cannot be combined with a greater-than-zero delay"),pb=()=>en("AUR1007: Invalid arguments: preempt cannot be combined with persistent"),en=n=>new Error(n);class bs extends $a{static getOrCreate(e,t={}){let s=bs._lookup.get(e);return s===void 0&&bs._lookup.set(e,s=new bs(e,t)),s}static set(e,t){bs._lookup.set(e,t)}get domWriteQueue(){return this.console.log("[DEV:aurelia] platform.domQueue is deprecated, please use platform.domQueue instead."),this.domQueue}get domReadQueue(){return this.console.log("[DEV:aurelia] platform.domReadQueue has been removed, please use platform.domQueue instead."),this.domQueue}constructor(e,t={}){super(e,t);const s=i=>()=>{throw new Error(`The PLATFORM did not receive a valid reference to the global function '${i}'.`)};"Node Element HTMLElement CustomEvent CSSStyleSheet ShadowRoot MutationObserver window document customElements".split(" ").forEach(i=>this[i]=i in t?t[i]:e[i]),"fetch requestAnimationFrame cancelAnimationFrame".split(" ").forEach(i=>this[i]=i in t?t[i]:e[i]?.bind(e)??s(i)),this.domQueue=(()=>{let i=!1,r=-1;const o=()=>{i=!0,r===-1&&(r=this.requestAnimationFrame(c))},a=()=>{i=!1,r>-1&&(this.cancelAnimationFrame(r),r=-1)},c=()=>{r=-1,i===!0&&(i=!1,l.flush())},l=new Ia(this,o,a);return l})()}}bs._lookup=new WeakMap;const{default:Ta,oneTime:$r,toView:Ae,fromView:os,twoWay:yu}=Mi,Qe=as.get,Ir=as.has,$t=as.define,{annotation:gb}=qc,ls=gb.keyFor,Pi=Object,tn=String,ku=Pi.prototype,qs=ku.hasOwnProperty,cs=Pi.freeze,Cu=Pi.assign,xu=Pi.getOwnPropertyNames,Ea=Pi.keys,Zl=de(),Uo=(n,e,t)=>{if(Zl[e]===!0)return!0;if(!se(e))return!1;const s=e.slice(0,5);return Zl[e]=s==="aria-"||s==="data-"||t.isStandardSvgAttribute(n,e)},Wo=n=>{throw n},Su=Reflect.defineProperty,ct=(n,e,t)=>(Su(n,e,{enumerable:!1,configurable:!0,writable:!0,value:t}),t),Au=(n,e,t)=>n.addSignalListener(e,t),$u=(n,e,t)=>n.removeSignalListener(e,t),mb="Interpolation",bb="IsIterator",vb="IsFunction",jt="IsProperty",ec="pending",ao="running",Ma=ba.Observer,Rs=ba.Node,zt=ba.Layout,B=(n,...e)=>{const t=tn(n).padStart(4,"0"),s=wb(n,...e),i=`https://docs.aurelia.io/developer-guides/error-messages/runtime-html/aur${t}`;return new Error(`AUR${t}: ${s}

For more information, see: ${i}`)},_b={99:"Method {{0}} not implemented",101:'Ast eval error: binding behavior "{{0}}" could not be found. Did you forget to register it as a dependency?',102:'Ast eval error: binding behavior "{{0}}" already applied.',103:'Ast eval error: value converter "{{0}}" could not be found. Did you forget to register it as a dependency?',105:"Ast eval error: unable to find $host context. Did you forget [au-slot] attribute?",106:'Ast eval error: invalid assignment. "$host" is a reserved keyword.',107:"Ast eval error: expression is not a function.",109:'Ast eval error: unknown unary operator: "{{0}}"',108:'Ast eval error: unknown binary operator: "{{0}}"',110:"Ast eval error: left-hand side of tagged template expression is not a function.",111:'Ast eval error: expected "{{0}}" to be a function',112:"Ast eval error: cannot use non-object value for destructuring assignment.",113:"Ast eval error: infinite loop detected. Increment operators should only be used in event handlers.",114:'Ast eval error: cannot access property "{{0}}" of {{1}}.',115:'Ast eval error: cannot access key "{{0}}" of {{1}}.',116:'Ast eval error: cannot assign value to property "{{0}}" of null/undefined.',151:"No binding behavior definition found for type {{0:name}}",152:"No value converter definition found for type {{0:name}}",153:'Element "{{0}}" has already been registered.',154:'Attribute "{{0}}" has already been registered.',155:"Value converter {{0}} has already been registered.",156:"Binding behavior {{0}} has already been registered.",157:"Binding command {{0}} has already been registered.",203:"Trying to retrieve a property or build a scope from a null/undefined scope",204:"Trying to create a scope with null/undefined binding context",227:"@bindable is not supported for properties that uses a symbol for name. Use a string for the property name instead.",228:"@bindable cannot be used as a class decorator when no configuration object is supplied.",229:"@bindable cannot be used as a class decorator when no property name is supplied in the configuration object.",500:"There is no cached controller for the provided ViewModel: {{0}}",501:"Invalid combination: cannot combine the containerless custom element option with Shadow DOM.",502:"Trying to activate a disposed controller: {{0}}.",503:"Controller at {{0}} is in an unexpected state: {{1}} during activation.",504:"Synthetic view at {{0}} is being activated with null/undefined scope.",505:"Controller at {{0}} is in an unexpected state: {{1}} during deactivation.",506:"Invalid callback for @watch decorator: {{0}}",507:"Observer for bindable property {{0}} does not support coercion.",508:"Observer for property {{0}} does not support change handler.",759:"No attribute definition found for type {{0:name}}",760:"No element definition found for type {{0:name}}",761:"Cannot create a custom element definition with only a name and no type: {{0}}",762:"Trying to retrieve a custom element controller from a node, but the provided node <{{0:nodeName}} /> is not a custom element or containerless host.",763:"Trying to retrieve a custom element controller from a node, but the provided node <{{0:nodeName}} /> is not a custom element or containerless host.",764:"Trying to retrieve a custom element controller from a node. But the provided node <{{0:nodeName}} /> does not appear to be part of an Aurelia app DOM tree, or it was added to the DOM in a way that Aurelia cannot properly resolve its position in the component tree.",765:"Trying to retrieve a custom element controller from a node. But the provided node <{{0:nodeName}} /> does not appear to be part of an Aurelia app DOM tree, or it was added to the DOM in a way that Aurelia cannot properly resolve its position in the component tree.",766:"Invalid @processContent hook. Expected the hook to be a function (when defined in a class, it needs to be a static function) but got a {{0:typeof}}.",652:"Aurelia is unable to observe property {{0}}. Register observation mapping with .useConfig().",653:"Mapping for property {{0}} of <{{1}} /> already exists",654:"Array values can only be bound to a multi-select.",714:'Template compilation error: primary already exists on element/attribute "{{0}}"',719:"Attribute {{0}} has been already registered for {{1:element}}",767:"Aurelia.root was accessed without a valid root.",768:"An instance of Aurelia is already registered with the container or an ancestor of it.",769:"Failed to initialize the platform object. The host element's ownerDocument does not have a defaultView, did you create the host from a DOMParser and forget to call adoptNode()?",770:"Aurelia.start() was called without a composition root",771:"The aurelia instance must be fully stopped before it can be disposed",750:"view.ref is not supported. If you are migrating from v1, this can be understood as the controller.",751:`Attempted to reference "{{0}}", but it was not found amongst the target's API.`,752:"Element {{0:.res}} is not registered in {{1:name}}.",753:"Attribute {{0:.res}} is not registered in {{1:name}}.",754:"Attribute {{0:.res}} is not registered in {{1:name}}.",755:"Cannot resolve ViewFactory before the provider was prepared.",756:"Cannot resolve ViewFactory without a (valid) name.",757:"AUR0757: The compiled template is not aligned with the render instructions. There are {{0}} targets and {{1}} instructions.",772:"Invalid @watch decorator config. Expected an expression or a fn but received null/undefined.",773:'Invalid @watch decorator change handler config.Method "{{0}}" not found in class {{1}}',774:"Invalid @watch decorator usage: decorated target {{0}} is not a class method.",775:'Invalid command "{{0}}" usage with [repeat]',776:'Invalid [repeat] usage, found extraneous target "{{0}}"',777:"Unsupported: [repeat] cannot iterate over {{0:toString}}",778:"Unsupported: [repeat] cannot count {{0:toString}}",814:"[repeat] encountered an error: number of views != number of items {{0:join(!=)}}",779:"Invalid portal insertion position: {{0}}",801:'"& self" binding behavior only supports listener binding via trigger/capture command.',802:`"& updateTrigger" invalid usage. This binding behavior requires at least one event name argument: eg <input value.bind="firstName & updateTrigger:'blur'">`,803:'"& updateTrigger" invalid usage. This binding behavior can only be applied to two-way/ from-view bindings.',805:'Invalid scope behavior "{{0}}" on <au-compose />. Only "scoped" or "auto" allowed.',806:`<au-compose /> couldn't find a custom element with name "{{0}}", did you forget to register it locally or globally?`,807:"Composition has already been activated/deactivated. Id: {{0:controller}}",808:"Composition has already been deactivated.",810:"Invalid [else] usage, it should follow an [if]",811:"Invalid portal strict target query, empty query.",812:"Invalid portal strict target resolution, target not found.",813:'Invalid [pending]/[then]/[catch] usage. The parent [promise].resolve not found; only "*[promise.resolve] > *[pending|then|catch]" relation is supported.',815:'Invalid [case/default-case] usage. The parent [switch] not found; only "*[switch] > *[case|default-case]" relation is supported.',816:"Invalid [default-case] usage. Multiple 'default-case's are not allowed.",817:'"& signal" binding behavior can only be used with bindings that have a "handleChange" method',818:`"& signal" invalid usage. At least one signal name must be passed to the signal behavior, e.g. "expr & signal:'my-signal'"`,819:"Spreading to bindables onto non custom element",820:"Invalid spread target {{0}}",9999:"No scope context for spread binding.",9998:"Spread binding does not support spreading custom attributes/template controllers. Did you build the spread instruction manually?",9997:"Marker is malformed. This likely happens when a compiled template has been modified. Did you accidentally modified some compiled template? You can modify template before compilation with compiling Template compiler hook.",9996:"Invalid usage, a rate limit has already been applied. Did you have both throttle and debounce on the same binding?",9995:"The binding already has a target subscriber.",9994:`"& attr" can be only used on property binding. It's used on {{0:ctor}}`,9993:'"& updateTrigger" binding behavior only works with the default implementation of Aurelia HTML observation. Implement your own node observation + updateTrigger',9992:'"& updateTrigger" uses node observer to observe, but it does not know how to use events to observe property <{{0:target@property}} />',9991:"Invalid @children usage. @children decorator can only be used on a field",9990:"Invalid @slotted usage. @slotted decorator can only be used on a field",9989:"Invalid query selector. Only selectors with alpha-numeric characters, or $all are allowed. Got {{0}} instead."},wb=(n,...e)=>{let t=_b[n];for(let s=0;s<e.length;++s){const i=new RegExp(`{{${s}(:.*)?}}`,"g");let r=i.exec(t);for(;r!=null;){const o=r[1]?.slice(1);let a=e[s];if(a!=null)switch(o){case"nodeName":a=a.nodeName.toLowerCase();break;case"name":a=a.name;break;case"typeof":a=typeof a;break;case"ctor":a=a.constructor.name;break;case"controller":a=a.controller.name;break;case"target@property":a=`${a.target}@${a.targetProperty}`;break;case"toString":a=Object.prototype.toString.call(a);break;case"join(!=)":a=a.join("!=");break;case"bindingCommandHelp":a=yb(a);break;case"element":a=a==="*"?"all elements":`<${a} />`;break;default:o?.startsWith(".")?a=tn(a[o.slice(1)]):a=tn(a)}t=t.slice(0,r.index)+a+t.slice(i.lastIndex),r=i.exec(t)}}return t};function yb(n){switch(n){case"delegate":return`
The ".delegate" binding command has been removed in v2. Binding command ".trigger" should be used instead. If you are migrating v1 application, install compat package to add back the ".delegate" binding command for ease of migration.`;case"call":return`
The ".call" binding command has been removed in v2. If you want to pass a callback that preserves the context of the function call, you can use lambda instead. Refer to lambda expression doc for more details.`;default:return""}}function ji(n,e){let t;function s(i,r){let o;switch(r.kind){case"getter":case"field":{const l=r.name;if(typeof l!="string")throw B(227);o=l;break}case"class":if(t==null)throw B(228);if(typeof t=="string")o=t;else{const l=t.name;if(!l)throw B(229);if(typeof l!="string")throw B(227);o=l}break}const a=t==null||typeof t=="string"?{name:o}:t,c=r.metadata[fn]??=de();c[o]=ts.create(o,a)}if(arguments.length>1){t={},s(n,e);return}else if(se(n))return t=n,s;return t=n===void 0?{}:n,s}const fn=ls("bindables"),at=cs({name:fn,keyFrom:n=>`${fn}:${n}`,from(...n){const e={},t=Array.isArray;function s(o){e[o]=ts.create(o)}function i(o,a){e[o]=a instanceof ts?a:ts.create(o,a===!0?{}:a)}function r(o){t(o)?o.forEach(a=>se(a)?s(a):i(a.name,a)):o instanceof ts?e[o.name]=o:o!==void 0&&Ea(o).forEach(a=>i(a,o[a]))}return n.forEach(r),e},getAll(n){const e=[],t=kf(n);let s=t.length,i;for(;--s>=0;){i=t[s];const r=Qe(fn,i);r!=null&&e.push(...Object.values(r))}return e},_add(n,e){let t=Qe(fn,e);t==null&&$t(t=de(),e,fn),t[n.name]=n}});class ts{constructor(e,t,s,i,r,o){this.attribute=e,this.callback=t,this.mode=s,this.primary=i,this.name=r,this.set=o}static create(e,t={}){const s=t.mode??Ae;return new ts(t.attribute??Uc(e),t.callback??`${e}Changed`,se(s)?Mi[s]??Ta:s,t.primary??!1,t.name??e,t.set??kb(t))}}const zo={key:ls("coercer"),define(n,e){$t(n[e].bind(n),n,zo.key)},for(n){return Qe(zo.key,n)}};function kb(n={}){const e=n.type??null;if(e==null)return wt;let t;switch(e){case Number:case Boolean:case String:case BigInt:t=e;break;default:{const s=e.coerce;t=typeof s=="function"?s.bind(e):zo.for(e)??wt;break}}return t===wt?t:Cb(t,n.nullable)}function Cb(n,e){return function(t,s){return s?.enableCoercion?(e??!(s?.coerceNullish??!1))&&t==null?t:n(t,s):t}}const me=Ts.createInterface,qt=Ys.singleton,xs=Ys.aliasTo,Iu=Ys.instance,we=(n,e,t)=>n.registerResolver(e,t),xb="custom-element",Sb="custom-attribute",Ss=(n,e,t,s="__au_static_resource__")=>{let i=Qe(s,n);return i==null&&n.$au?.type===e&&(i=t(n.$au,n),$t(i,n,s)),i};class ui{constructor(e,t,s,i){this.Type=e,this.name=t,this.aliases=s,this.key=i}static create(e,t){let s,i;return se(e)?(s=e,i={name:s}):(s=e.name,i=e),new ui(t,gs(tc(t,"name"),s),Be(tc(t,"aliases"),i.aliases,t.aliases),Tu.keyFrom(s))}register(e,t){const s=this.Type,i=typeof t=="string"?di(t):this.key,r=this.aliases;e.has(i,!1)?console.warn(`[DEV:aurelia] ${B(156,this.name)}`):e.register(e.has(s,!1)?null:qt(s,s),xs(s,i),...r.map(o=>xs(s,di(o))))}}const _t="binding-behavior",pn=rn(_t),tc=(n,e)=>Qe(ls(e),n),di=n=>`${pn}:${n}`,Tu=cs({name:pn,keyFrom:di,isType(n){return ce(n)&&(Ir(pn,n)||n.$au?.type===_t)},define(n,e){const t=ui.create(n,e),s=t.Type;return $t(t,s,pn,Pt),s},getDefinition(n){const e=Qe(pn,n)??Ss(n,_t,ui.create);if(e===void 0)throw B(151,n);return e},find(n,e){const t=n.find(_t,e);return t==null?null:Qe(pn,t)??Ss(t,_t,ui.create)??null},get(n,e){try{return n.get(Tn(di(e)))}catch(t){throw console.error("[DEV:aurelia] Cannot retrieve binding behavior with name",e),t}return n.get(Tn(di(e)))}}),lo=new Map,Tr=n=>({type:_t,name:n});class Er{bind(e,t){lo.set(t,t.mode),t.mode=this.mode}unbind(e,t){t.mode=lo.get(t),lo.delete(t)}}class Eu extends Er{get mode(){return $r}}Eu.$au=Tr("oneTime");class Mu extends Er{get mode(){return Ae}}Mu.$au=Tr("toView");class Bu extends Er{get mode(){return os}}Bu.$au=Tr("fromView");class Pu extends Er{get mode(){return yu}}Pu.$au=Tr("twoWay");const co=new WeakMap,Ab=200;class Ru{constructor(){this._platform=E(On)}bind(e,t,s,i){const r={type:"debounce",delay:s??Ab,now:this._platform.performanceNow,queue:this._platform.taskQueue,signals:se(i)?[i]:i??X},o=t.limit?.(r);o==null?console.warn(`Binding ${t.constructor.name} does not support debounce rate limiting`):co.set(t,o)}unbind(e,t){co.get(t)?.dispose(),co.delete(t)}}Ru.$au={type:_t,name:"debounce"};const fr=me("ISignaler",n=>n.singleton($b));class $b{constructor(){this.signals=de()}dispatchSignal(e){const t=this.signals[e];if(t===void 0)return;let s;for(s of t.keys())s.handleChange(void 0,void 0)}addSignalListener(e,t){(this.signals[e]??=new Set).add(t)}removeSignalListener(e,t){this.signals[e]?.delete(t)}}class Ou{constructor(){this._lookup=new Map,this._signaler=E(fr)}bind(e,t,...s){if(!("handleChange"in t))throw B(817);if(s.length===0)throw B(818);this._lookup.set(t,s);let i;for(i of s)Au(this._signaler,i,t)}unbind(e,t){const s=this._lookup.get(t);this._lookup.delete(t);let i;for(i of s)$u(this._signaler,i,t)}}Ou.$au={type:_t,name:"signal"};const ho=new WeakMap,Ib=200;class Lu{constructor(){({performanceNow:this._now,taskQueue:this._taskQueue}=E(On))}bind(e,t,s,i){const r={type:"throttle",delay:s??Ib,now:this._now,queue:this._taskQueue,signals:se(i)?[i]:i??X},o=t.limit?.(r);o==null?console.warn(`Binding ${t.constructor.name} does not support debounce rate limiting`):ho.set(t,o)}unbind(e,t){ho.get(t)?.dispose(),ho.delete(t)}}Lu.$au={type:_t,name:"throttle"};const sc=me("IAppTask"),nt=On;class Tb{}const Rt=(()=>{const n=new WeakMap;let e=!1;return new class{get hideProp(){return e}set hideProp(t){e=t}get(t,s){return n.get(t)?.[s]??null}set(t,s,i){const r=n.get(t)??(n.set(t,new Tb),n.get(t));if(s in r)throw new Error(`Node already associated with a controller, remove the ref "${s}" first before associating with another controller`);return e||(t.$au??=r),r[s]=i}}})(),Mr=me("INode"),qo=(()=>{const n=new WeakMap;return cs({add(e,t){let s=n.get(e);s==null&&n.set(e,s=[]),s.push(t)},getDefinitions(e){return n.get(e)??X}})})();class sn{get type(){return Sb}constructor(e,t,s,i,r,o,a,c,l,h,u){this.Type=e,this.name=t,this.aliases=s,this.key=i,this.defaultBindingMode=r,this.isTemplateController=o,this.bindables=a,this.noMultiBindings=c,this.watches=l,this.dependencies=h,this.containerStrategy=u}static create(e,t){let s,i;se(e)?(s=e,i={name:s}):(s=e.name,i=e);const r=gs(Xt(t,"defaultBindingMode"),i.defaultBindingMode,t.defaultBindingMode,Ae);for(const o of Object.values(at.from(i.bindables)))at._add(o,t);return new sn(t,gs(Xt(t,"name"),s),Be(Xt(t,"aliases"),i.aliases,t.aliases),An(s),se(r)?Mi[r]??Ta:r,gs(Xt(t,"isTemplateController"),i.isTemplateController,t.isTemplateController,!1),at.from(...at.getAll(t),Xt(t,"bindables"),t.bindables,i.bindables),gs(Xt(t,"noMultiBindings"),i.noMultiBindings,t.noMultiBindings,!1),Be(qo.getDefinitions(t),t.watches),Be(Xt(t,"dependencies"),i.dependencies,t.dependencies),gs(Xt(t,"containerStrategy"),i.containerStrategy,t.containerStrategy,"reuse"))}register(e,t){const s=this.Type,i=typeof t=="string"?An(t):this.key,r=this.aliases;e.has(i,!1)?(sn.warnDuplicate&&e.get(Xs).warn(B(154,this.name)),console.warn(`[DEV:aurelia] ${B(154,this.name)}`)):e.register(e.has(s,!1)?null:qt(s,s),xs(s,i),...r.map(o=>xs(s,An(o))))}toString(){return`au:ca:${this.name}`}}sn.warnDuplicate=!0;const Ye="custom-attribute",Pn=rn(Ye),An=n=>`${Pn}:${n}`,Xt=(n,e)=>Qe(ls(e),n),Eb=n=>ce(n)&&(Ir(Pn,n)||n.$au?.type===Ye),Du=(n,e)=>Rt.get(n,An(e))??void 0,Ba=(n,e)=>{const t=sn.create(n,e),s=t.Type;return $t(t,s,Pn,Pt),s},Pa=n=>{const e=Qe(Pn,n)??Ss(n,Ye,sn.create);if(e===void 0)throw B(759,n);return e},Mb=(n,e)=>{let t="",s="";if(se(e))t=An(e),s=e;else{const r=Pa(e);t=r.key,s=r.name}let i=n;for(;i!==null;){const r=Rt.get(i,t);if(r?.is(s))return r;i=mr(i)}return null},Ra=cs({name:Pn,keyFrom:An,isType:Eb,for:Du,closest:Mb,define:Ba,getDefinition:Pa,annotate(n,e,t){$t(t,n,ls(e))},getAnnotation:Xt,find(n,e){const t=n.find(Ye,e);return t===null?null:Qe(Pn,t)??Ss(t,Ye,sn.create)??null}}),hn=me("ILifecycleHooks");class Bb{constructor(e,t){this.definition=e,this.instance=t}}class Oa{constructor(e,t){this.Type=e,this.propertyNames=t}static create(e,t){const s=new Set;let i=t.prototype;for(;i!==ku;){for(const r of xu(i))r!=="constructor"&&!r.startsWith("_")&&s.add(r);i=Object.getPrototypeOf(i)}return new Oa(t,s)}}const nc=(()=>{const n=new WeakMap,e=new WeakMap;return cs({define(t,s){const i=Oa.create(t,s),r=i.Type;return e.set(r,i),{register(o){qt(hn,r).register(o)}}},resolve(t){let s=n.get(t);if(s===void 0){n.set(t,s=new Pb);const i=t.root,r=i===t?t.getAll(hn):t.has(hn,!1)?i.getAll(hn).concat(t.getAll(hn)):i.getAll(hn);let o,a,c,l,h;for(o of r){a=e.get(o.constructor),c=new Bb(a,o);for(l of a.propertyNames)h=s[l],h===void 0?s[l]=[c]:h.push(c)}}return s}})})();class Pb{}class fi{constructor(e,t,s,i){this.Type=e,this.name=t,this.aliases=s,this.key=i}static create(e,t){let s,i;return se(e)?(s=e,i={name:s}):(s=e.name,i=e),new fi(t,gs(Ko(t,"name"),s),Be(Ko(t,"aliases"),i.aliases,t.aliases),Fu.keyFrom(s))}register(e,t){const s=this.Type,i=typeof t=="string"?pi(t):this.key,r=this.aliases;e.has(i,!1)?console.warn(`[DEV:aurelia] ${B(155,this.name)}`):e.register(e.has(s,!1)?null:qt(s,s),xs(s,i),...r.map(o=>xs(s,pi(o))))}}const _n="value-converter",gn=rn(_n),Ko=(n,e)=>Qe(ls(e),n),pi=n=>`${gn}:${n}`,Fu=cs({name:gn,keyFrom:pi,isType(n){return ce(n)&&(Ir(gn,n)||n.$au?.type===_n)},define(n,e){const t=fi.create(n,e),s=t.Type;return $t(t,s,gn,Pt),s},getDefinition(n){const e=Qe(gn,n)??Ss(n,_n,fi.create);if(e===void 0)throw B(152,n);return e},annotate(n,e,t){$t(t,n,ls(e))},getAnnotation:Ko,find(n,e){const t=n.find(_n,e);return t==null?null:Qe(gn,t)??Ss(t,_n,fi.create)??null},get(n,e){try{return n.get(Tn(pi(e)))}catch(t){throw console.error("[DEV:aurelia] Cannot retrieve value converter with name",e),t}return n.get(Tn(pi(e)))}});class Rb{constructor(e,t){this._value=void 0,this.b=e,this._flushQueue=t}flush(){this.b.isBound&&this.b.updateSource(this._value)}handleChange(e,t){const s=this.b;e!==ye(s.ast,s._scope,s,null)&&(this._value=e,this._flushQueue.add(this))}}const Os=(()=>{function n(e){this._scope=e}return e=>{ct(e.prototype,"useScope",n)}})(),hs=(()=>{class n{}const e=new WeakMap,t=new WeakMap,s=new WeakMap;function i(d){return this.l.get(d)}function r(d,p){let m=t.get(d);return m==null&&t.set(d,m=new n),m[p]??=Tu.get(d.l,p)}function o(d,p,m){const f=r(this,d);if(f==null)throw B(101,d);let g=s.get(this);if(g==null&&s.set(this,g={}),g[d])throw B(102,d);f.bind?.(p,this,...m)}function a(d,p){const m=r(this,d),f=s.get(this);m?.unbind?.(p,this),f!=null&&(f[d]=!1)}function c(d,p){let m=e.get(d);return m==null&&e.set(d,m=new n),m[p]??=Fu.get(d.l,p)}function l(d){const p=c(this,d);if(p==null)throw B(103,d);const m=p.signals;if(m!=null){const f=this.l.get(fr),g=m.length;let w=0;for(;w<g;++w)f.addSignalListener(m[w],this)}}function h(d){const p=c(this,d);if(p?.signals===void 0)return;const m=this.l.get(fr);let f=0;for(;f<p.signals.length;++f)m.removeSignalListener(p.signals[f],this)}function u(d,p,m,f){const g=c(this,d);if(g==null)throw B(103,d);const w=g.withContext===!0;let I=null;switch(w&&(I={source:this.l.get(As).controller.viewModel,binding:this}),p){case"toView":return"toView"in g?w?g.toView(m,I,...f):g.toView(m,...f):m;case"fromView":return"fromView"in g?w?g.fromView?.(m,I,...f):g.fromView?.(m,...f):m}}return d=>{const p=d.prototype;ct(p,"get",i),ct(p,"bindBehavior",o),ct(p,"unbindBehavior",a),ct(p,"bindConverter",l),ct(p,"unbindConverter",h),ct(p,"useConverter",u)}})(),Ob=me("IFlushQueue",n=>n.singleton(Lb));class Lb{constructor(){this._flushing=!1,this._items=new Set}get count(){return this._items.size}add(e){if(this._items.add(e),!this._flushing){this._flushing=!0;try{this._items.forEach(Db)}finally{this._flushing=!1}}}clear(){this._items.clear(),this._flushing=!1}}const Db=function(n,e,t){t.delete(n),n.flush()},Ls=(()=>{const n=new WeakSet,e=(s,i,r)=>{let o,a,c,l=!1;const h=()=>i(c),u=p=>{c=p,r.isBound?(a=o,o=ci(h,{delay:s.delay}),a?.cancel()):h()},d=u.dispose=()=>{a?.cancel(),o?.cancel(),a=o=void 0};return u.flush=()=>{l=o?.status===ec,d(),l&&h()},u},t=(s,i,r)=>{let o,a,c=0,l=0,h,u=!1;const d=()=>s.now(),p=()=>i(h),m=g=>{h=g,r.isBound?(l=d()-c,a=o,l>s.delay?(c=d(),p()):o=ci(()=>{c=d(),p()},{delay:s.delay-l}),a?.cancel()):p()},f=m.dispose=()=>{a?.cancel(),o?.cancel(),a=o=void 0};return m.flush=()=>{u=o?.status===ec,f(),u&&p()},m};return(s,i)=>{ct(s.prototype,"limit",function(r){if(n.has(this))throw B(9996);n.add(this);const o=i(this,r),a=r.signals,c=a.length>0?this.get(fr):null,l=this[o],h=(...p)=>l.call(this,...p),u=r.type==="debounce"?e(r,h,this):t(r,h,this),d=c?{handleChange:u.flush}:null;return this[o]=u,c&&a.forEach(p=>Au(c,p,d)),{dispose:()=>{c&&a.forEach(p=>$u(c,p,d)),n.delete(this),u.dispose(),delete this[o]}}})}})(),Ds=((n=new WeakSet)=>e=>function(){n.has(this)||(n.add(this),e.call(this))})();class vt{constructor(e,t,s,i,r,o,a,c,l){this.targetAttribute=o,this.targetProperty=a,this.mode=c,this.strict=l,this.isBound=!1,this._scope=void 0,this._isQueued=!1,this._value=void 0,this.boundFn=!1,this._isMulti=!1,this.l=t,this.ast=i,this._controller=e,this.target=r,this.oL=s,(this._isMulti=a.indexOf(" ")>-1)&&!vt._splitString.has(a)&&vt._splitString.set(a,a.split(" "))}updateTarget(e){const t=this.target,s=this.targetAttribute,i=this.targetProperty;switch(s){case"class":if(this._isMulti){const r=!!e;for(const o of vt._splitString.get(i))t.classList.toggle(o,r)}else t.classList.toggle(i,!!e);break;case"style":{let r="",o=tn(e);se(o)&&o.includes("!important")&&(r="important",o=o.replace("!important","")),t.style.setProperty(i,o,r);break}default:e==null?t.removeAttribute(s):t.setAttribute(s,tn(e))}}handleChange(){this.isBound&&(this._isQueued||(this._isQueued=!0,Nt(()=>{if(this._isQueued=!1,!this.isBound)return;this.obs.version++;const e=ye(this.ast,this._scope,this,(this.mode&Ae)>0?this:null);this.obs.clear(),e!==this._value&&(this._value=e,this.updateTarget(e))})))}handleCollectionChange(){this.handleChange()}bind(e){if(this.isBound){if(this._scope===e)return;this.unbind()}this._scope=e,Ms(this.ast,e,this),this.mode&(Ae|$r)&&this.updateTarget(this._value=ye(this.ast,e,this,(this.mode&Ae)>0?this:null)),this.isBound=!0}unbind(){this.isBound&&(this.isBound=!1,Bs(this.ast,this._scope,this),this._scope=void 0,this._value=void 0,this.obs.clearAll())}}vt.mix=Ds(()=>{Os(vt),Ls(vt,()=>"updateTarget"),yt(vt,null),hs(vt)});vt._splitString=new Map;class Fb{constructor(e,t,s,i,r,o,a,c){this.ast=i,this.target=r,this.targetProperty=o,this.mode=a,this.strict=c,this.isBound=!1,this._scope=void 0,this._isQueued=!1,this._controller=e,this.oL=s,this._targetObserver=s.getAccessor(r,o);const l=i.expressions,h=this.partBindings=Array(l.length),u=l.length;let d=0;for(;u>d;++d)h[d]=new Vs(l[d],r,o,t,s,c,this)}_handlePartChange(){if(!this.isBound)return;if(this._controller.state!==Mt&&(this._targetObserver.type&zt)>0){if(this._isQueued)return;this._isQueued=!0,Nt(()=>{this._isQueued=!1,this.isBound&&this.updateTarget()})}else this.updateTarget()}updateTarget(){const e=this.partBindings,t=this.ast,s=this.target,i=this.targetProperty,r=t.parts,o=e.length;let a="",c=0;if(o===1)a=r[0]+e[0]._evaluate()+r[1];else for(a=r[0];o>c;++c)a+=e[c]._evaluate()+r[c+1];this._targetObserver.setValue(a,s,i)}bind(e){if(this.isBound){if(this._scope===e)return;this.unbind()}this._scope=e;const t=this.partBindings,s=t.length;let i=0;for(;s>i;++i)t[i].bind(e);this.updateTarget(),this.isBound=!0}unbind(){if(!this.isBound)return;this.isBound=!1,this._scope=void 0;const e=this.partBindings,t=e.length;let s=0;for(;t>s;++s)e[s].unbind()}useAccessor(e){this._targetObserver=e}}class Vs{constructor(e,t,s,i,r,o,a){this.ast=e,this.target=t,this.targetProperty=s,this.strict=o,this.owner=a,this.mode=Ae,this.isBound=!1,this._value="",this.boundFn=!1,this._isDirty=!1,this.l=i,this.oL=r}updateTarget(){this.owner._handlePartChange()}handleChange(){this.isBound&&(this._isDirty=!0,this.updateTarget())}handleCollectionChange(){this.isBound&&(this._isDirty=!0,this.updateTarget())}_evaluate(){if(!this._isDirty)return this._value;this.obs.version++;const e=ye(this.ast,this._scope,this,(this.mode&Ae)>0?this:null);return this.obs.clear(),this._value=e,Ee(e)&&this.observeCollection(e),this._isDirty=!1,this._value}bind(e){if(this.isBound){if(this._scope===e)return;this.unbind()}this._scope=e,Ms(this.ast,e,this),this._value=ye(this.ast,this._scope,this,(this.mode&Ae)>0?this:null),Ee(this._value)&&this.observeCollection(this._value),this._isDirty=!1,this.isBound=!0}unbind(){this.isBound&&(this.isBound=!1,this._value=void 0,this._isDirty=!1,Bs(this.ast,this._scope,this),this._scope=void 0,this.obs.clearAll())}}Vs.mix=Ds(()=>{Os(Vs),Ls(Vs,()=>"updateTarget"),yt(Vs,null),hs(Vs)});class Hs{constructor(e,t,s,i,r,o,a){this.p=i,this.ast=r,this.target=o,this.strict=a,this.isBound=!1,this.mode=Ae,this._isQueued=!1,this._value="",this._needsRemoveNode=!1,this.boundFn=!1,this.l=t,this._controller=e,this.oL=s}updateTarget(e){const t=this.target,s=this._value;this._value=e,this._needsRemoveNode&&(s.parentNode?.removeChild(s),this._needsRemoveNode=!1),e instanceof this.p.Node&&(t.parentNode?.insertBefore(e,t),e="",this._needsRemoveNode=!0),t.textContent=tn(e??"")}handleChange(){this.isBound&&(this._isQueued||(this._isQueued=!0,Nt(()=>{if(this._isQueued=!1,!this.isBound)return;this.obs.version++;const e=ye(this.ast,this._scope,this,(this.mode&Ae)>0?this:null);this.obs.clear(),e!==this._value&&this.updateTarget(e)})))}handleCollectionChange(){this.isBound&&(this._isQueued||(this._isQueued=!0,Nt(()=>{if(this._isQueued=!1,!this.isBound)return;this.obs.version++;const e=this._value=ye(this.ast,this._scope,this,(this.mode&Ae)>0?this:null);this.obs.clear(),Ee(e)&&this.observeCollection(e),this.updateTarget(e)})))}bind(e){if(this.isBound){if(this._scope===e)return;this.unbind()}this._scope=e,Ms(this.ast,e,this);const t=this._value=ye(this.ast,this._scope,this,(this.mode&Ae)>0?this:null);Ee(t)&&this.observeCollection(t),this.updateTarget(t),this.isBound=!0}unbind(){this.isBound&&(this.isBound=!1,Bs(this.ast,this._scope,this),this._needsRemoveNode&&this._value.parentNode?.removeChild(this._value),this._scope=void 0,this.obs.clearAll())}}Hs.mix=Ds(()=>{Os(Hs),Ls(Hs,()=>"updateTarget"),yt(Hs,null),hs(Hs)});class Us{constructor(e,t,s,i,r,o){this.ast=s,this.targetProperty=i,this.isBound=!1,this._scope=void 0,this.target=null,this.boundFn=!1,this.l=e,this.oL=t,this.strict=o,this._toBindingContext=r}updateTarget(){this.target[this.targetProperty]=this._value}handleChange(){this.isBound&&(this.obs.version++,this._value=ye(this.ast,this._scope,this,this),this.obs.clear(),this.updateTarget())}handleCollectionChange(){this.handleChange()}bind(e){if(this.isBound){if(this._scope===e)return;this.unbind()}this._scope=e,this.target=this._toBindingContext?e.bindingContext:e.overrideContext,Ms(this.ast,e,this),this._value=ye(this.ast,this._scope,this,this),this.updateTarget(),this.isBound=!0}unbind(){this.isBound&&(this.isBound=!1,Bs(this.ast,this._scope,this),this._scope=void 0,this.obs.clearAll())}}Us.mix=Ds(()=>{Os(Us),Ls(Us,()=>"updateTarget"),yt(Us,null),hs(Us)});class Je{constructor(e,t,s,i,r,o,a,c){this.ast=i,this.target=r,this.targetProperty=o,this.mode=a,this.strict=c,this.isBound=!1,this._scope=void 0,this._targetObserver=void 0,this._isQueued=!1,this._targetSubscriber=null,this.boundFn=!1,this.l=t,this._controller=e,this.oL=s}updateTarget(e){this._targetObserver.setValue(e,this.target,this.targetProperty)}updateSource(e){xi(this.ast,this._scope,this,null,e)}handleChange(){if(!this.isBound)return;if(this._controller.state!==Mt&&(this._targetObserver.type&zt)>0){if(this._isQueued)return;this._isQueued=!0,Nt(()=>{this._isQueued=!1,this.isBound&&this._handleChange()})}else this._handleChange()}_handleChange(){this.obs.version++;const e=ye(this.ast,this._scope,this,(this.mode&Ae)>0?this:null);this.obs.clear(),this.updateTarget(e)}handleCollectionChange(){this.handleChange()}bind(e){if(this.isBound){if(this._scope===e)return;this.unbind()}this._scope=e,Ms(this.ast,e,this);const t=this.oL,s=this.mode;let i=this._targetObserver;i||(s&os?i=t.getObserver(this.target,this.targetProperty):i=t.getAccessor(this.target,this.targetProperty),this._targetObserver=i);const r=(s&Ae)>0;s&(Ae|$r)&&this.updateTarget(ye(this.ast,this._scope,this,r?this:null)),s&os&&(i.subscribe(this._targetSubscriber??=new Rb(this,this.l.get(Ob))),r||this.updateSource(i.getValue(this.target,this.targetProperty))),this.isBound=!0}unbind(){this.isBound&&(this.isBound=!1,this._targetSubscriber&&(this._targetObserver.unsubscribe(this._targetSubscriber),this._targetSubscriber=null),Bs(this.ast,this._scope,this),this._scope=void 0,this.obs.clearAll())}useTargetObserver(e){this._targetObserver?.unsubscribe(this),(this._targetObserver=e).subscribe(this)}useTargetSubscriber(e){if(this._targetSubscriber!=null)throw B(9995);this._targetSubscriber=e}}Je.mix=Ds(()=>{Os(Je),Ls(Je,n=>n.mode&os?"updateSource":"updateTarget"),yt(Je,null),hs(Je)});class Ws{constructor(e,t,s,i,r){this.oL=t,this.ast=s,this.target=i,this.strict=r,this.isBound=!1,this._scope=void 0,this.l=e}updateSource(){this.isBound?(this.obs.version++,xi(this.ast,this._scope,this,this,this.target),this.obs.clear()):xi(this.ast,this._scope,this,null,null)}handleChange(){this.isBound&&this.updateSource()}handleCollectionChange(){this.isBound&&this.updateSource()}bind(e){if(this.isBound){if(this._scope===e)return;this.unbind()}this._scope=e,Ms(this.ast,e,this),this.isBound=!0,this.updateSource()}unbind(){this.isBound&&(this.isBound=!1,this.obs.clearAll(),ye(this.ast,this._scope,this,null)===this.target&&this.updateSource(),Bs(this.ast,this._scope,this),this._scope=void 0)}}Ws.mix=Ds(()=>{yt(Ws,null),Ls(Ws,()=>"updateSource"),Os(Ws),hs(Ws)});class Nb{constructor(e,t=!1,s){this.prevent=e,this.capture=t,this.onError=s}}class wn{constructor(e,t,s,i,r,o,a){this.ast=t,this.target=s,this.targetEvent=i,this.strict=a,this.isBound=!1,this.self=!1,this.boundFn=!0,this._modifiedEventHandler=null,this.l=e,this._options=r,this._modifiedEventHandler=o}callSource(e){const t=this._scope.overrideContext;t.$event=e;let s=ye(this.ast,this._scope,this,null);delete t.$event,ce(s)&&(s=s(e)),s!==!0&&this._options.prevent&&e.preventDefault()}handleEvent(e){if(!(this.self&&this.target!==e.composedPath()[0])&&this._modifiedEventHandler?.(e)!==!1)try{this.callSource(e)}catch(t){this._options.onError(e,t)}}bind(e){if(this.isBound){if(this._scope===e)return;this.unbind()}this._scope=e,Ms(this.ast,e,this),this.target.addEventListener(this.targetEvent,this,this._options),this.isBound=!0}unbind(){this.isBound&&(this.isBound=!1,Bs(this.ast,this._scope,this),this._scope=void 0,this.target.removeEventListener(this.targetEvent,this,this._options))}}wn.mix=Ds(function(){Os(wn),Ls(wn,()=>"callSource"),hs(wn)});const Br=me("IEventModifier"),Nu=me("IKeyMapping",n=>n.instance({meta:cs(["ctrl","alt","shift","meta"]),keys:{escape:"Escape",enter:"Enter",space:"Space",tab:"tab",...Array.from({length:25}).reduce((e,t,s)=>{let i=String.fromCharCode(s+65);return e[s+65]=i,i=String.fromCharCode(s+97),e[s+97]=e[i]=i,e},{})}}));class La{constructor(){this.type=["click","mousedown","mousemove","mouseup","dblclick","contextmenu"],this._mapping=E(Nu),this._mouseButtons=["left","middle","right"]}static register(e){e.register(qt(Br,La))}getHandler(e){const t=e.split(/[:+.]/);return(s=>{let i=!1,r=!1,o;for(o of t){switch(o){case"prevent":i=!0;continue;case"stop":r=!0;continue;case"left":case"middle":case"right":if(s.button!==this._mouseButtons.indexOf(o))return!1;continue}if(this._mapping.meta.includes(o)&&s[`${o}Key`]!==!0)return!1;console.warn(`Modifier '${o}' is not supported for mouse events.`)}return i&&s.preventDefault(),r&&s.stopPropagation(),!0})}}class Da{constructor(){this._mapping=E(Nu),this.type=["keydown","keyup"]}static register(e){e.register(qt(Br,Da))}getHandler(e){const t=e.split(/[:+.]/);return(s=>{let i=!1,r=!1,o;for(o of t){switch(o){case"prevent":i=!0;continue;case"stop":r=!0;continue}if(this._mapping.meta.includes(o)){if(s[`${o}Key`]!==!0)return!1;continue}if(this._mapping.keys[o]!==s.key)return!1;console.warn(`Modifier '${o}' is not supported for keyboard event with key "${s.key}".`)}return i&&s.preventDefault(),r&&s.stopPropagation(),!0})}}class Fa{constructor(){this.type=["$ALL"]}static register(e){e.register(qt(Br,Fa))}getHandler(e){const t=e.split(/[:+.]/);return(s=>{let i=!1,r=!1,o;for(o of t){switch(o){case"prevent":i=!0;continue;case"stop":r=!0;continue}console.warn(`Modifier '${o}' is not supported for event "${s.type}".`)}return i&&s.preventDefault(),r&&s.stopPropagation(),!0})}}const ju=me("IEventModifierHandler",n=>n.instance({getHandler:()=>(console.warn("No event modifier handler registered"),null)}));class Na{constructor(){this._reg=E(ia(Br)).reduce((e,t)=>((Ee(t.type)?t.type:[t.type]).forEach(i=>e[i]=t),e),{})}static register(e){e.register(qt(ju,Na))}getHandler(e,t){return se(t)?(this._reg[e]??this._reg.$ALL)?.getHandler(t)??null:null}}const jb={register(n){n.register(Na,La,Da,Fa)}},dt=me("IViewFactory");class Pr{constructor(e,t){this.isCaching=!1,this._cache=null,this._cacheSize=-1,this.name=t.name,this.container=e,this.def=t}setCacheSize(e,t){e&&(e==="*"?e=Pr.maxCacheSize:se(e)&&(e=parseInt(e,10)),(this._cacheSize===-1||!t)&&(this._cacheSize=e)),this._cacheSize>0?this._cache=[]:this._cache=null,this.isCaching=this._cacheSize>0}canReturnToCache(e){return this._cache!=null&&this._cache.length<this._cacheSize}tryReturnToCache(e){return this.canReturnToCache(e)?(this._cache.push(e),!0):!1}create(e){const t=this._cache;let s;return t!=null&&t.length>0?(s=t.pop(),s):(s=ht.$view(this,e),s)}}Pr.maxCacheSize=65535;const Vb=(()=>{const n=(e,t)=>e.document.createComment(t);return e=>{const t=n(e,"au-end");return t.$start=n(e,"au-start"),t}})(),Vi=(n,e,t)=>{if(n===null)return;const s=t.length;let i=0;for(;s>i;)n.insertBefore(t[i],e),++i},Vu=(n,e)=>new n.ownerDocument.defaultView.MutationObserver(e),Hb=n=>n.nodeType===1,Hu="default",Ub="au-slot",Uu=me("IAuSlotsInfo");class Wu{constructor(e){this.projectedSlots=e}}const Wb=me("IAuSlotWatcher");class Rr{static create(e,t,s,i,r,o,a,c){const l=[],h=i.renderers,u=p=>{let m=p,f=e;for(;f!=null&&m>0;)f=f.parent,--m;if(f==null)throw B(9999);return f},d=p=>{const m=u(p),f=new Rr(m),g=r.compileSpread(m.controller.definition,m.instruction?.captures??X,m.controller.container,t,s);let w;for(w of g)switch(w.type){case Le.spreadTransferedBinding:d(p+1);break;case Le.spreadElementProp:h[w.instruction.type].render(f,$n(t),w.instruction,o,a,c);break;default:h[w.type].render(f,t,w,o,a,c)}l.push(f)};return d(0),l}get container(){return this.locator}get definition(){return this.$controller.definition}get state(){return this.$controller.state}constructor(e){this.isBound=!1,this._innerBindings=[],this.locator=(this.$controller=(this._hydrationContext=e).controller).container}get(e){return this.locator.get(e)}bind(e){if(this.isBound)return;this.isBound=!0;const t=this.scope=this._hydrationContext.controller.scope.parent??void 0;if(t==null)throw B(9999);this._innerBindings.forEach(s=>s.bind(t))}unbind(){this._innerBindings.forEach(e=>e.unbind()),this.isBound=!1}addBinding(e){this._innerBindings.push(e)}addChild(e){if(e.vmKind!==js)throw B(9998);this.$controller.addChild(e)}}class Bt{constructor(e,t,s,i,r,o,a){this.target=t,this.targetKeys=s,this.ast=i,this.strict=a,this.isBound=!1,this._scope=void 0,this.boundFn=!1,this._bindingCache={},this._scopeCache=new WeakMap,this._controller=e,this.oL=r,this.l=o}updateTarget(){this.obs.version++;const e=ye(this.ast,this._scope,this,this);this.obs.clear(),this._createBindings(e,!0)}handleChange(){this.isBound&&this.updateTarget()}handleCollectionChange(){this.isBound&&this.updateTarget()}bind(e){if(this.isBound){if(this._scope===e)return;this.unbind()}this.isBound=!0,this._scope=e,Ms(this.ast,e,this);const t=ye(this.ast,e,this,this);this._createBindings(t,!1)}unbind(){if(!this.isBound)return;this.isBound=!1,Bs(this.ast,this._scope,this),this._scope=void 0;let e;for(e in this._bindingCache)this._bindingCache[e].unbind()}_createBindings(e,t){let s;if(!jc(e)){console.warn(`[DEV:aurelia] $bindable spread is given a non object for properties: "${this.targetKeys.join(", ")}" of ${this.target.constructor.name}`);for(s in this._bindingCache)this._bindingCache[s]?.unbind();return}let i,r=this._scopeCache.get(e);r==null&&this._scopeCache.set(e,r=Oe.fromParent(this._scope,e));for(s of this.targetKeys)i=this._bindingCache[s],s in e?(i==null&&(i=this._bindingCache[s]=new Je(this._controller,this.l,this.oL,Bt._astCache[s]??=new oi(s,0),this.target,s,Mi.toView,this.strict)),i.bind(r)):t&&i?.unbind()}}Bt.mix=Ds(()=>{Os(Bt),Ls(Bt,()=>"updateTarget"),yt(Bt,null),hs(Bt)});Bt._astCache={};const ic=(n,e,t,s)=>{n.addEventListener(e,t,s)},rc=(n,e,t,s)=>{n.removeEventListener(e,t,s)},ja=n=>{let e;const t=n.prototype;ct(t,"subscribe",function(s){if(this.subs.add(s)&&this.subs.count===1){for(e of this._config.events)ic(this._el,e,this);this._listened=!0,this._start?.()}}),ct(t,"unsubscribe",function(s){if(this.subs.remove(s)&&this.subs.count===0){for(e of this._config.events)rc(this._el,e,this);this._listened=!1,this._stop?.()}}),ct(t,"useConfig",function(s){if(this._config=s,this._listened){for(e of this._config.events)rc(this._el,e,this);for(e of this._config.events)ic(this._el,e,this)}})},Or=n=>{ct(n.prototype,"subscribe",wt),ct(n.prototype,"unsubscribe",wt)};class Lr{get doNotCache(){return!0}constructor(e,t={}){this.obj=e,this.mapping=t,this.type=Rs|zt,this._value="",this._nameIndex={},this._version=0}getValue(){return this._value}setValue(e){e!==this._value&&(this._value=e,this._flushChanges())}_flushChanges(){const e=this._nameIndex,t=++this._version,s=this.obj.classList,i=zu(this._value),r=i.length;let o=0,a;if(r>0)for(;o<r;o++)a=i[o],a=this.mapping[a]||a,a.length!==0&&(e[a]=this._version,s.add(a));if(t!==1)for(a in e)a=this.mapping[a]||a,e[a]!==t&&s.remove(a)}}Or(Lr);function zu(n){if(se(n))return oc(n);if(typeof n!="object")return X;if(Ee(n)){const s=n.length;if(s>0){const i=[];let r=0;for(;s>r;++r)i.push(...zu(n[r]));return i}else return X}const e=[];let t;for(t in n)n[t]&&(t.includes(" ")?e.push(...oc(t)):e.push(t));return e}function oc(n){const e=n.match(/\S+/g);return e===null?X:e}const qu=n=>({$isResolver:!0,resolve(e,t){return t.get(As).controller.container.get(Wf(n))}}),Ku=me("IRenderer");function He(n,e){const t=n[Symbol.metadata]??=Object.create(null);return t[Ht]={register(s){qt(Ku,n).register(s)}},n}function Vt(n,e,t){return se(e)?n.parse(e,t):e}function Dr(n){return n.viewModel!=null?n.viewModel:n}function zb(n,e){if(e==="element")return n;switch(e){case"controller":return $n(n);case"view":throw B(750);case"component":return $n(n).viewModel;default:{const t=Du(n,e);if(t!==void 0)return t.viewModel;const s=$n(n,{name:e});if(s===void 0)throw B(751,e);return s.viewModel}}}const qb=He(class{constructor(){this.target=Le.setProperty}render(e,t,s){const i=Dr(t);i.$observers?.[s.to]!==void 0?i.$observers[s.to].setValue(s.value):i[s.to]=s.value}}),Kb=He(class{constructor(){this._rendering=E(on),this.target=Le.hydrateElement}render(e,t,s,i,r,o){let a,c,l;const h=s.res,u=s.projections,d=e.container;switch(typeof h){case"string":if(a=vs.find(d,h),a==null)throw B(752,s,e);break;default:a=h}const m=s.containerless||a.containerless?Si(t):null,f=gv(i,e,t,s,m,u==null?void 0:new Wu(Ea(u)));c=f.invoke(a.Type),l=ht.$el(f,c,t,s,a,m);const g=this._rendering.renderers,w=s.props,I=w.length;let M=0,A;for(;I>M;)A=w[M],g[A.type].render(e,l,A,i,r,o),++M;e.addChild(l)}}),Qb=He(class{constructor(){this._rendering=E(on),this.target=Le.hydrateAttribute}render(e,t,s,i,r,o){let a=e.container,c;switch(typeof s.res){case"string":if(c=Ra.find(a,s.res),c==null)throw B(753,s,e);break;default:c=s.res}const l=Ju(i,c,e,t,s,void 0,void 0),h=ht.$attr(l.ctn,l.vm,t,c);Rt.set(t,c.key,h);const u=this._rendering.renderers,d=s.props,p=d.length;let m=0,f;for(;p>m;)f=d[m],u[f.type].render(e,h,f,i,r,o),++m;e.addChild(h)}}),Yb=He(class{constructor(){this._rendering=E(on),this.target=Le.hydrateTemplateController}render(e,t,s,i,r,o){let a=e.container,c;switch(typeof s.res){case"string":if(c=Ra.find(a,s.res),c==null)throw B(754,s,e);break;default:c=s.res}const l=this._rendering.getViewFactory(s.def,c.containerStrategy==="new"?a.createChild({inheritParentResources:!0}):a),h=Si(t),u=Ju(i,c,e,t,s,l,h),d=ht.$attr(u.ctn,u.vm,t,c);Rt.set(h,c.key,d),u.vm.link?.(e,d,t,s);const p=this._rendering.renderers,m=s.props,f=m.length;let g=0,w;for(;f>g;)w=m[g],p[w.type].render(e,d,w,i,r,o),++g;e.addChild(d)}}),Xb=He(class{constructor(){this.target=Le.hydrateLetElement,Us.mix()}render(e,t,s,i,r,o){t.remove();const a=s.instructions,c=s.toBindingContext,l=e.container,h=a.length;let u,d,p=0;for(;h>p;)u=a[p],d=Vt(r,u.from,jt),e.addBinding(new Us(l,o,d,u.to,c,e.strict??!1)),++p}}),Gb=He(class{constructor(){this.target=Le.refBinding,Ws.mix()}render(e,t,s,i,r,o){e.addBinding(new Ws(e.container,o,Vt(r,s.from,jt),zb(t,s.to),e.strict??!1))}}),Jb=He(class{constructor(){this.target=Le.interpolation,Vs.mix()}render(e,t,s,i,r,o){const a=e.container,c=new Fb(e,a,o,Vt(r,s.from,mb),Dr(t),s.to,Ae,e.strict??!1);if(s.to==="class"&&c.target.nodeType>0){const l=a.get(qu(pr));c.useAccessor(new Lr(c.target,l))}e.addBinding(c)}}),Zb=He(class{constructor(){this.target=Le.propertyBinding,Je.mix()}render(e,t,s,i,r,o){const a=e.container,c=new Je(e,a,o,Vt(r,s.from,jt),Dr(t),s.to,s.mode,e.strict??!1);if(s.to==="class"&&c.target.nodeType>0){const l=a.get(qu(pr));c.useTargetObserver(new Lr(c.target,l))}e.addBinding(c)}}),ev=He(class{constructor(){this.target=Le.iteratorBinding,Je.mix()}render(e,t,s,i,r,o){e.addBinding(new Je(e,e.container,o,Vt(r,s.forOf,bb),Dr(t),s.to,Ae,e.strict??!1))}}),tv=He(class{constructor(){this.target=Le.textBinding,Hs.mix()}render(e,t,s,i,r,o){e.addBinding(new Hs(e,e.container,o,i,Vt(r,s.from,jt),t,e.strict??!1))}}),sv=me("IListenerBindingOptions",n=>n.singleton(class{constructor(){this.p=E(nt),this.prevent=!1,this.onError=(e,t)=>{const s=new this.p.CustomEvent("au-event-error",{cancelable:!0,detail:{event:e,error:t}});if(this.p.window.dispatchEvent(s),!s.defaultPrevented)throw t}}})),nv=He(class{constructor(){this.target=Le.listenerBinding,this._modifierHandler=E(ju),this._defaultOptions=E(sv),wn.mix()}render(e,t,s,i,r){e.addBinding(new wn(e.container,Vt(r,s.from,vb),t,s.to,new Nb(this._defaultOptions.prevent,s.capture,this._defaultOptions.onError),this._modifierHandler.getHandler(s.to,s.modifier),e.strict??!1))}}),iv=He(class{constructor(){this.target=Le.setAttribute}render(e,t,s){t.setAttribute(s.to,s.value)}}),rv=He(class{constructor(){this.target=Le.setClassAttribute}render(e,t,s){fv(t.classList,s.value)}}),ov=He(class{constructor(){this.target=Le.setStyleAttribute}render(e,t,s){t.style.cssText+=s.value}}),av=["height","width","border-width","padding","padding-left","padding-right","padding-top","padding-right","padding-inline","padding-block","margin","margin-left","margin-right","margin-top","margin-bottom","margin-inline","margin-block","top","right","bottom","left"],lv=He(class{constructor(){this.target=Le.stylePropertyBinding,Je.mix()}render(e,t,s,i,r,o){if(av.includes(s.to)){e.addBinding(new cv(e,e.container,o,Vt(r,s.from,jt),t.style,s.to,Ae,e.strict??!1));return}e.addBinding(new Je(e,e.container,o,Vt(r,s.from,jt),t.style,s.to,Ae,e.strict??!1))}});class cv extends Je{updateTarget(e){return typeof e=="number"&&e>0&&console.warn(`[DEV]: Setting number ${e} as value for style.${this.targetProperty}. Did you meant "${e}px"?`),super.updateTarget(e)}}const hv=He(class{constructor(){this.target=Le.attributeBinding,vt.mix()}render(e,t,s,i,r,o){const a=e.container,c=a.has(pr,!1)?a.get(pr):null;e.addBinding(new vt(e,a,o,Vt(r,s.from,jt),t,s.attr,c==null?s.to:s.to.split(/\s/g).map(l=>c[l]??l).join(" "),Ae,e.strict??!1))}}),uv=He(class{constructor(){this._compiler=E(kr),this._rendering=E(on),this.target=Le.spreadTransferedBinding}render(e,t,s,i,r,o){Rr.create(e.container.get(As),t,void 0,this._rendering,this._compiler,i,r,o).forEach(a=>e.addBinding(a))}}),dv=He(class{constructor(){this.target=Le.spreadValueBinding,Bt.mix()}render(e,t,s,i,r,o){const a=s.target;if(a==="$bindables")e.addBinding(new Bt(e,t.viewModel,Ea(t.definition.bindables),r.parse(s.from,jt),o,e.container,e.strict??!1));else throw B(820,a)}});function fv(n,e){const t=e.length;let s=0;for(let i=0;i<t;++i)e.charCodeAt(i)===32?(i!==s&&n.add(e.slice(s,i)),s=i+1):i+1===t&&n.add(e.slice(s))}const Qu="IController",Yu="IInstruction",pv="IRenderLocation",Xu="ISlotsInfo";function gv(n,e,t,s,i,r){const o=e.container.createChild();return Nr(o,t,n),we(o,Fr,new Re(Qu,e)),we(o,Fn,new Re(Yu,s)),we(o,et,i==null?ed:new Zu(i)),we(o,dt,td),we(o,Uu,r==null?sd:new Re(Xu,r)),o}class Gu{get $isResolver(){return!0}constructor(e){this.f=e}resolve(){const e=this.f;if(e===null)throw B(755);if(!se(e.name)||e.name.length===0)throw B(756);return e}}function Ju(n,e,t,s,i,r,o,a){const c=t instanceof ht?t:t.$controller,l=c.container.createChild();return Nr(l,s,n),we(l,Fr,new Re(Qu,c)),we(l,Fn,new Re(Yu,i)),we(l,et,o==null?ed:new Re(pv,o)),we(l,dt,r==null?td:new Gu(r)),we(l,Uu,sd),{vm:l.invoke(e.Type),ctn:l}}class Zu{get name(){return"IRenderLocation"}get $isResolver(){return!0}constructor(e){this._location=e}resolve(){return this._location}}const ed=new Zu(null),td=new Gu(null),sd=new Re(Xu,new Wu(X)),on=me("IRendering",n=>n.singleton(mv));class mv{get renderers(){return this._renderers??=this._ctn.getAll(Ku,!1).reduce((e,t)=>(e[t.target]!==void 0&&console.warn(`[DEV:aurelia] Renderer for target ${t.target} already exists.`),e[t.target]??=t,e),de())}constructor(){this._compilationCache=new WeakMap,this._fragmentCache=new WeakMap;const e=this._ctn=E(Ti).root,t=this._platform=e.get(nt);this._exprParser=e.get(Ln),this._observerLocator=e.get(jn),this._marker=t.document.createElement("au-m"),this._empty=new go(t,t.document.createDocumentFragment())}compile(e,t){const s=t.get(kr),i=this._compilationCache;let r=i.get(e);return r==null&&i.set(e,r=st.create(e.needsCompile?s.compile(e,t):e)),r}getViewFactory(e,t){return new Pr(t,st.getOrCreate(e))}createNodes(e){if(e.enhance===!0)return new go(this._platform,this._transformMarker(e.template));let t,s=!1;const i=this._fragmentCache,r=this._platform,o=r.document;if(i.has(e))t=i.get(e);else{const a=e.template;let c;a==null?t=null:a instanceof r.Node?a.nodeName==="TEMPLATE"?(t=a.content,s=!0):(t=o.createDocumentFragment()).appendChild(a.cloneNode(!0)):(c=o.createElement("template"),se(a)&&(c.innerHTML=a),t=c.content,s=!0),this._transformMarker(t),i.set(e,t)}return t==null?this._empty:new go(this._platform,s?o.importNode(t,!0):o.adoptNode(t.cloneNode(!0)))}render(e,t,s,i){const r=s.instructions,o=this.renderers,a=t.length;let c=0,l=0,h=r.length,u,d,p;if(a!==h)throw B(757,a,h);if(i!=null&&(u=s.surrogates,(h=u.length)>0))for(l=0;h>l;)d=u[l],o[d.type].render(e,i,d,this._platform,this._exprParser,this._observerLocator),++l;if(a>0)for(;a>c;){for(u=r[c],p=t[c],l=0,h=u.length;h>l;)d=u[l],o[d.type].render(e,p,d,this._platform,this._exprParser,this._observerLocator),++l;++c}}_transformMarker(e){if(e==null)return null;const t=this._platform.document.createTreeWalker(e,128);let s;for(;(s=t.nextNode())!=null;)s.nodeValue==="au*"&&s.parentNode.replaceChild(t.currentNode=this._marker.cloneNode(),s);return e}}const ac=me("IShadowDOMStyles"),bv=me("IShadowDOMGlobalStyles",n=>n.instance({applyTo:wt})),{enter:vv,exit:_v}=mm,{wrap:wv,unwrap:yv}=Zm;class nd{get value(){return this._value}constructor(e,t,s,i,r="async"){this.obj=e,this.$get=s,this.isBound=!1,this._isQueued=!1,this._computeDepth=0,this._value=void 0,this._callback=i,this.oL=t,this._flush=r}handleChange(){this.run()}handleCollectionChange(){this.run()}bind(){this.isBound||(this.compute(),this.isBound=!0)}unbind(){this.isBound&&(this.isBound=!1,this.obs.clearAll())}run(){if(this.isBound){if(this._flush==="sync"){this._run();return}this._isQueued||(this._isQueued=!0,Nt(()=>{this._isQueued=!1,this._run()}))}}_run(){if(!this.isBound)return;const e=this.obj,t=this._value;if(++this._computeDepth>100)throw new Error("AURXXXX: Possible infinitely recursive side-effect detected in a watcher.");const s=this.compute();is(s,t)||this._callback.call(e,s,t,e),this._isQueued||(this._computeDepth=0)}compute(){this.obs.version++;try{return vv(this),this._value=yv(this.$get.call(void 0,wv(this.obj),this))}finally{this.obs.clear(),_v(this)}}}yt(nd,null);class Qo{get value(){return this._value}constructor(e,t,s,i,r,o="async"){this.scope=e,this.l=t,this.oL=s,this.isBound=!1,this._isQueued=!1,this.boundFn=!1,this.obj=e.bindingContext,this._expression=i,this._callback=r,this._flush=o}handleChange(){this.run()}handleCollectionChange(){this.run()}run(){if(this.isBound){if(this._flush==="sync"){this._run();return}this._isQueued||(this._isQueued=!0,Nt(()=>{this._isQueued=!1,this._run()}))}}_run(){if(!this.isBound)return;const e=this._expression,t=this.obj,s=this._value;this.obs.version++;const i=ye(e,this.scope,this,this);this.obs.clear(),is(i,s)||(this._value=i,this._callback.call(t,i,s,t))}bind(){this.isBound||(this.obs.version++,this._value=ye(this._expression,this.scope,this,this),this.obs.clear(),this.isBound=!0)}unbind(){this.isBound&&(this.isBound=!1,this.obs.clearAll(),this._value=void 0)}}yt(Qo,null),hs(Qo);class ht{get lifecycleHooks(){return this._lifecycleHooks}get isActive(){return(this.state&(Mt|zs))>0&&(this.state&gi)===0}get name(){if(this.parent===null)switch(this.vmKind){case js:return`[${this.definition.name}]`;case mt:return this.definition.name;case qe:return this.viewFactory.name}switch(this.vmKind){case js:return`${this.parent.name}>[${this.definition.name}]`;case mt:return`${this.parent.name}>${this.definition.name}`;case qe:return this.viewFactory.name===this.parent.definition?.name?`${this.parent.name}[view]`:`${this.parent.name}[view:${this.viewFactory.name}]`}}get viewModel(){return this._vm}set viewModel(e){this._vm=e,this._vmHooks=e==null||this.vmKind===qe?yn.none:new yn(e)}get strict(){return this.definition?.strict}constructor(e,t,s,i,r,o,a){this.container=e,this.vmKind=t,this.definition=s,this.viewFactory=i,this.host=o,this.head=null,this.tail=null,this.next=null,this.parent=null,this.bindings=null,this.children=null,this.hasLockedScope=!1,this.scope=null,this.isBound=!1,this._isBindingDone=!1,this.mountTarget=id,this.shadowRoot=null,this.nodes=null,this.location=null,this._lifecycleHooks=null,this.state=uo,this._fullyNamed=!1,this.$initiator=null,this.$resolve=void 0,this.$reject=void 0,this.$promise=void 0,this._activatingStack=0,this._detachingStack=0,this._unbindingStack=0,this._vm=r,this._vmHooks=t===qe?yn.none:new yn(r),this.logger=null,this.debug=!1,this.location=a,this._rendering=e.root.get(on)}static getCached(e){return fs.get(e)}static getCachedOrThrow(e){const t=ht.getCached(e);if(t===void 0)throw B(500,e);return t}static $el(e,t,s,i,r=void 0,o=null){if(fs.has(t))return fs.get(t);if(r==null)try{r=ld(t.constructor)}catch(l){throw console.error(`[DEV:aurelia] Custom element definition not found for creating a controller with host: <${s.nodeName} /> and component ${t.constructor.name||"(Anonymous) class"}`),l}we(e,r.Type,new Re(r.key,t,r.Type));const a=new ht(e,mt,r,null,t,s,o),c=e.get(Xc(As));return r.dependencies.length>0&&e.register(...r.dependencies),we(e,As,new Re("IHydrationContext",new rd(a,i,c))),fs.set(t,a),(i==null||i.hydrate!==!1)&&a._hydrateCustomElement(i),a}static $attr(e,t,s,i){if(fs.has(t))return fs.get(t);i=i??Pa(t.constructor),we(e,i.Type,new Re(i.key,t,i.Type));const r=new ht(e,js,i,null,t,s,null);return i.dependencies.length>0&&e.register(...i.dependencies),fs.set(t,r),r._hydrateCustomAttribute(),r}static $view(e,t=void 0){const s=new ht(e.container,qe,null,e,null,null,null);return s.parent=t??null,s._hydrateSynthetic(),s}_hydrateCustomElement(e){this.logger=this.container.get(Xs).root,this.debug=this.logger.config.level<=Yf.debug,this.debug&&(this.logger=this.logger.scopeTo(this.name));const t=this.container,s=this._vm,i=this.definition;this.scope=Oe.create(s,null,!0),i.watches.length>0&&hc(this,t,i,s),lc(this,i,s),this._lifecycleHooks=nc.resolve(t),t.register(i.Type),i.injectable!==null&&we(t,i.injectable,new Re("definition.injectable",s)),(e==null||e.hydrate!==!1)&&(this._hydrate(),this._hydrateChildren())}_hydrate(){this._lifecycleHooks.hydrating!=null&&this._lifecycleHooks.hydrating.forEach(Iv,this),this._vmHooks._hydrating&&(this.debug&&this.logger.trace("invoking hydrating() hook"),this._vm.hydrating(this));const e=this.definition,t=this._compiledDef=this._rendering.compile(e,this.container),s=t.shadowOptions,i=t.hasSlots,r=t.containerless,o=this.host;let a=this.location;if(r&&a==null&&(a=this.location=Si(o)),ft(o,ze,this),ft(o,e.key,this),s!==null||i){if(a!=null)throw B(501);ft(this.shadowRoot=o.attachShadow(s??Sv),ze,this),ft(this.shadowRoot,e.key,this),this.mountTarget=Xn}else a!=null?(o!==a&&(ft(a,ze,this),ft(a,e.key,this)),this.mountTarget=Gn):this.mountTarget=Yn;this._vm.$controller=this,this.nodes=this._rendering.createNodes(t),this._lifecycleHooks.hydrated!==void 0&&this._lifecycleHooks.hydrated.forEach(Tv,this),this._vmHooks._hydrated&&(this.debug&&this.logger.trace("invoking hydrated() hook"),this._vm.hydrated(this))}_hydrateChildren(){this._rendering.render(this,this.nodes.findTargets(),this._compiledDef,this.host),this._lifecycleHooks.created!==void 0&&this._lifecycleHooks.created.forEach(uc,this),this._vmHooks._created&&(this.debug&&this.logger.trace("invoking created() hook"),this._vm.created(this))}_hydrateCustomAttribute(){const e=this.definition,t=this._vm;e.watches.length>0&&hc(this,this.container,e,t),lc(this,e,t),t.$controller=this,this._lifecycleHooks=nc.resolve(this.container),this._lifecycleHooks.created!==void 0&&this._lifecycleHooks.created.forEach(uc,this),this._vmHooks._created&&(this.debug&&this.logger.trace("invoking created() hook"),this._vm.created(this))}_hydrateSynthetic(){this._compiledDef=this._rendering.compile(this.viewFactory.def,this.container),this._rendering.render(this,(this.nodes=this._rendering.createNodes(this._compiledDef)).findTargets(),this._compiledDef,void 0)}activate(e,t,s){switch(this.state){case uo:case kn:if(!(t===null||t.isActive))return;this.state=Mt;break;case zs:return;case ps:throw B(502,this.name);default:throw B(503,this.name,Av(this.state))}switch(this.parent=t,this.debug&&!this._fullyNamed&&(this._fullyNamed=!0,(this.logger??=this.container.get(Xs).root.scopeTo(this.name)).trace("activate()")),this.vmKind){case mt:this.scope.parent=s??null;break;case js:this.scope=s??null;break;case qe:if(s==null)throw B(504,this.name);this.hasLockedScope||(this.scope=s);break}this.$initiator=e,this._enterActivating();let i;return this.vmKind!==qe&&this._lifecycleHooks.binding!=null&&(this.debug&&this.logger.trace("lifecycleHooks.binding()"),i=De(...this._lifecycleHooks.binding.map(Ev,this))),this._vmHooks._binding&&(this.debug&&this.logger.trace("binding()"),i=De(i,this._vm.binding(this.$initiator,this.parent))),Pe(i)?(this._ensurePromise(),i.then(()=>{this._isBindingDone=!0,this.state!==Mt?this._leaveActivating():this.bind()}).catch(r=>{this._reject(r)}),this.$promise):(this._isBindingDone=!0,this.bind(),this.$promise)}bind(){this.debug&&this.logger.trace("bind()");let e=0,t=0,s;if(this.bindings!==null)for(e=0,t=this.bindings.length;t>e;)this.bindings[e].bind(this.scope),++e;if(this.vmKind!==qe&&this._lifecycleHooks.bound!=null&&(this.debug&&this.logger.trace("lifecycleHooks.bound()"),s=De(...this._lifecycleHooks.bound.map(Mv,this))),this._vmHooks._bound&&(this.debug&&this.logger.trace("bound()"),s=De(s,this._vm.bound(this.$initiator,this.parent))),Pe(s)){this._ensurePromise(),s.then(()=>{this.isBound=!0,this.state!==Mt?this._leaveActivating():this._attach()}).catch(i=>{this._reject(i)});return}this.isBound=!0,this._attach()}_append(...e){switch(this.mountTarget){case Yn:this.host.append(...e);break;case Xn:this.shadowRoot.append(...e);break;case Gn:{let t=0;for(;t<e.length;++t)this.location.parentNode.insertBefore(e[t],this.location);break}}}_attach(){switch(this.debug&&this.logger.trace("attach()"),this.mountTarget){case Yn:this.nodes.appendTo(this.host,this.definition!=null&&this.definition.enhance);break;case Xn:{const s=this.container;(s.has(ac,!1)?s.get(ac):s.get(bv)).applyTo(this.shadowRoot),this.nodes.appendTo(this.shadowRoot);break}case Gn:this.nodes.insertBefore(this.location);break}let e=0,t;if(this.vmKind!==qe&&this._lifecycleHooks.attaching!=null&&(this.debug&&this.logger.trace("lifecycleHooks.attaching()"),t=De(...this._lifecycleHooks.attaching.map(Bv,this))),this._vmHooks._attaching&&(this.debug&&this.logger.trace("attaching()"),t=De(t,this._vm.attaching(this.$initiator,this.parent))),Pe(t)&&(this._ensurePromise(),this._enterActivating(),t.then(()=>{this._leaveActivating()}).catch(s=>{this._reject(s)})),this.children!==null)for(;e<this.children.length;++e)this.children[e].activate(this.$initiator,this,this.scope);this._leaveActivating()}deactivate(e,t){let s;switch(this.state&~Cn){case zs:this.state=gi;break;case Mt:this.state=gi,s=this.$promise?.catch(o=>{this.logger.warn("The activation error will be ignored, as the controller is already scheduled for deactivation. The activation was rejected with: %s",o)});break;case uo:case kn:case ps:case kn|ps:return;default:throw B(505,this.name,this.state)}this.debug&&this.logger.trace("deactivate()"),this.$initiator=e,e===this&&this._enterDetaching();let i=0,r;if(this.children!==null)for(i=0;i<this.children.length;++i)this.children[i].deactivate(e,this);return q(s,()=>{if(this.isBound&&(this.vmKind!==qe&&this._lifecycleHooks.detaching!=null&&(this.debug&&this.logger.trace("lifecycleHooks.detaching()"),r=De(...this._lifecycleHooks.detaching.map(Rv,this))),this._vmHooks._detaching&&(this.debug&&this.logger.trace("detaching()"),r=De(r,this._vm.detaching(this.$initiator,this.parent)))),Pe(r)&&(this._ensurePromise(),e._enterDetaching(),r.then(()=>{e._leaveDetaching()}).catch(o=>{e._reject(o)})),e.head===null?e.head=this:e.tail.next=this,e.tail=this,e===this)return this._leaveDetaching(),this.$promise})}removeNodes(){switch(this.vmKind){case mt:case qe:this.nodes.remove(),this.nodes.unlink()}}unbind(){this.debug&&this.logger.trace("unbind()");let e=0;if(this.bindings!==null)for(;e<this.bindings.length;++e)this.bindings[e].unbind();switch(this.parent=null,this.vmKind){case js:this.scope=null;break;case qe:this.hasLockedScope||(this.scope=null),(this.state&Cn)===Cn&&!this.viewFactory.tryReturnToCache(this)&&this.$initiator===this&&this.dispose();break;case mt:this.scope.parent=null;break}this.state=kn,this.$initiator=null,this._resolve()}_ensurePromise(){this.$promise===void 0&&(this.$promise=new Promise((e,t)=>{this.$resolve=e,this.$reject=t}),this.$initiator!==this&&this.parent._ensurePromise())}_resolve(){this.$promise!==void 0&&(fo=this.$resolve,this.$resolve=this.$reject=this.$promise=void 0,fo(),fo=void 0)}_reject(e){this.$promise!==void 0&&(po=this.$reject,this.$resolve=this.$reject=this.$promise=void 0,po(e),po=void 0),this.$initiator!==this&&this.parent._reject(e)}_enterActivating(){++this._activatingStack,this.$initiator!==this&&this.parent._enterActivating()}_leaveActivating(){if(this.state!==Mt){--this._activatingStack,this._resolve(),this.$initiator!==this&&this.parent._leaveActivating();return}if(--this._activatingStack===0){if(this.vmKind!==qe&&this._lifecycleHooks.attached!=null&&(Ns=De(...this._lifecycleHooks.attached.map(Pv,this))),this._vmHooks._attached&&(this.debug&&this.logger.trace("attached()"),Ns=De(Ns,this._vm.attached(this.$initiator))),Pe(Ns)){this._ensurePromise(),Ns.then(()=>{this.state=zs,this._resolve(),this.$initiator!==this&&this.parent._leaveActivating()}).catch(e=>{this._reject(e)}),Ns=void 0;return}Ns=void 0,this.state=zs,this._resolve()}this.$initiator!==this&&this.parent._leaveActivating()}_enterDetaching(){++this._detachingStack}_leaveDetaching(){if(--this._detachingStack===0){this.debug&&this.logger.trace("detach()"),this._enterUnbinding(),this.removeNodes();let e=this.$initiator.head,t;for(;e!==null;)e!==this&&(e.debug&&e.logger.trace("detach()"),e.removeNodes()),e._isBindingDone&&(e.vmKind!==qe&&e._lifecycleHooks.unbinding!=null&&(t=De(...e._lifecycleHooks.unbinding.map(Ov,e))),e._vmHooks._unbinding&&(e.debug&&e.logger.trace("unbinding()"),t=De(t,e.viewModel.unbinding(e.$initiator,e.parent)))),Pe(t)&&(this._ensurePromise(),this._enterUnbinding(),t.then(()=>{this._leaveUnbinding()}).catch(s=>{this._reject(s)})),t=void 0,e=e.next;this._leaveUnbinding()}}_enterUnbinding(){++this._unbindingStack}_leaveUnbinding(){if(--this._unbindingStack===0){this.debug&&this.logger.trace("unbind()");let e=this.$initiator.head,t=null;for(;e!==null;)e!==this&&(e._isBindingDone=!1,e.isBound=!1,e.unbind()),t=e.next,e.next=null,e=t;this.head=this.tail=null,this._isBindingDone=!1,this.isBound=!1,this.unbind()}}addBinding(e){this.bindings===null?this.bindings=[e]:this.bindings[this.bindings.length]=e}addChild(e){this.children===null?this.children=[e]:this.children[this.children.length]=e}is(e){switch(this.vmKind){case js:case mt:return this.definition.name===e;case qe:return this.viewFactory.name===e}}lockScope(e){this.scope=e,this.hasLockedScope=!0}setHost(e){return this.vmKind===mt&&(ft(e,ze,this),ft(e,this.definition.key,this)),this.host=e,this.mountTarget=Yn,this}setShadowRoot(e){return this.vmKind===mt&&(ft(e,ze,this),ft(e,this.definition.key,this)),this.shadowRoot=e,this.mountTarget=Xn,this}setLocation(e){return this.vmKind===mt&&(ft(e,ze,this),ft(e,this.definition.key,this)),this.location=e,this.mountTarget=Gn,this}release(){this.state|=Cn}dispose(){this.debug&&this.logger.trace("dispose()"),(this.state&ps)!==ps&&(this.state|=ps,this._vmHooks._dispose&&this._vm.dispose(),this.children!==null&&(this.children.forEach($v),this.children=null),this.scope=null,this.nodes=null,this.location=null,this.viewFactory=null,this._vm!==null&&(fs.delete(this._vm),this._vm=null),this._vm=null,this.host=null,this.shadowRoot=null,this.container.disposeResolvers())}accept(e){if(e(this)===!0||this._vmHooks._accept&&this._vm.accept(e)===!0)return!0;if(this.children!==null){const{children:t}=this;for(let s=0,i=t.length;s<i;++s)if(t[s].accept(e)===!0)return!0}}}const fs=new WeakMap,id=0,Yn=1,Xn=2,Gn=3,kv=cs({none:id,host:Yn,shadowRoot:Xn,location:Gn}),Cv=zf(uu);function lc(n,e,t){const s=e.bindables,i=xu(s),r=i.length;if(r===0)return;const o=n.container.get(jn),a="propertiesChanged"in t,c=n.vmKind===qe?void 0:n.container.get(Cv),l=a?(()=>{let h={},u=!1,d=0;const p=()=>{u||(u=!0,Nt(()=>{u=!1;const m=h;h={},d=0,n.isBound&&(t.propertiesChanged?.(m),d>0&&p())}))};return(m,f,g)=>{h[m]={newValue:f,oldValue:g},d++,p()}})():wt;for(let h=0;h<r;++h){const u=i[h],d=s[u],p=d.callback,m=o.getObserver(t,u);if(d.set!==wt&&m.useCoercer?.(d.set,c)!==!0)throw B(507,u);if(t[p]!=null||t.propertyChanged!=null||a){const f=(g,w)=>{n.isBound&&(t[p]?.(g,w),t.propertyChanged?.(u,g,w),l(u,g,w))};if(m.useCallback?.(f)!==!0)throw B(508,u)}}}const cc=new Map,xv=n=>{let e=cc.get(n);return e==null&&(e=new oi(n,0),cc.set(n,e)),e};function hc(n,e,t,s){const i=e.get(jn),r=e.get(Ln),o=t.watches,a=n.vmKind===mt?n.scope:Oe.create(s,null,!0),c=o.length;let l,h,u,d,p=0;for(;c>p;++p){if({expression:l,callback:h,flush:d}=o[p],h=ce(h)?h:Reflect.get(s,h),!ce(h))throw B(506,h);ce(l)?n.addBinding(new nd(s,i,l,h,d)):(u=se(l)?r.parse(l,jt):xv(l),n.addBinding(new Qo(a,e,i,u,h,d)))}}class yn{constructor(e){this._define="define"in e,this._hydrating="hydrating"in e,this._hydrated="hydrated"in e,this._created="created"in e,this._binding="binding"in e,this._bound="bound"in e,this._attaching="attaching"in e,this._attached="attached"in e,this._detaching="detaching"in e,this._unbinding="unbinding"in e,this._dispose="dispose"in e,this._accept="accept"in e}}yn.none=new yn({});const Sv={mode:"open"},mt="customElement",js="customAttribute",qe="synthetic",uo=0,Mt=1,zs=2,gi=4,kn=8,Cn=16,ps=32;function Av(n){const e=[];return(n&Mt)===Mt&&e.push("activating"),(n&zs)===zs&&e.push("activated"),(n&gi)===gi&&e.push("deactivating"),(n&kn)===kn&&e.push("deactivated"),(n&Cn)===Cn&&e.push("released"),(n&ps)===ps&&e.push("disposed"),e.length===0?"none":e.join("|")}const Fr=me("IController"),As=me("IHydrationContext");class rd{constructor(e,t,s){this.instruction=t,this.parent=s,this.controller=e}}function $v(n){n.dispose()}function uc(n){n.instance.created(this._vm,this)}function Iv(n){n.instance.hydrating(this._vm,this)}function Tv(n){n.instance.hydrated(this._vm,this)}function Ev(n){return n.instance.binding(this._vm,this.$initiator,this.parent)}function Mv(n){return n.instance.bound(this._vm,this.$initiator,this.parent)}function Bv(n){return n.instance.attaching(this._vm,this.$initiator,this.parent)}function Pv(n){return n.instance.attached(this._vm,this.$initiator)}function Rv(n){return n.instance.detaching(this._vm,this.$initiator,this.parent)}function Ov(n){return n.instance.unbinding(this._vm,this.$initiator,this.parent)}let fo,po,Ns;const ft=Rt.set,Lv=me("IEventTarget",n=>n.cachedCallback(e=>e.has(vr,!0)?e.get(vr).host:e.get(nt).document)),et=me("IRenderLocation"),pr=me("ICssClassMapping"),gr=new WeakMap;function mr(n){if(gr.has(n))return gr.get(n);let e=0,t=n.nextSibling;for(;t!==null;){if(t.nodeType===8)switch(t.textContent){case"au-start":++e;break;case"au-end":if(e--===0)return t}t=t.nextSibling}if(n.parentNode===null&&n.nodeType===11){const s=$n(n,{optional:!0});if(s==null)return null;if(s.mountTarget===kv.shadowRoot)return mr(s.host)}return n.parentNode}function Dv(n,e){if(n.platform!==void 0&&!(n instanceof n.platform.Node)){const t=n.childNodes;for(let s=0,i=t.length;s<i;++s)gr.set(t[s],e)}else gr.set(n,e)}function Si(n){if(od(n))return n;const e=n.ownerDocument.createComment("au-end"),t=e.$start=n.ownerDocument.createComment("au-start"),s=n.parentNode;return s!==null&&(s.replaceChild(e,n),s.insertBefore(t,e)),e}function od(n){return n.textContent==="au-end"}class go{get firstChild(){return this._firstChild}get lastChild(){return this._lastChild}constructor(e,t){this.platform=e,this.next=void 0,this._isMounted=!1,this._isLinked=!1,this.ref=null;const s=(this.f=t).querySelectorAll("au-m");let i=0,r=s.length,o=this.t=Array(r),a,c;for(;r>i;)c=s[i],a=c.nextSibling,c.remove(),a.nodeType===8&&(c=a,(a=a.nextSibling).$start=c),o[i]=a,++i;const l=t.childNodes,h=this.childNodes=Array(r=l.length);for(i=0;r>i;)h[i]=l[i],++i;this._firstChild=t.firstChild,this._lastChild=t.lastChild}findTargets(){return this.t}insertBefore(e){if(this._isLinked&&this.ref)this.addToLinked();else{const t=e.parentNode;if(this._isMounted){let s=this._firstChild,i;const r=this._lastChild;for(;s!=null&&(i=s.nextSibling,t.insertBefore(s,e),s!==r);)s=i}else this._isMounted=!0,e.parentNode.insertBefore(this.f,e)}}appendTo(e,t=!1){if(this._isMounted){let s=this._firstChild,i;const r=this._lastChild;for(;s!=null&&(i=s.nextSibling,e.appendChild(s),s!==r);)s=i}else this._isMounted=!0,t||e.appendChild(this.f)}remove(){if(this._isMounted){this._isMounted=!1;const e=this.f,t=this._lastChild;let s,i=this._firstChild;for(;i!==null&&(s=i.nextSibling,e.appendChild(i),i!==t);)i=s}}addToLinked(){const e=this.ref,t=e.parentNode;if(this._isMounted){let s=this._firstChild,i;const r=this._lastChild;for(;s!=null&&(i=s.nextSibling,t.insertBefore(s,e),s!==r);)s=i}else this._isMounted=!0,t.insertBefore(this.f,e)}unlink(){this._isLinked=!1,this.next=void 0,this.ref=void 0}link(e){this._isLinked=!0,od(e)?this.ref=e:(this.next=e,this._obtainRefNode())}_obtainRefNode(){this.next!==void 0?this.ref=this.next.firstChild:this.ref=void 0}}const Nr=(n,e,t=n.get(nt))=>(we(n,t.HTMLElement,we(n,t.Element,we(n,Mr,new Re("ElementResolver",e)))),n);function Fv(n){return function(e,t){return t.addInitializer(function(){ad(n,this)}),e}}const mo=new WeakMap;class st{get type(){return xb}constructor(e,t,s,i,r,o,a,c,l,h,u,d,p,m,f,g,w,I,M){this.Type=e,this.name=t,this.aliases=s,this.key=i,this.capture=r,this.template=o,this.instructions=a,this.dependencies=c,this.injectable=l,this.needsCompile=h,this.surrogates=u,this.bindables=d,this.containerless=p,this.shadowOptions=m,this.hasSlots=f,this.enhance=g,this.watches=w,this.strict=I,this.processContent=M}static create(e,t=null){if(t===null){const i=e;if(se(i))throw B(761,e);const r=Tt("name",i,br);ce(i.Type)?t=i.Type:t=cd(Hc(r));for(const o of Object.values(at.from(i.bindables)))at._add(o,t);return new st(t,r,Be(i.aliases),Tt("key",i,()=>mn(r)),it("capture",i,t,gt),it("template",i,t,pt),Be(i.instructions),Be(rt(t,"dependencies"),i.dependencies),Tt("injectable",i,pt),Tt("needsCompile",i,vo),Be(i.surrogates),at.from(rt(t,"bindables"),i.bindables),it("containerless",i,t,gt),Tt("shadowOptions",i,pt),Tt("hasSlots",i,gt),Tt("enhance",i,gt),Tt("watches",i,jv),Tt("strict",i,bo),kt("processContent",t,pt))}if(se(e))return new st(t,e,Be(rt(t,"aliases"),t.aliases),mn(e),kt("capture",t,gt),kt("template",t,pt),Be(rt(t,"instructions"),t.instructions),Be(rt(t,"dependencies"),t.dependencies),kt("injectable",t,pt),kt("needsCompile",t,vo),Be(rt(t,"surrogates"),t.surrogates),at.from(...at.getAll(t),rt(t,"bindables"),t.bindables),kt("containerless",t,gt),kt("shadowOptions",t,pt),kt("hasSlots",t,gt),kt("enhance",t,gt),Be(qo.getDefinitions(t),t.watches),kt("strict",t,bo),kt("processContent",t,pt));const s=Tt("name",e,br);for(const i of Object.values(at.from(e.bindables)))at._add(i,t);return new st(t,s,Be(rt(t,"aliases"),e.aliases,t.aliases),mn(s),it("capture",e,t,gt),it("template",e,t,pt),Be(rt(t,"instructions"),e.instructions,t.instructions),Be(rt(t,"dependencies"),e.dependencies,t.dependencies),it("injectable",e,t,pt),it("needsCompile",e,t,vo),Be(rt(t,"surrogates"),e.surrogates,t.surrogates),at.from(...at.getAll(t),rt(t,"bindables"),t.bindables,e.bindables),it("containerless",e,t,gt),it("shadowOptions",e,t,pt),it("hasSlots",e,t,gt),it("enhance",e,t,gt),Be(e.watches,qo.getDefinitions(t),t.watches),it("strict",e,t,bo),it("processContent",e,t,pt))}static getOrCreate(e){if(e instanceof st)return e;if(mo.has(e))return mo.get(e);const t=st.create(e);return mo.set(e,t),$t(t,t.Type,ze),t}register(e,t){const s=this.Type,i=typeof t=="string"?mn(t):this.key,r=this.aliases;if(e.has(i,!1)){console.warn(B(153,this.name));return}e.register(e.has(s,!1)?null:qt(s,s),xs(s,i),...r.map(o=>xs(s,mn(o))))}toString(){return`au:ce:${this.name}`}}const Nv={name:void 0,searchParents:!1,optional:!1},pt=()=>null,bo=()=>{},gt=()=>!1,vo=()=>!0,jv=()=>X,nn="custom-element",ze=rn(nn),mn=n=>`${ze}:${n}`,br=(n=>()=>`unnamed-${++n}`)(0),Vv=(n,e,t)=>{$t(t,n,ls(e))},ad=(n,e)=>{const t=st.create(n,e),s=t.Type;return $t(t,s,ze,Pt),s},Hv=n=>ce(n)&&(Ir(ze,n)||n.$au?.type===nn),$n=(n,e=Nv)=>{if(e.name===void 0&&e.searchParents!==!0){const s=Rt.get(n,ze);if(s===null){if(e.optional===!0)return null;throw B(762,n)}return s}if(e.name!==void 0){if(e.searchParents!==!0){const r=Rt.get(n,ze);if(r===null)throw B(763,n);return r.is(e.name)?r:void 0}let s=n,i=!1;for(;s!==null;){const r=Rt.get(s,ze);if(r!==null&&(i=!0,r.is(e.name)))return r;s=mr(s)}if(i)return;throw B(764,n)}let t=n;for(;t!==null;){const s=Rt.get(t,ze);if(s!==null)return s;t=mr(t)}throw B(765,n)},rt=(n,e)=>Qe(ls(e),n),ld=n=>{const e=Qe(ze,n)??Ss(n,nn,st.create);if(e==null)throw B(760,n);return e},Uv=()=>{const n={$isInterface:!1,register(){return{$isResolver:!0,resolve(e,t){return t.has(n,!0)?t.get(n):null}}}};return n},cd=(function(){const n={value:"",writable:!1,enumerable:!1,configurable:!0},e={};return function(t,s=e){const i=class{};return n.value=t,Su(i,"name",n),s!==e&&Cu(i.prototype,s),i}})(),vs=cs({name:ze,keyFrom:mn,isType:Hv,for:$n,define:ad,getDefinition:ld,annotate:Vv,getAnnotation:rt,generateName:br,createInjectable:Uv,generateType:cd,find(n,e){const t=n.find(nn,e);return t==null?null:Qe(ze,t)??Ss(t,nn,st.create)??null}}),vr=me("IAppRoot");class dc{get controller(){return this._controller}constructor(e,t,s,i=!1){this.config=e,this.container=t,this._hydratePromise=void 0,this._useOwnAppTasks=i;const r=this.host=e.host;s.prepare(this),we(t,Lv,new Re("IEventTarget",r)),Nr(t,r,this.platform=this._createPlatform(t,r)),this._hydratePromise=q(this._runAppTasks("creating"),()=>{e.allowActionlessForm||r.addEventListener("submit",d=>{const p=d.target,m=!p.getAttribute("action");p.tagName==="FORM"&&m&&d.preventDefault()},!1);const o=i?t:t.createChild(),a=e.component;let c;ce(a)?c=o.invoke(a):c=e.component;const l={hydrate:!1,projections:null},h=i?st.create({name:br(),template:this.host,enhance:!0,strict:e.strictBinding}):void 0,u=this._controller=ht.$el(o,c,r,l,h);return u._hydrateCustomElement(l),q(this._runAppTasks("hydrating"),()=>(u._hydrate(),q(this._runAppTasks("hydrated"),()=>{u._hydrateChildren(),this._hydratePromise=void 0})))})}activate(){return q(this._hydratePromise,()=>q(this._runAppTasks("activating"),()=>q(this._controller.activate(this._controller,null,void 0),()=>this._runAppTasks("activated"))))}deactivate(){return q(this._runAppTasks("deactivating"),()=>q(this._controller.deactivate(this._controller,null),()=>this._runAppTasks("deactivated")))}_runAppTasks(e){const t=this.container,s=this._useOwnAppTasks&&!t.has(sc,!1)?[]:t.getAll(sc);return De(...s.reduce((i,r)=>(r.slot===e&&i.push(r.run()),i),[]))}_createPlatform(e,t){let s;if(e.has(nt,!1))s=e.get(nt);else{if(t.ownerDocument.defaultView===null)throw B(769);s=new bs(t.ownerDocument.defaultView),e.register(Iu(nt,s))}return s}dispose(){this._controller?.dispose()}}const fc=me("IAurelia");let Wv=class Yo{get isRunning(){return this._isRunning}get isStarting(){return this._isStarting}get isStopping(){return this._isStopping}get root(){if(this._root==null){if(this.next==null)throw B(767);return this.next}return this._root}constructor(e=Ts.createContainer()){if(this.container=e,this._isRunning=!1,this._isStarting=!1,this._isStopping=!1,this._root=void 0,this.next=void 0,this._startPromise=void 0,this._stopPromise=void 0,e.has(fc,!0)||e.has(Yo,!0))throw B(768);we(e,fc,new Re("IAurelia",this)),we(e,Yo,new Re("Aurelia",this)),we(e,vr,this._rootProvider=new Re("IAppRoot"))}register(...e){return this.container.register(...e),this}app(e){return this.next=new dc(e,this.container,this._rootProvider),this}enhance(e){const t=e.container??this.container.createChild(),s=we(t,vr,new Re("IAppRoot")),i=new dc({host:e.host,component:e.component},t,s,!0);return q(i.activate(),()=>i)}async waitForIdle(){const e=this.root.platform;await e.domQueue.yield(),await e.taskQueue.yield()}start(e=this.next){if(e==null)throw B(770);return Pe(this._startPromise)?this._startPromise:this._startPromise=q(this.stop(),()=>(Rt.hideProp||Reflect.set(e.host,"$aurelia",this),this._rootProvider.prepare(this._root=e),this._isStarting=!0,q(e.activate(),()=>{this._isRunning=!0,this._isStarting=!1,this._startPromise=void 0,this._dispatchEvent(e,"au-started",e.host)})))}stop(e=!1){if(Pe(this._stopPromise))return this._stopPromise;if(this._isRunning===!0){const t=this._root;return this._isRunning=!1,this._isStopping=!0,this._stopPromise=q(t.deactivate(),()=>q(am(),()=>{Reflect.deleteProperty(t.host,"$aurelia"),e&&t.dispose(),this._root=void 0,this._rootProvider.dispose(),this._isStopping=!1,this._stopPromise=void 0,this._dispatchEvent(t,"au-stopped",t.host)}))}}dispose(){if(this._isRunning||this._isStopping)throw B(771);this.container.dispose()}_dispatchEvent(e,t,s){const i=new e.platform.window.CustomEvent(t,{detail:this,bubbles:!0,cancelable:!0});s.dispatchEvent(i)}};const hd=me("ISVGAnalyzer",n=>n.singleton(zv));class zv{isStandardSvgAttribute(e,t){return!1}}class ud{constructor(){this.fns=[],this._tagAttrMap=de(),this._globalAttrMap=de(),this.svg=E(hd),this.useMapping({LABEL:{for:"htmlFor"},IMG:{usemap:"useMap"},INPUT:{maxlength:"maxLength",minlength:"minLength",formaction:"formAction",formenctype:"formEncType",formmethod:"formMethod",formnovalidate:"formNoValidate",formtarget:"formTarget",inputmode:"inputMode"},TEXTAREA:{maxlength:"maxLength"},TD:{rowspan:"rowSpan",colspan:"colSpan"},TH:{rowspan:"rowSpan",colspan:"colSpan"}}),this.useGlobalMapping({accesskey:"accessKey",contenteditable:"contentEditable",tabindex:"tabIndex",textcontent:"textContent",innerhtml:"innerHTML",scrolltop:"scrollTop",scrollleft:"scrollLeft",readonly:"readOnly"})}useMapping(e){let t,s,i,r;for(i in e){t=e[i],s=this._tagAttrMap[i]??=de();for(r in t){if(s[r]!==void 0)throw pc(r,i);s[r]=t[r]}}}useGlobalMapping(e){const t=this._globalAttrMap;for(const s in e){if(t[s]!==void 0)throw pc(s,"*");t[s]=e[s]}}useTwoWay(e){this.fns.push(e)}isTwoWay(e,t){return qv(e,t)||this.fns.length>0&&this.fns.some(s=>s(e,t))}map(e,t){return this._tagAttrMap[e.nodeName]?.[t]??this._globalAttrMap[t]??(Uo(e,t,this.svg)?t:null)}}ud.register=Ii(wh);function qv(n,e){switch(n.nodeName){case"INPUT":switch(n.type){case"checkbox":case"radio":return e==="checked";default:return e==="value"||e==="files"||e==="value-as-number"||e==="value-as-date"}case"TEXTAREA":case"SELECT":return e==="value";default:switch(e){case"textcontent":case"innerhtml":return n.hasAttribute("contenteditable");case"scrolltop":case"scrollleft":return!0;default:return!1}}}function pc(n,e){return B(719,n,e)}const Kv={register(n){n.register(ru,ud,dd)}};class Qv{constructor(e,t,s){this.attrs=e,this.bindables=t,this.primary=s}}class dd{constructor(){this._resourceCache=new WeakMap,this._bindableCache=new WeakMap}el(e,t){let s=this._resourceCache.get(e);return s==null&&this._resourceCache.set(e,s=new gc),t in s._element?s._element[t]:s._element[t]=vs.find(e,t)}attr(e,t){let s=this._resourceCache.get(e);return s==null&&this._resourceCache.set(e,s=new gc),t in s._attr?s._attr[t]:s._attr[t]=Ra.find(e,t)}bindables(e){let t=this._bindableCache.get(e);if(t==null){const s=e.bindables,i=de();let r,o,a=!1,c,l;for(o in s){if(r=s[o],l=r.attribute,r.primary===!0){if(a)throw B(714,e);a=!0,c=r}else!a&&c==null&&(c=r);i[l]=ts.create(o,r)}r==null&&e.type==="custom-attribute"&&(c=i.value=ts.create("value",{mode:e.defaultBindingMode??Ta})),this._bindableCache.set(e,t=new Qv(i,s,c??null))}return t}}dd.register=Ii(ou);class gc{constructor(){this._element=de(),this._attr=de()}}const Yv=de();class Ai{static forNs(e){return Yv[e]??=new Ai(e)}constructor(e){this.ns=e,this.type=Rs|zt}getValue(e,t){return e.getAttributeNS(this.ns,t)}setValue(e,t,s){e==null?t.removeAttributeNS(this.ns,s):t.setAttributeNS(this.ns,s,e)}}Or(Ai);class fd{constructor(){this.type=Rs|zt}getValue(e,t){return e.getAttribute(t)}setValue(e,t,s){e==null?t.removeAttribute(s):t.setAttribute(s,e)}}Or(fd);const Ji=new fd;class Qs{static _getSelectedOptions(e){const t=[];if(e.length===0)return t;const s=e.length;let i=0,r;for(;s>i;)r=e[i],r.selected&&(t[t.length]=qs.call(r,"model")?r.model:r.value),++i;return t}static _defaultMatcher(e,t){return e===t}constructor(e,t,s,i){this.type=Rs|Ma|zt,this._value=void 0,this._oldValue=void 0,this._hasChanges=!1,this._arrayObserver=void 0,this._nodeObserver=void 0,this._observing=!1,this._listened=!1,this._el=e,this._observerLocator=i,this._config=s}getValue(){return this._observing?this._value:this._el.multiple?Qs._getSelectedOptions(this._el.options):this._el.value}setValue(e){this._oldValue=this._value,this._value=e,this._hasChanges=e!==this._oldValue,this._observeArray(e instanceof Array?e:null),this._flushChanges()}_flushChanges(){this._hasChanges&&(this._hasChanges=!1,this.syncOptions())}handleCollectionChange(){this.syncOptions()}syncOptions(){const e=this._value,t=this._el,s=Ee(e),i=t.matcher??Qs._defaultMatcher,r=t.options;let o=r.length;for(;o-- >0;){const a=r[o],c=qs.call(a,"model")?a.model:a.value;if(s){a.selected=e.findIndex(l=>!!i(c,l))!==-1;continue}a.selected=!!i(c,e)}}syncValue(){const e=this._el,t=e.options,s=t.length,i=this._value;let r=0;if(e.multiple){if(!(i instanceof Array))return!0;let c;const l=e.matcher||Qs._defaultMatcher,h=[];for(;r<s;)c=t[r],c.selected&&h.push(qs.call(c,"model")?c.model:c.value),++r;let u;for(r=0;r<i.length;)u=i[r],h.findIndex(d=>!!l(u,d))===-1?i.splice(r,1):++r;for(r=0;r<h.length;)u=h[r],i.findIndex(d=>!!l(u,d))===-1&&i.push(u),++r;return!1}let o=null,a;for(;r<s;){if(a=t[r],a.selected){o=qs.call(a,"model")?a.model:a.value;break}++r}return this._oldValue=this._value,this._value=o,!0}_start(){(this._nodeObserver=Vu(this._el,this._handleNodeChange.bind(this))).observe(this._el,{childList:!0,subtree:!0,characterData:!0}),this._observeArray(this._value instanceof Array?this._value:null),this._observing=!0}_stop(){this._nodeObserver.disconnect(),this._arrayObserver?.unsubscribe(this),this._nodeObserver=this._arrayObserver=void 0,this._observing=!1}_observeArray(e){if(this._arrayObserver?.unsubscribe(this),this._arrayObserver=void 0,e!=null){if(!this._el.multiple)throw B(654);(this._arrayObserver=this._observerLocator.getArrayObserver(e)).subscribe(this)}}handleEvent(){this.syncValue()&&this._flush()}_handleNodeChange(e){this.syncOptions(),this.syncValue()&&this._flush()}_flush(){const e=this._oldValue;this._oldValue=this._value,this.subs.notify(this._value,e)}}ja(Qs),At(Qs,null);const Xv="--";class pd{constructor(e){this.obj=e,this.type=Rs|zt,this._value="",this._oldValue="",this.styles={},this.version=0,this._hasChanges=!1}getValue(){return this.obj.style.cssText}setValue(e){this._value=e,this._hasChanges=e!==this._oldValue,this._flushChanges()}_getStyleTuplesFromString(e){const t=[],s=/url\([^)]+$/;let i=0,r="",o,a,c,l;for(;i<e.length;){if(o=e.indexOf(";",i),o===-1&&(o=e.length),r+=e.substring(i,o),i=o+1,s.test(r)){r+=";";continue}a=r.indexOf(":"),c=r.substring(0,a).trim(),l=r.substring(a+1).trim(),t.push([c,l]),r=""}return t}_getStyleTuplesFromObject(e){let t,s;const i=[];for(s in e)if(t=e[s],t!=null){if(se(t)){if(s.startsWith(Xv)){i.push([s,t]);continue}i.push([Uc(s),t]);continue}i.push(...this._getStyleTuples(t))}return i}_getStyleTuplesFromArray(e){const t=e.length;if(t>0){const s=[];let i=0;for(;t>i;++i)s.push(...this._getStyleTuples(e[i]));return s}return X}_getStyleTuples(e){return se(e)?this._getStyleTuplesFromString(e):e instanceof Array?this._getStyleTuplesFromArray(e):e instanceof Object?this._getStyleTuplesFromObject(e):X}_flushChanges(){if(this._hasChanges){this._hasChanges=!1;const e=this._value,t=this.styles,s=this._getStyleTuples(e);let i,r=this.version;this._oldValue=e;let o,a,c,l=0;const h=s.length;for(;l<h;++l)o=s[l],a=o[0],c=o[1],this.setProperty(a,c),t[a]=r;if(this.styles=t,this.version+=1,r===0)return;r-=1;for(i in t)!qs.call(t,i)||t[i]!==r||this.obj.style.removeProperty(i)}}setProperty(e,t){let s="";t!=null&&ce(t.indexOf)&&t.includes("!important")&&(s="important",t=t.replace("!important","")),this.obj.style.setProperty(e,t,s)}bind(){this._value=this._oldValue=this.obj.style.cssText}}Or(pd);class Xo{constructor(e,t,s){this.type=Rs|Ma|zt,this._value="",this._oldValue="",this._hasChanges=!1,this._listened=!1,this._el=e,this._key=t,this._config=s}getValue(){return this._value}setValue(e){is(e,this._value)||(this._oldValue=this._value,this._value=e,this._hasChanges=!0,this._config.readonly||this._flushChanges())}_flushChanges(){this._hasChanges&&(this._hasChanges=!1,this._el[this._key]=this._value??this._config.default,this._flush())}handleEvent(){this._oldValue=this._value,this._value=this._el[this._key],this._oldValue!==this._value&&(this._hasChanges=!1,this._flush())}_start(){this._value=this._oldValue=this._el[this._key]}_flush(){const e=this._oldValue;this._oldValue=this._value,this.subs.notify(this._value,e)}}ja(Xo),At(Xo,null);const mc=(()=>{const n="http://www.w3.org/1999/xlink",e="http://www.w3.org/XML/1998/namespace",t="http://www.w3.org/2000/xmlns/";return Cu(de(),{"xlink:actuate":["actuate",n],"xlink:arcrole":["arcrole",n],"xlink:href":["href",n],"xlink:role":["role",n],"xlink:show":["show",n],"xlink:title":["title",n],"xlink:type":["type",n],"xml:lang":["lang",e],"xml:space":["space",e],xmlns:["xmlns",t],"xmlns:xlink":["xlink",t]})})(),gd=new mu;gd.type=Rs|zt;class Va{constructor(){this.allowDirtyCheck=!0,this._events=de(),this._globalEvents=de(),this._overrides=de(),this._globalOverrides=de(),this._locator=E(Nf),this._platform=E(nt),this._dirtyChecker=E(Ca),this.svg=E(hd);const e=["change","input"],t={events:e,default:""};this.useConfig({INPUT:{value:t,valueAsNumber:{events:e,default:0},checked:{type:Go,events:e},files:{events:e,readonly:!0}},SELECT:{value:{type:Qs,events:["change"],default:""}},TEXTAREA:{value:t}});const s={events:["change","input","blur","keyup","paste"],default:""},i={events:["scroll"],default:0};this.useConfigGlobal({scrollTop:i,scrollLeft:i,textContent:s,innerHTML:s}),this.overrideAccessorGlobal("css","style","class"),this.overrideAccessor({INPUT:["value","checked","model"],SELECT:["value"],TEXTAREA:["value"]})}handles(e,t){return e instanceof this._platform.Node}useConfig(e,t,s){const i=this._events;let r;if(se(e))r=i[e]??=de(),r[t]==null?r[t]=s:Hi(e,t);else for(const o in e){r=i[o]??=de();const a=e[o];for(t in a)r[t]==null?r[t]=a[t]:Hi(o,t)}}useConfigGlobal(e,t){const s=this._globalEvents;if(typeof e=="object")for(const i in e)s[i]==null?s[i]=e[i]:Hi("*",i);else s[e]==null?s[e]=t:Hi("*",e)}getAccessor(e,t,s){if(t in this._globalOverrides||t in(this._overrides[e.tagName]??Uf))return this.getObserver(e,t,s);switch(t){case"src":case"href":case"role":case"minLength":case"maxLength":case"placeholder":case"size":case"pattern":case"title":case"popovertarget":case"popovertargetaction":return(t==="popovertarget"||t==="popovertargetaction")&&e.nodeName!=="INPUT"&&e.nodeName!=="BUTTON"&&console.warn(`[aurelia] Popover API are only valid on <input> or <button>. Detected ${t} on <${e.nodeName.toLowerCase()}>`),Ji;default:{const i=mc[t];return i!==void 0?Ai.forNs(i[1]):Uo(e,t,this.svg)?Ji:gd}}}overrideAccessor(e,t){let s;if(se(e))s=this._overrides[e]??=de(),s[t]=!0;else for(const i in e)for(const r of e[i])s=this._overrides[i]??=de(),s[r]=!0}overrideAccessorGlobal(...e){for(const t of e)this._globalOverrides[t]=!0}getNodeObserverConfig(e,t){return this._events[e.tagName]?.[t]??this._globalEvents[t]}getNodeObserver(e,t,s){const i=this._events[e.tagName]?.[t]??this._globalEvents[t];let r;return i!=null?(r=new(i.type??Xo)(e,t,i,s,this._locator),r.doNotCache||(bu(e)[t]=r),r):null}getObserver(e,t,s){switch(t){case"class":return new Lr(e);case"css":case"style":return new pd(e)}const i=this.getNodeObserver(e,t,s);if(i!=null)return i;const r=mc[t];if(r!==void 0)return Ai.forNs(r[1]);if(Uo(e,t,this.svg))return Ji;if(t in e.constructor.prototype){if(this.allowDirtyCheck)return this._dirtyChecker.createProperty(e,t);throw B(652,t)}else return new xa(e,t)}}Va.register=Ii(Sa);function Gv(n,e){if(n instanceof Array)return e.getArrayObserver(n);if(n instanceof Map)return e.getMapObserver(n);if(n instanceof Set)return e.getSetObserver(n)}function Hi(n,e){throw B(653,n,e)}function bc(n,e){return n===e}class Go{constructor(e,t,s,i){this.type=Rs|Ma|zt,this._value=void 0,this._oldValue=void 0,this._collectionObserver=void 0,this._valueObserver=void 0,this._listened=!1,this._el=e,this.oL=i,this._config=s}getValue(){return this._value}setValue(e){const t=this._value;e!==t&&(this._value=e,this._oldValue=t,this._observe(),this._synchronizeElement(),this._flush())}handleCollectionChange(){this._synchronizeElement()}handleChange(e,t){this._synchronizeElement()}_synchronizeElement(){const e=this._value,t=this._el,s=qs.call(t,"model")?t.model:t.value,i=t.type==="radio",r=t.matcher!==void 0?t.matcher:bc;if(i)t.checked=!!r(e,s);else if(e===!0)t.checked=!0;else{let o=!1;if(Ee(e))o=e.findIndex(a=>!!r(a,s))!==-1;else if(e instanceof Set){for(const a of e)if(r(a,s)){o=!0;break}}else if(e instanceof Map)for(const a of e){const c=a[0],l=a[1];if(r(c,s)&&l===!0){o=!0;break}}t.checked=o}}handleEvent(){let e=this._oldValue=this._value;const t=this._el,s=qs.call(t,"model")?t.model:t.value,i=t.checked,r=t.matcher!==void 0?t.matcher:bc;if(t.type==="checkbox"){if(Ee(e)){const o=e.findIndex(a=>!!r(a,s));i&&o===-1?e.push(s):!i&&o!==-1&&e.splice(o,1);return}else if(e instanceof Set){const o={};let a=o;for(const c of e)if(r(c,s)===!0){a=c;break}i&&a===o?e.add(s):!i&&a!==o&&e.delete(a);return}else if(e instanceof Map){let o;for(const a of e){const c=a[0];if(r(c,s)===!0){o=c;break}}e.set(o,i);return}e=i}else if(i)e=s;else return;this._value=e,this._flush()}_start(){this._observe()}_stop(){this._value=this._oldValue=void 0,this._collectionObserver?.unsubscribe(this),this._valueObserver?.unsubscribe(this),this._collectionObserver=this._valueObserver=void 0}_flush(){_o=this._oldValue,this._oldValue=this._value,this.subs.notify(this._value,_o),_o=void 0}_observe(){const e=this._el;(this._valueObserver??=e.$observers?.model??e.$observers?.value)?.subscribe(this),this._collectionObserver?.unsubscribe(this),this._collectionObserver=void 0,e.type==="checkbox"&&(this._collectionObserver=Gv(this._value,this.oL))?.subscribe(this)}}ja(Go),At(Go,null);let _o;class md{bind(e,t){if(!(t instanceof Je))throw B(9994,t);t.useTargetObserver(Ji)}}md.$au={type:_t,name:"attr"};class bd{bind(e,t){if(!("handleEvent"in t))throw B(801);t.self=!0}unbind(e,t){t.self=!1}}bd.$au={type:_t,name:"self"};class vd{constructor(){this._observerLocator=E(jn),this._nodeObserverLocator=E(Sa)}bind(e,t,...s){if(!(this._nodeObserverLocator instanceof Va))throw B(9993);if(s.length===0)throw B(802);if(!(t instanceof Je)||!(t.mode&os))throw B(803);const i=this._nodeObserverLocator.getNodeObserverConfig(t.target,t.targetProperty);if(i==null)throw B(9992,t);const r=this._nodeObserverLocator.getNodeObserver(t.target,t.targetProperty,this._observerLocator);r.useConfig({readonly:i.readonly,default:i.default,events:s}),t.useTargetObserver(r)}}vd.$au={type:_t,name:"updateTrigger"};class _r{constructor(){this.elseFactory=void 0,this.elseView=void 0,this.ifView=void 0,this.view=void 0,this.value=!1,this.cache=!0,this.pending=void 0,this._wantsDeactivate=!1,this._swapId=0,this._ifFactory=E(dt),this._location=E(et)}attaching(e,t){return this._swap(this.value)}detaching(e,t){return this._wantsDeactivate=!0,q(this.pending,()=>{this._wantsDeactivate=!1,this.pending=void 0,this.view?.deactivate(e,this.$controller)})}valueChanged(e,t){if(this.$controller.isActive&&(e=!!e,t=!!t,e!==t))return this._swap(e)}_swap(e){const t=this.view,s=this.$controller,i=this._swapId++,r=()=>!this._wantsDeactivate&&this._swapId===i+1;let o;return q(this.pending,()=>this.pending=q(t?.deactivate(t,s),()=>{if(r()&&(e?o=this.view=this.ifView=this.cache&&this.ifView!=null?this.ifView:this._ifFactory.create():o=this.view=this.elseView=this.cache&&this.elseView!=null?this.elseView:this.elseFactory?.create(),o!=null))return o.setLocation(this._location),q(o.activate(o,s,s.scope),()=>{r()&&(this.pending=void 0)})}))}dispose(){this.ifView?.dispose(),this.elseView?.dispose(),this.ifView=this.elseView=this.view=void 0}accept(e){if(this.view?.accept(e)===!0)return!0}}_r.$au={type:Ye,name:"if",isTemplateController:!0,bindables:{value:!0,cache:{set:n=>n===""||!!n&&n!=="false"}}};class _d{constructor(){this._factory=E(dt)}link(e,t,s,i){const r=e.children,o=r[r.length-1];if(o instanceof _r)o.elseFactory=this._factory;else if(o.viewModel instanceof _r)o.viewModel.elseFactory=this._factory;else throw B(810)}}_d.$au={type:"custom-attribute",name:"else",isTemplateController:!0};function Jv(n){n.dispose()}const Zv=["BindingBehavior","ValueConverter"];class wd{constructor(){this.views=[],this.key=null,this._oldViews=[],this._scopes=[],this._oldScopes=[],this._scopeMap=new Map,this._observer=void 0,this._observingInnerItems=!1,this._reevaluating=!1,this._innerItemsExpression=null,this._normalizedItems=void 0,this._hasDestructuredLocal=!1,this._location=E(et),this._parent=E(Fr),this._factory=E(dt),this._resolver=E(t_);const t=E(Fn).props[0].props[0];if(t!==void 0){const{to:s,value:i,command:r}=t;if(s==="key")if(r===null)this.key=i;else if(r==="bind")this.key=E(Ln).parse(i,jt);else throw B(775,r);else throw B(776,s)}}binding(e,t){const s=this._parent.bindings,i=s.length;let r,o,a=0;for(;i>a;++a)if(r=s[a],r.target===this&&r.targetProperty==="items"){o=this.forOf=r.ast,this._forOfBinding=r;let l=o.iterable;for(;l!=null&&Zv.includes(l.$kind);)l=l.expression,this._observingInnerItems=!0;this._innerItemsExpression=l;break}this._refreshCollectionObserver();const c=o.declaration;(this._hasDestructuredLocal=c.$kind==="ArrayDestructuring"||c.$kind==="ObjectDestructuring")||(this.local=ye(c,this.$controller.scope,r,null))}attaching(e,t){return this._normalizeToArray(),this._createScopes(void 0),this._activateAllViews(e,this._normalizedItems??X)}detaching(e,t){return this._refreshCollectionObserver(),this._deactivateAllViews(e)}unbinding(e,t){this._scopeMap.clear()}itemsChanged(){this.$controller.isActive&&(this._refreshCollectionObserver(),this._normalizeToArray(),this._createScopes(void 0),this._applyIndexMap(void 0))}handleCollectionChange(e,t){const s=this.$controller;if(s.isActive){if(this._observingInnerItems){if(this._reevaluating)return;this._reevaluating=!0,this.items=ye(this.forOf.iterable,s.scope,this._forOfBinding,null),this._reevaluating=!1;return}this._normalizeToArray(),this._createScopes(this.key===null?t:void 0),this._applyIndexMap(t)}}_applyIndexMap(e){const t=this.views;this._oldViews=t.slice();const s=t.length,i=this.key,r=i!==null,o=this._oldScopes,a=this._scopes;if(r||e===void 0){const c=this.local,h=this._normalizedItems.length,d=this.forOf.declaration,p=this._forOfBinding,m=this._hasDestructuredLocal;e=Zs(h);let f=0;if(s===0)for(;f<h;++f)e[f]=-2;else if(h===0)for(f=0;f<s;++f)e.deletedIndices.push(f),e.deletedItems.push(Zi(m,d,o[f],p,c));else if(r){const g=Array(s);for(f=0;f<s;++f)g[f]=xc(m,i,d,o[f],p,c);const w=Array(s);for(f=0;f<h;++f)w[f]=xc(m,i,d,a[f],p,c);for(f=0;f<h;++f)g.includes(w[f])?e[f]=g.indexOf(w[f]):e[f]=-2;for(f=0;f<s;++f)w.includes(g[f])||(e.deletedIndices.push(f),e.deletedItems.push(Zi(m,d,o[f],p,c)))}else{for(f=0;f<h;++f)o.includes(a[f])?e[f]=o.indexOf(a[f]):e[f]=-2;for(f=0;f<s;++f)a.includes(o[f])||(e.deletedIndices.push(f),e.deletedItems.push(Zi(m,d,o[f],p,c)))}}if(e.deletedIndices.length>0){const c=q(this._deactivateAndRemoveViewsByKey(e),()=>this._createAndActivateAndSortViewsByKey(e));Pe(c)&&c.catch(Wo)}else this._createAndActivateAndSortViewsByKey(e)}_refreshCollectionObserver(){const e=this.$controller.scope;let t=this._innerItems,s=this._observingInnerItems,i;s&&(t=this._innerItems=ye(this._innerItemsExpression,e,this._forOfBinding,null)??null,s=this._observingInnerItems=!is(this.items,t));const r=this._observer;if(this.$controller.isActive){const o=s?t:this.items;i=this._observer=this._resolver.resolve(o).getObserver?.(o),r!==i&&(r?.unsubscribe(this),i?.subscribe(this))}else r?.unsubscribe(this),this._observer=void 0}_createScopes(e){const t=this._scopes;this._oldScopes=t.slice();const s=this._normalizedItems,i=s.length,r=this._scopes=Array(s.length),o=this._scopeMap,a=new Map,c=this.$controller.scope,l=this._forOfBinding,h=this.forOf,u=this.local,d=this._hasDestructuredLocal;if(e===void 0){const p=this.key;if(p!==null){const f=Array(i);if(typeof p=="string")for(let g=0;g<i;++g)f[g]=s[g][p];else for(let g=0;g<i;++g){const w=Zo(s[g],h,c,l,u,d);Jo(d,h.declaration,w,l,u,s[g]),f[g]=ye(p,w,l,null)}for(let g=0;g<i;++g)r[g]=Sc(o,a,f[g],s[g],h,c,l,u,d)}else for(let f=0;f<i;++f)r[f]=Sc(o,a,s[f],s[f],h,c,l,u,d)}else{const p=t.length;for(let m=0;m<i;++m){const f=e[m];f>=0&&f<p?r[m]=t[f]:r[m]=Zo(s[m],h,c,l,u,d),Jo(d,h.declaration,r[m],l,u,s[m])}}o.clear(),this._scopeMap=a}_normalizeToArray(){const e=this.items;if(Ee(e)){this._normalizedItems=e.slice(0);return}const t=[];this._resolver.resolve(e).iterate(e,(s,i)=>{t[i]=s}),this._normalizedItems=t}_activateAllViews(e,t){let s,i,r,o;const{$controller:a,_factory:c,_location:l,_scopes:h}=this,u=t.length,d=this.views=Array(u);for(let p=0;p<u;++p)r=d[p]=c.create().setLocation(l),r.nodes.unlink(),o=h[p],Wi(o.overrideContext,p,u),i=r.activate(e??r,a,o),Pe(i)&&(s??=[]).push(i);if(s!==void 0)return s.length===1?s[0]:Promise.all(s)}_deactivateAllViews(e){let t,s,i,r=0;const{views:o,$controller:a}=this,c=o.length;for(;c>r;++r)i=o[r],i.release(),s=i.deactivate(e??i,a),Pe(s)&&(t??(t=[])).push(s);if(t!==void 0)return t.length===1?t[0]:Promise.all(t)}_deactivateAndRemoveViewsByKey(e){let t,s,i;const{$controller:r,views:o}=this,a=e.deletedIndices.slice().sort(r_),c=a.length;let l=0;for(;c>l;++l)i=o[a[l]],i.release(),s=i.deactivate(i,r),Pe(s)&&(t??(t=[])).push(s);for(l=0;c>l;++l)o.splice(a[l]-l,1);if(t!==void 0)return t.length===1?t[0]:Promise.all(t)}_createAndActivateAndSortViewsByKey(e){let t,s,i,r=0;const{$controller:o,_factory:a,_location:c,views:l,_scopes:h,_oldViews:u}=this,d=e.length;for(;d>r;++r)e[r]===-2&&(i=a.create(),l.splice(r,0,i));if(l.length!==d)throw B(814,[l.length,d]);let p=0;for(r=0;r<e.length;++r)(p=e[r])!==-2&&(l[r]=u[p]);const m=e_(e),f=m.length;let g,w=f-1;for(r=d-1;r>=0;--r)i=l[r],g=l[r+1],e[r]===-2?(i.nodes.link(g?.nodes??c),i.setLocation(c),Wi(h[r].overrideContext,r,d),s=i.activate(i,o,h[r]),Pe(s)&&(t??(t=[])).push(s)):w<0||r!==m[w]?(i.nodes.link(g?.nodes??c),Wi(i.scope.overrideContext,r,d),i.nodes.insertBefore(i.location)):(Wi(i.scope.overrideContext,r,d),--w);if(t!==void 0)return t.length===1?t[0]:Promise.all(t)}dispose(){this.views.forEach(Jv),this.views=void 0}accept(e){const{views:t}=this;if(t!==void 0){for(let s=0,i=t.length;s<i;++s)if(t[s].accept(e)===!0)return!0}}}wd.$au={type:Ye,name:"repeat",isTemplateController:!0,bindables:["items"]};let wr=16,Qt=new Int32Array(wr),Ui=new Int32Array(wr);function e_(n){const e=n.length;e>wr&&(wr=e,Qt=new Int32Array(e),Ui=new Int32Array(e));let t=0,s=0,i=0,r=0,o=0,a=0,c=0,l=0;for(;r<e;r++)if(s=n[r],s!==-2){if(o=Qt[t],i=n[o],i!==-2&&i<s){Ui[r]=o,Qt[++t]=r;continue}for(a=0,c=t;a<c;)l=a+c>>1,i=n[Qt[l]],i!==-2&&i<s?a=l+1:c=l;i=n[Qt[a]],(s<i||i===-2)&&(a>0&&(Ui[r]=Qt[a-1]),Qt[a]=r)}r=++t;const h=new Int32Array(r);for(s=Qt[t-1];t-- >0;)h[t]=s,s=Ui[s];for(;r-- >0;)Qt[r]=0;return h}class vc{get $odd(){return!this.$even}get $even(){return this.$index%2===0}get $first(){return this.$index===0}get $middle(){return!this.$first&&!this.$last}get $last(){return this.$index===this.$length-1}constructor(e=0,t=1){this.$index=e,this.$length=t}}const Wi=(n,e,t)=>{n.$index=e,n.$length=t},t_=me("IRepeatableHandlerResolver",n=>n.singleton(s_));class s_{constructor(){this._handlers=E(ia(n_))}resolve(e){if(_c.handles(e))return _c;if(wc.handles(e))return wc;if(yc.handles(e))return yc;if(kc.handles(e))return kc;if(Cc.handles(e))return Cc;const t=this._handlers.find(s=>s.handles(e));return t!==void 0?t:i_}}const n_=me("IRepeatableHandler"),_c={handles:Ee,getObserver:Aa,iterate(n,e){const t=n.length;let s=0;for(;s<t;++s)e(n[s],s,n)}},wc={handles:Rn,getObserver:Aa,iterate(n,e){let t=0,s;for(s of n.keys())e(s,t++,n)}},yc={handles:_s,getObserver:Aa,iterate(n,e){let t=0,s;for(s of n.entries())e(s,t++,n)}},kc={handles:_f,iterate(n,e){let t=0;for(;t<n;++t)e(t,t,n)}},Cc={handles:n=>n==null,iterate(){}},i_={handles(n){return!1},iterate(n,e){throw B(777,n)}},Jo=(n,e,t,s,i,r)=>{n?xi(e,t,s,null,r):t.bindingContext[i]=r},Zi=(n,e,t,s,i)=>n?ye(e,t,s,null):t.bindingContext[i],xc=(n,e,t,s,i,r)=>typeof e=="string"?Zi(n,t,s,i,r)[e]:ye(e,s,i,null),Sc=(n,e,t,s,i,r,o,a,c)=>{let l=n.get(t);if(l===void 0?l=Zo(s,i,r,o,a,c):l instanceof Oe?n.delete(t):l.length===1?(l=l[0],n.delete(t)):l=l.shift(),e.has(t)){const h=e.get(t);h instanceof Oe?e.set(t,[h,l]):h.push(l)}else e.set(t,l);return Jo(c,i.declaration,l,o,a,s),l},Zo=(n,e,t,s,i,r)=>{if(r){const o=Oe.fromParent(t,new Hl,new vc);xi(e.declaration,o,s,null,n)}return Oe.fromParent(t,new Hl(i,n),new vc)},r_=(n,e)=>n-e;class yd{constructor(){this.view=E(dt).create().setLocation(E(et))}valueChanged(e,t){const s=this.$controller,i=this.view.bindings;let r,o=0,a=0;if(s.isActive&&i!=null)for(r=Oe.fromParent(s.scope,e===void 0?{}:e),a=i.length;a>o;++o)i[o].bind(r)}attaching(e,t){const{$controller:s,value:i}=this,r=Oe.fromParent(s.scope,i===void 0?{}:i);return this.view.activate(e,s,r)}detaching(e,t){return this.view.deactivate(e,this.$controller)}dispose(){this.view.dispose(),this.view=void 0}accept(e){if(this.view?.accept(e)===!0)return!0}}yd.$au={type:Ye,name:"with",isTemplateController:!0,bindables:["value"]};class Ha{constructor(){this.cases=[],this.activeCases=[],this.promise=void 0,this._factory=E(dt),this._location=E(et)}link(e,t,s,i){this.view=this._factory.create(this.$controller).setLocation(this._location)}attaching(e,t){const s=this.view,i=this.$controller;return this.queue(()=>s.activate(e,i,i.scope)),this.queue(()=>this.swap(e,this.value)),this.promise}detaching(e,t){return this.queue(()=>this.view.deactivate(e,this.$controller)),this.promise}dispose(){this.view?.dispose(),this.view=void 0}valueChanged(e,t){this.$controller.isActive&&this.queue(()=>this.swap(null,this.value))}caseChanged(e){this.queue(()=>this._handleCaseChange(e))}_handleCaseChange(e){const t=e.isMatch(this.value),s=this.activeCases,i=s.length;if(!t)return i>0&&s[0].id===e.id?this._clearActiveCases(null):void 0;if(i>0&&s[0].id<e.id)return;const r=[];let o=e.fallThrough;if(!o)r.push(e);else{const a=this.cases,c=a.indexOf(e);for(let l=c,h=a.length;l<h&&o;l++){const u=a[l];r.push(u),o=u.fallThrough}}return q(this._clearActiveCases(null,r),()=>(this.activeCases=r,this._activateCases(null)))}swap(e,t){const s=[];let i=!1;for(const o of this.cases)if((i||o.isMatch(t))&&(s.push(o),i=o.fallThrough),s.length>0&&!i)break;const r=this.defaultCase;return s.length===0&&r!==void 0&&s.push(r),q(this.activeCases.length>0?this._clearActiveCases(e,s):void 0,()=>{if(this.activeCases=s,s.length!==0)return this._activateCases(e)})}_activateCases(e){const t=this.$controller;if(!t.isActive)return;const s=this.activeCases,i=s.length;if(i===0)return;const r=t.scope;return i===1?s[0].activate(e,r):De(...s.map(o=>o.activate(e,r)))}_clearActiveCases(e,t=[]){const s=this.activeCases,i=s.length;if(i!==0){if(i===1){const r=s[0];return t.includes(r)?void 0:(s.length=0,r.deactivate(e))}return q(De(...s.reduce((r,o)=>(t.includes(o)||r.push(o.deactivate(e)),r),[])),()=>{s.length=0})}}queue(e){const t=this.promise;let s;s=this.promise=q(q(t,e),()=>{this.promise===s&&(this.promise=void 0)})}accept(e){if(this.$controller.accept(e)===!0||this.activeCases.some(t=>t.accept(e)))return!0}}Ha.$au={type:Ye,name:"switch",isTemplateController:!0,bindables:["value"]};let o_=0;const kd=["value",{name:"fallThrough",mode:$r,set(n){switch(n){case"true":return!0;case"false":return!1;default:return!!n}}}];class Ua{constructor(){this.id=++o_,this.fallThrough=!1,this.view=void 0,this._factory=E(dt),this._locator=E(jn),this._location=E(et),this._logger=E(Xs).scopeTo(`Case-#${this.id}`)}link(e,t,s,i){const o=e.parent?.viewModel;if(o instanceof Ha)this.$switch=o,this.linkToSwitch(o);else throw B(815)}detaching(e,t){return this.deactivate(e)}isMatch(e){this._logger.debug("isMatch()");const t=this.value;return Ee(t)?(this._observer===void 0&&(this._observer=this._observeCollection(t)),t.includes(e)):t===e}valueChanged(e,t){Ee(e)?(this._observer?.unsubscribe(this),this._observer=this._observeCollection(e)):this._observer!==void 0&&this._observer.unsubscribe(this),this.$switch.caseChanged(this)}handleCollectionChange(){this.$switch.caseChanged(this)}activate(e,t){let s=this.view;if(s===void 0&&(s=this.view=this._factory.create().setLocation(this._location)),!s.isActive)return s.activate(e??s,this.$controller,t)}deactivate(e){const t=this.view;if(!(t===void 0||!t.isActive))return t.deactivate(e??t,this.$controller)}dispose(){this._observer?.unsubscribe(this),this.view?.dispose(),this.view=void 0}linkToSwitch(e){e.cases.push(this)}_observeCollection(e){const t=this._locator.getArrayObserver(e);return t.subscribe(this),t}accept(e){return this.$controller.accept(e)===!0?!0:this.view?.accept(e)}}Ba({name:"case",bindables:kd,isTemplateController:!0},Ua);class Cd extends Ua{linkToSwitch(e){if(e.defaultCase!==void 0)throw B(816);e.defaultCase=this}}Ba({name:"default-case",bindables:kd,isTemplateController:!0},Cd);var xd,Sd,Ad;class Wa{constructor(){this.preSettledTask=null,this.postSettledTask=null,this._factory=E(dt),this._location=E(et),this._platform=E(nt),this.logger=E(Xs).scopeTo("promise.resolve")}link(e,t,s,i){this.view=this._factory.create(this.$controller).setLocation(this._location)}attaching(e,t){const s=this.view,i=this.$controller;return q(s.activate(e,i,this.viewScope=Oe.fromParent(i.scope,{})),()=>this.swap(e))}valueChanged(e,t){this.$controller.isActive&&this.swap(null)}swap(e){const t=this.value;if(!Pe(t)){this.logger.warn(`The value '${tn(t)}' is not a promise. No change will be done.`);return}const s=this.fulfilled,i=this.rejected,r=this.pending,o=this.viewScope;let a;const c=()=>{De(a=(this.preSettledTask=ci(()=>De(s?.deactivate(e),i?.deactivate(e),r?.activate(e,o)))).result.catch(l=>{throw l}),t.then(l=>{if(this.value!==t)return;const h=()=>{this.postSettlePromise=(this.postSettledTask=ci(()=>De(r?.deactivate(e),i?.deactivate(e),s?.activate(e,o,l)))).result};this.preSettledTask.status===ao?a.then(h):(this.preSettledTask.cancel(),h())},l=>{if(this.value!==t)return;const h=()=>{this.postSettlePromise=(this.postSettledTask=ci(()=>De(r?.deactivate(e),s?.deactivate(e),i?.activate(e,o,l)))).result};this.preSettledTask.status===ao?a.then(h):(this.preSettledTask.cancel(),h())}))};this.postSettledTask?.status===ao?this.postSettlePromise.then(c):(this.postSettledTask?.cancel(),c())}detaching(e,t){return this.preSettledTask?.cancel(),this.postSettledTask?.cancel(),this.preSettledTask=this.postSettledTask=null,this.view.deactivate(e,this.$controller)}dispose(){this.view?.dispose(),this.view=void 0}}Wa.$au={type:Ye,name:"promise",isTemplateController:!0,bindables:["value"]};class $d{constructor(){this.view=void 0,this._factory=E(dt),this._location=E(et)}link(e,t,s,i){za(e).pending=this}activate(e,t){let s=this.view;if(s===void 0&&(s=this.view=this._factory.create().setLocation(this._location)),!s.isActive)return s.activate(s,this.$controller,t)}deactivate(e){const t=this.view;if(!(t===void 0||!t.isActive))return t.deactivate(t,this.$controller)}detaching(e){return this.deactivate(e)}dispose(){this.view?.dispose(),this.view=void 0}}$d.$au={type:Ye,name:"pending",isTemplateController:!0,bindables:{value:{mode:Ae}}};class Id{constructor(){this.view=void 0,this._factory=E(dt),this._location=E(et)}link(e,t,s,i){za(e).fulfilled=this}activate(e,t,s){this.value=s;let i=this.view;if(i===void 0&&(i=this.view=this._factory.create().setLocation(this._location)),!i.isActive)return i.activate(i,this.$controller,t)}deactivate(e){const t=this.view;if(!(t===void 0||!t.isActive))return t.deactivate(t,this.$controller)}detaching(e,t){return this.deactivate(e)}dispose(){this.view?.dispose(),this.view=void 0}}Id.$au={type:Ye,name:"then",isTemplateController:!0,bindables:{value:{mode:os}}};class Td{constructor(){this.view=void 0,this._factory=E(dt),this._location=E(et)}link(e,t,s,i){za(e).rejected=this}activate(e,t,s){this.value=s;let i=this.view;if(i===void 0&&(i=this.view=this._factory.create().setLocation(this._location)),!i.isActive)return i.activate(i,this.$controller,t)}deactivate(e){const t=this.view;if(!(t===void 0||!t.isActive))return t.deactivate(t,this.$controller)}detaching(e,t){return this.deactivate(e)}dispose(){this.view?.dispose(),this.view=void 0}}Td.$au={type:Ye,name:"catch",isTemplateController:!0,bindables:{value:{mode:os}}};function za(n){const t=n.parent?.viewModel;if(t instanceof Wa)return t;throw B(813)}class ea{"promise.resolve"(e,t){return new ut(e,t,"promise","bind")}}xd=Symbol.metadata;ea[xd]={[Ht]:Es.create([{pattern:"promise.resolve",symbols:""}],ea)};class ta{then(e,t){return new ut(e,t,"then","from-view")}}Sd=Symbol.metadata;ta[Sd]={[Ht]:Es.create([{pattern:"then",symbols:""}],ta)};class sa{catch(e,t){return new ut(e,t,"catch","from-view")}}Ad=Symbol.metadata;sa[Ad]={[Ht]:Es.create([{pattern:"catch",symbols:""}],sa)};class Ed{constructor(){this._needsApply=!1,this._element=E(Mr),this._platform=E(nt)}binding(){this.valueChanged()}valueChanged(){this.$controller.isActive?this._apply():this._needsApply=!0}attached(){this._needsApply&&(this._needsApply=!1,this._apply()),this._element.addEventListener("focus",this),this._element.addEventListener("blur",this)}detaching(){const e=this._element;e.removeEventListener("focus",this),e.removeEventListener("blur",this)}handleEvent(e){e.type==="focus"?this.value=!0:this._isElFocused||(this.value=!1)}_apply(){const e=this._element,t=this._isElFocused,s=this.value;s&&!t?e.focus():!s&&t&&e.blur()}get _isElFocused(){return this._element===this._platform.document.activeElement}}Ed.$au={type:Ye,name:"focus",bindables:{value:{mode:yu}}};class Md{constructor(){this.position="beforeend",this.strict=!1;const e=E(dt),t=E(et),s=E(nt);this._platform=s,this._resolvedTarget=s.document.createElement("div"),(this.view=e.create()).setLocation(this._targetLocation=Vb(s)),Dv(this.view.nodes,t)}attaching(e){this.callbackContext==null&&(this.callbackContext=this.$controller.scope.bindingContext);const t=this._resolvedTarget=this._getTarget();return this._moveLocation(t,this.position),this._activating(e,t)}detaching(e){return this._deactivating(e,this._resolvedTarget)}targetChanged(){const{$controller:e}=this;if(!e.isActive)return;const t=this._getTarget();if(this._resolvedTarget===t)return;this._resolvedTarget=t;const s=q(this._deactivating(null,t),()=>(this._moveLocation(t,this.position),this._activating(null,t)));Pe(s)&&s.catch(Wo)}positionChanged(){const{$controller:e,_resolvedTarget:t}=this;if(!e.isActive)return;const s=q(this._deactivating(null,t),()=>(this._moveLocation(t,this.position),this._activating(null,t)));Pe(s)&&s.catch(Wo)}_activating(e,t){const{activating:s,callbackContext:i,view:r}=this;return q(s?.call(i,t,r),()=>this._activate(e,t))}_activate(e,t){const{$controller:s,view:i}=this;if(e===null)i.nodes.insertBefore(this._targetLocation);else return q(i.activate(e??i,s,s.scope),()=>this._activated(t));return this._activated(t)}_activated(e){const{activated:t,callbackContext:s,view:i}=this;return t?.call(s,e,i)}_deactivating(e,t){const{deactivating:s,callbackContext:i,view:r}=this;return q(s?.call(i,t,r),()=>this._deactivate(e,t))}_deactivate(e,t){const{$controller:s,view:i}=this;if(e===null)i.nodes.remove();else return q(i.deactivate(e,s),()=>this._deactivated(t));return this._deactivated(t)}_deactivated(e){const{deactivated:t,callbackContext:s,view:i}=this;return q(t?.call(s,e,i),()=>this._removeLocation())}_getTarget(){const e=this._platform,t=e.document;let s=this.target,i=this.renderContext;if(s===""){if(this.strict)throw B(811);return t.body}if(se(s)){let r=t;se(i)&&(i=t.querySelector(i)),i instanceof e.Node&&(r=i),s=r.querySelector(s)}if(s instanceof e.Node)return s;if(s==null){if(this.strict)throw B(812);return t.body}return s}_removeLocation(){this._targetLocation.remove(),this._targetLocation.$start.remove()}_moveLocation(e,t){const s=this._targetLocation,i=s.$start,r=e.parentNode,o=[i,s];switch(t){case"beforeend":Vi(e,null,o);break;case"afterbegin":Vi(e,e.firstChild,o);break;case"beforebegin":Vi(r,e,o);break;case"afterend":Vi(r,e.nextSibling,o);break;default:throw B(779,t)}}dispose(){this.view.dispose(),this.view=void 0,this.callbackContext=null}accept(e){if(this.view?.accept(e)===!0)return!0}}Md.$au={type:Ye,name:"portal",isTemplateController:!0,bindables:[{name:"target",primary:!0},"position","activated","activating","callbackContext",{name:"renderContext",callback:"targetChanged"},"strict","deactivated","deactivating"]};let a_;class jr{constructor(){this._parentScope=null,this._outerScope=null,this._attached=!1,this.expose=null,this.slotchange=null,this._subs=new Set,this._observer=null;const e=E(As),t=E(et),s=E(Fn),i=E(on),r=this.name=s.data.name,o=s.projections?.[Hu],a=e.instruction?.projections?.[r],c=e.controller.container;let l,h;a==null?(h=c.createChild({inheritParentResources:!0}),l=i.getViewFactory(o??(a_??=st.create({name:"au-slot-empty-template",template:"",needsCompile:!1})),h),this._hasProjection=!1):(h=c.createChild(),h.useResources(e.parent.controller.container),we(h,As,new Re(void 0,e.parent)),l=i.getViewFactory(a,h),this._hasProjection=!0,this._slotwatchers=c.getAll(Wb,!1)?.filter(u=>u.slotName==="*"||u.slotName===r)??X),this._hasSlotWatcher=(this._slotwatchers??=X).length>0,this._hdrContext=e,this.view=l.create().setLocation(this._location=t)}get nodes(){const e=[],t=this._location;let s=t.$start.nextSibling;for(;s!=null&&s!==t;)s.nodeType!==8&&e.push(s),s=s.nextSibling;return e}subscribe(e){this._subs.add(e)}unsubscribe(e){this._subs.delete(e)}binding(e,t){for(this._parentScope=t.scope;t.vmKind==="synthetic"&&t.parent?.viewModel instanceof jr;)t=t.parent.parent;const s=t.scope.bindingContext;let i;this._hasProjection&&(i=this._hdrContext.controller.scope.parent,(this._outerScope=Oe.fromParent(i,i.bindingContext)).overrideContext.$host=this.expose??s)}attaching(e,t){return q(this.view.activate(e,this.$controller,this._hasProjection?this._outerScope:this._parentScope),()=>{(this._hasSlotWatcher||ce(this.slotchange))&&(this._slotwatchers.forEach(s=>s.watch(this)),this._observe(),this._notifySlotChange(),this._attached=!0)})}detaching(e,t){return this._attached=!1,this._unobserve(),this._slotwatchers.forEach(s=>s.unwatch(this)),this.view.deactivate(e,this.$controller)}exposeChanged(e){this._hasProjection&&this._outerScope!=null&&(this._outerScope.overrideContext.$host=e)}dispose(){this.view.dispose(),this.view=void 0}accept(e){if(this.view?.accept(e)===!0)return!0}_observe(){if(this._observer!=null)return;const e=this._location,t=e.parentElement;t!=null&&(this._observer=Vu(t,s=>{l_(e,s)&&this._notifySlotChange()})).observe(t,{childList:!0})}_unobserve(){this._observer?.disconnect(),this._observer=null}_notifySlotChange(){const e=this.nodes,t=new Set(this._subs);let s;this._attached&&this.slotchange?.call(void 0,this.name,e);for(s of t)s.handleSlotChange(this,e)}}jr.$au={type:nn,name:"au-slot",template:null,containerless:!0,processContent(n,e,t){t.name=n.getAttribute("name")??Hu;let s=n.firstChild,i=null;for(;s!==null;)i=s.nextSibling,Hb(s)&&s.hasAttribute(Ub)&&(console.warn("[DEV:aurelia] detected [au-slot] attribute on a child node",`of an <au-slot> element: "<${s.nodeName} au-slot>".`,"This element will be ignored and removed"),n.removeChild(s)),s=i},bindables:["expose","slotchange"]};const zi=(n,e)=>n.compareDocumentPosition(e),l_=(n,e)=>{for(const{addedNodes:t,removedNodes:s,nextSibling:i}of e){let r=0,o=t.length,a;for(;r<o;++r)if(a=t[r],zi(n.$start,a)===4&&zi(n,a)===2)return!0;if(s.length>0&&i!=null&&zi(n.$start,i)===4&&zi(n,i)===2)return!0}};class Bd{constructor(){this.scopeBehavior="auto",this._composition=void 0,this.tag=null,this._container=E(Ti),this.parent=E(Fr),this._host=E(Mr),this._location=E(et),this._platform=E(nt),this._rendering=E(on),this._instruction=E(Fn),this._contextFactory=E(jf(h_)),this._compiler=E(kr),this._hydrationContext=E(As),this._exprParser=E(Ln),this._observerLocator=E(jn),this._attached=!1}get composing(){return this._composing}get composition(){return this._composition}attaching(e,t){return this._attached=!0,this._composing=q(this.queue(new Ac(this.template,this.component,this.model,void 0),e),s=>{this._contextFactory._isCurrent(s)&&(this._composing=void 0)})}detaching(e){this._attached=!1;const t=this._composition,s=this._composing;return this._contextFactory.invalidate(),this._composition=this._composing=void 0,q(s,()=>t?.deactivate(e))}propertyChanged(e){if(this._attached&&!(e==="composing"||e==="composition")){if(e==="model"&&this._composition!=null){this._composition.update(this.model);return}if(e==="tag"&&this._composition?.controller.vmKind===mt){console.warn("[DEV:aurelia] Changing tag name of a custom element composition is ignored.");return}this._composing=q(this._composing,()=>q(this.queue(new Ac(this.template,this.component,this.model,e),void 0),t=>{this._contextFactory._isCurrent(t)&&(this._composing=void 0)}))}}queue(e,t){const s=this._contextFactory,i=this._composition;return q(s.create(e),r=>s._isCurrent(r)?q(this.compose(r),o=>s._isCurrent(r)?q(o.activate(t),()=>s._isCurrent(r)?(this._composition=o,q(i?.deactivate(t),()=>r)):q(o.controller.deactivate(o.controller,this.$controller),()=>(o.controller.dispose(),r))):(o.controller.dispose(),r)):r)}compose(e){const{_template:t,_component:s,_model:i}=e.change,{_container:r,$controller:o,_location:a,_instruction:c}=this,l=this._getDefinition(this._hydrationContext.controller.container,s),h=r.createChild(),u=this._platform.document.createElement(l==null?this.tag??"div":l.name);a.parentNode.insertBefore(u,a);let d;l==null?d=this.tag==null?Si(u):null:d=l.containerless?Si(u):null;const p=()=>{if(u.remove(),d!=null){let g=d.$start.nextSibling,w=null;for(;g!==null&&g!==d;)w=g.nextSibling,g.remove(),g=w;d.$start?.remove(),d.remove()}},m=this._createComponentInstance(h,typeof s=="string"?l.Type:s,u,d),f=()=>{const g=c.captures??X;if(l!==null){const w=l.capture,[I,M]=g.reduce((S,P)=>{const T=!(P.target in l.bindables)&&(w===!0||ce(w)&&!!w(P.target));return S[T?0:1].push(P),S},[[],[]]),A=ht.$el(h,m,u,{projections:c.projections,captures:I},l,d);return this._createSpreadBindings(u,l,M).forEach(S=>A.addBinding(S)),new Ic(A,S=>A.activate(S??A,o,o.scope.parent),S=>q(A.deactivate(S??A,o),p),S=>m.activate?.(S),e)}else{const w=st.create({name:vs.generateName(),template:t}),I=this._rendering.getViewFactory(w,h),M=ht.$view(I,o),A=this.scopeBehavior==="auto"?Oe.fromParent(this.parent.scope,m):Oe.create(m);return M.setHost(u),d==null?this._createSpreadBindings(u,w,g).forEach(S=>M.addBinding(S)):M.setLocation(d),new Ic(M,S=>M.activate(S??M,o,A),S=>q(M.deactivate(S??M,o),p),S=>m.activate?.(S),e)}};return"activate"in m?q(m.activate(i),()=>f()):f()}_createComponentInstance(e,t,s,i){if(t==null)return new c_;if(typeof t=="object")return t;const r=this._platform;Nr(e,s,r),we(e,et,new Re("IRenderLocation",i));const o=e.invoke(t);return we(e,t,new Re("au-compose.component",o)),o}_getDefinition(e,t){if(typeof t=="string"){const i=vs.find(e,t);if(i==null)throw B(806,t);return i}const s=ce(t)?t:t?.constructor;return vs.isType(s,void 0)?vs.getDefinition(s,null):null}_createSpreadBindings(e,t,s){const i=new rd(this.$controller,{projections:null,captures:s},this._hydrationContext.parent);return Rr.create(i,e,t,this._rendering,this._compiler,this._platform,this._exprParser,this._observerLocator)}}Bd.$au={type:nn,name:"au-compose",capture:!0,containerless:!0,bindables:["template","component","model",{name:"scopeBehavior",set:n=>{if(n==="scoped"||n==="auto")return n;throw B(805,n)}},{name:"composing",mode:os},{name:"composition",mode:os},"tag"]};class c_{}class h_{constructor(){this.id=0}_isCurrent(e){return e.id===this.id}create(e){return q(e.load(),t=>new u_(++this.id,t))}invalidate(){this.id++}}class Ac{constructor(e,t,s,i){this._template=e,this._component=t,this._model=s,this._src=i}load(){return Pe(this._template)||Pe(this._component)?Promise.all([this._template,this._component]).then(([e,t])=>new $c(e,t,this._model,this._src)):new $c(this._template,this._component,this._model,this._src)}}class $c{constructor(e,t,s,i){this._template=e,this._component=t,this._model=s,this._src=i}}class u_{constructor(e,t){this.id=e,this.change=t}}class Ic{constructor(e,t,s,i,r){this.controller=e,this.start=t,this.stop=s,this.update=i,this.context=r,this.state=0}activate(e){if(this.state!==0)throw B(807,this);return this.state=1,this.start(e)}deactivate(e){switch(this.state){case 1:return this.state=-1,this.stop(e);case-1:throw B(808);default:this.state=-1}}}const d_=me("ISanitizer",n=>n.singleton(class{sanitize(){throw B(99,"sanitize")}}));class Pd{constructor(){this._sanitizer=E(d_)}toView(e){return e==null?null:this._sanitizer.sanitize(e)}}Pd.$au={type:_n,name:"sanitize"};class Rd{constructor(){this.el=E(Mr),this.p=E(nt),this._isActive=!1,this._isQueued=!1,this.$val="",this.$prio="",this.update=()=>{this._isQueued=!1,!!this.value!==this._isToggled&&(this._isToggled===this._base?(this._isToggled=!this._base,this.$val=this.el.style.getPropertyValue("display"),this.$prio=this.el.style.getPropertyPriority("display"),this.el.style.setProperty("display","none","important")):(this._isToggled=this._base,this.el.style.setProperty("display",this.$val,this.$prio),this.el.getAttribute("style")===""&&this.el.removeAttribute("style")))};const e=E(Fn);this._isToggled=this._base=e.alias!=="hide"}binding(){this._isActive=!0,this.update()}detaching(){this._isActive=!1,this._isQueued=!1}valueChanged(){this._isActive&&!this._isQueued&&(this._isQueued=!0,Nt(this.update))}}Rd.$au={type:Ye,name:"show",bindables:["value"],aliases:["hide"]};const f_=[Kv,sb,Va],p_=[Bo,Mo,Po,jb],g_=[Xh,qh,Qh,Kh,Yh,Gh,nu,Jh,Zh,su,tu,eu,iu],m_=[Ru,Eu,Mu,Bu,Ou,Lu,Pu,Pd,_r,_d,wd,yd,Ha,Ua,Cd,Wa,$d,Id,Td,ea,ta,sa,md,bd,vd,Bd,Md,Ed,Rd,jr],b_=[Zb,ev,Gb,Jb,qb,Kb,Qb,Yb,Xb,nv,hv,iv,rv,ov,lv,tv,uv,dv],v_=Od(wt);function Od(n){return{optionsProvider:n,register(e){const t={coercingOptions:{enableCoercion:!1,coerceNullish:!1}};return n(t),e.register(Iu(uu,t.coercingOptions),hh,...f_,...m_,...p_,...g_,...b_)},customize(e){return Od(e??n)}}}const __=bs.getOrCreate(globalThis);function w_(){return Ts.createContainer().register(Ys.instance(nt,__),v_)}class mi extends Wv{constructor(e=w_()){super(e)}static app(e){return new mi().app(e)}static enhance(e){return new mi().enhance(e)}static register(...e){return new mi().register(...e)}app(e){if(vs.isType(e)){const t=vs.getDefinition(e);let s=document.querySelector(t.name);return s===null&&(s=document.body),super.app({host:s,component:e})}return super.app(e)}}const y_=`<template>
  <section class="nest-heatmap">
    <h2>Hoornaarnest  Heatmap Analyse</h2>

    <form submit.trigger="run($event)" class="nh-form">
      <!-- Bestanden -->
      <fieldset class="nh-fieldset">
        <legend>Data-invoer</legend>

        <label class="nh-label">
          <span>Registraties (shapefile .shp, RD New)</span>
          <input
            type="file"
            accept=".shp"
            change.trigger="shpFileChanged($event.target.files[0])">
        </label>

        <label class="nh-label">
          <span>Of GeoJSON (WGS84) met registraties</span>
          <input
            type="file"
            accept=".json,.geojson"
            change.trigger="geoJsonFileChanged($event.target.files[0])">
        </label>

        <label class="nh-label">
          <span>Attribuuttabel (.dbf, zelfde shapefile)</span>
          <input
            type="file"
            accept=".dbf"
            change.trigger="dbfFileChanged($event.target.files[0])">
        </label>

        <p class="nh-help" if.bind="shapefileInfo">\${shapefileInfo}</p>

        <label class="nh-label">
          <span>Basiskaart</span>
          <select value.bind="baseSource">
            <option value="online">Online (Carto rastertiles/voyager)</option>
            <option value="upload">Handmatige upload</option>
          </select>
        </label>
        <p class="nh-help" if.bind="baseSource === 'online'">
          We downloaden automatisch de Carto Voyager OSM-tegelset: https://a.basemaps.cartocdn.com/rastertiles/voyager/{z}/{x}/{y}.png (met OSM/CARTO-attributie in de UI opnemen).
        </p>
        <label class="nh-label" if.bind="baseSource === 'upload'">
          <span>Eigen kaart (zonder waarnemingen)</span>
          <input
            type="file"
            accept="image/*"
            change.trigger="baseFileChanged($event.target.files[0])">
        </label>
      </fieldset>

      <fieldset class="nh-fieldset">
        <legend>Kaart-extents (RD New of WGS84)</legend>
        <p class="nh-help">
          Automatisch gevuld vanuit de shapefile; pas aan als de basiskaart een andere uitsnede heeft. Bij OSM/WebMercator screenshots: kies WGS84 en vul hoeken in graden, we projecteren automatisch naar WebMercator.
        </p>
        <label class="nh-label">
          <span>Kaart-cordinaten referentiesysteem</span>
          <select value.bind="boundsCrs">
            <option value="rd">RD New (EPSG:28992)</option>
            <option value="wgs84">WGS84 / WebMercator (graden, bij OSM)</option>
          </select>
        </label>
        <div class="nh-row">
          <label class="nh-label nh-inline">
            <span>minX (west)</span>
            <input type="number" step="any" value.bind="boundsInput.minX">
          </label>
          <label class="nh-label nh-inline">
            <span>minY (zuid)</span>
            <input type="number" step="any" value.bind="boundsInput.minY">
          </label>
        </div>
        <div class="nh-row">
          <label class="nh-label nh-inline">
            <span>maxX (oost)</span>
            <input type="number" step="any" value.bind="boundsInput.maxX">
          </label>
          <label class="nh-label nh-inline">
            <span>maxY (noord)</span>
            <input type="number" step="any" value.bind="boundsInput.maxY">
          </label>
        </div>
      </fieldset>

      <fieldset class="nh-fieldset">
        <legend>Periodefilter (standaard: dit jaar)</legend>
        <div class="nh-row">
          <label class="nh-label nh-inline">
            <span>Van (YYYY-MM-DD)</span>
            <input type="date" value.bind="fromDate">
          </label>
          <label class="nh-label nh-inline">
            <span>Tot en met (YYYY-MM-DD)</span>
            <input type="date" value.bind="toDate">
          </label>
        </div>
        <p class="nh-help">Alleen registraties binnen deze periode worden gebruikt.</p>
      </fieldset>

      <fieldset class="nh-fieldset">
        <legend>Ecologische scores</legend>

        <label class="nh-label">
          <span>Score bos (treeScore)</span>
          <input
            type="number"
            step="0.05"
            value.bind="config.treeScore">
        </label>

        <label class="nh-label">
          <span>Score gras (grassScore)</span>
          <input
            type="number"
            step="0.05"
            value.bind="config.grassScore">
        </label>

        <label class="nh-label">
          <span>Bonus nabij water (nearWaterBonus)</span>
          <input
            type="number"
            step="0.05"
            value.bind="config.nearWaterBonus">
        </label>
      </fieldset>

      <fieldset class="nh-fieldset">
        <legend>Afstanden & smoothing</legend>

        <label class="nh-label">
          <span>Max. afstand van waarneming (pixels)</span>
          <div class="nh-row">
            <input
              type="range"
              min="10"
              max="400"
              step="5"
              value.bind="config.coveragePx">
            <input
              type="number"
              min="1"
              max="1000"
              step="1"
              value.bind="config.coveragePx">
          </div>
        </label>

        <label class="nh-label">
          <span>Smoothing radius (pixels)</span>
          <input
            type="number"
            step="1"
            min="1"
            value.bind="config.smoothPixels">
        </label>

        <label class="nh-label">
          <span>Iso-scores (waarden tussen 0 en 1, komma-gescheiden)</span>
          <input
            type="text"
            value.bind="isoString">
        </label>
      </fieldset>

      <fieldset class="nh-fieldset">
        <legend>Visualisatie</legend>

        <div class="nh-row">
          <label class="nh-label nh-inline">
            <span>Heatmap kleur R</span>
            <input
              type="number"
              min="0"
              max="255"
              value.bind="config.heatColor.r">
          </label>

          <label class="nh-label nh-inline">
            <span>G</span>
            <input
              type="number"
              min="0"
              max="255"
              value.bind="config.heatColor.g">
          </label>

          <label class="nh-label nh-inline">
            <span>B</span>
            <input
              type="number"
              min="0"
              max="255"
              value.bind="config.heatColor.b">
          </label>
        </div>

        <label class="nh-label">
          <span>Minimale overlay alpha (0255)</span>
          <input
            type="number"
            min="0"
            max="255"
            value.bind="config.minAlpha">
        </label>

        <label class="nh-label">
          <span>Gamma (02, lager = meer contrast)</span>
          <input
            type="number"
            step="0.1"
            value.bind="config.gamma">
        </label>
      </fieldset>

      <button type="submit" class="nh-button">
        Bereken heatmap
      </button>
    </form>

    <section class="nh-fieldset nh-converter">
      <legend>RD  WGS84 converter (eenmalige pre-export)</legend>
      <p class="nh-help">
        Gebruik dit om je RD shapefile naar WGS84 GeoJSON te exporteren. Upload de .shp (en optioneel de .dbf voor datums) en klik op export.
      </p>
      <div class="nh-row">
        <label class="nh-label nh-inline">
          <span>Shapefile (.shp)</span>
          <input type="file" accept=".shp" change.trigger="shpFileChanged($event.target.files[0])">
        </label>
        <label class="nh-label nh-inline">
          <span>DBF (optioneel)</span>
          <input type="file" accept=".dbf" change.trigger="dbfFileChanged($event.target.files[0])">
        </label>
      </div>
      <button type="button" class="nh-button" click.trigger="exportShpToGeoJson()">
        Exporteer naar WGS84 GeoJSON
      </button>
    </section>

    <section class="nh-results" if.bind="heatmapUrl || isoUrl">
      <h3>Resultaten</h3>
      <p class="nh-help">Kaartbron: Carto Voyager (OSM-data,  OpenStreetMap-bijdragers /  CARTO).</p>

      <div class="nh-result-grid">
        <div class="nh-result-item" if.bind="heatmapUrl">
          <h4>Kale heatmap</h4>
          <img src.bind="heatmapUrl" alt="Nest heatmap">
        </div>

        <div class="nh-result-item" if.bind="isoUrl">
          <h4>Heatmap met iso-lijnen</h4>
          <img src.bind="isoUrl" alt="Nest heatmap met iso-scores">
        </div>
      </div>
    </section>
  </section>
</template>
`,k_=10;function C_(n){const e=document.createElement("canvas");e.width=n.naturalWidth||n.width,e.height=n.naturalHeight||n.height;const t=e.getContext("2d");if(!t)throw new Error("Unable to get 2D context for image.");return t.drawImage(n,0,0),t.getImageData(0,0,e.width,e.height)}function x_(n,e,t,s,i){let o=0;for(let a=-3;a<=3;a++)for(let c=-3;c<=3;c++){if(c*c+a*a>9)continue;const l=n+c,h=e+a;l<0||h<0||l>=s||h>=i||t[h*s+l]===1&&o++}return o<25}function S_(n){const e=n*2+1,t=new Float32Array(e),s=n/2||1,i=n;let r=0;for(let o=0;o<e;o++){const a=o-i,c=Math.exp(-(a*a)/(2*s*s));t[o]=c,r+=c}if(r===0)for(let o=0;o<e;o++)t[o]=1/e;else for(let o=0;o<e;o++)t[o]/=r;return t}function A_(n,e,t,s){if(s<=0)return n.slice();const i=S_(s),r=new Float32Array(e*t),o=new Float32Array(e*t),a=(c,l)=>l*e+c;for(let c=0;c<t;c++)for(let l=0;l<e;l++){let h=0;for(let u=-s;u<=s;u++){const d=Math.min(e-1,Math.max(0,l+u));h+=n[a(d,c)]*i[u+s]}r[a(l,c)]=h}for(let c=0;c<t;c++)for(let l=0;l<e;l++){let h=0;for(let u=-s;u<=s;u++){const d=Math.min(t-1,Math.max(0,c+u));h+=r[a(l,d)]*i[u+s]}o[a(l,c)]=h}return o}function $_(n,e,t,s){if(!e.length)throw new Error("No observation points provided.");const i=C_(n),r=i.width,o=i.height,a=i.data,c=(x,L)=>(L*r+x)*4,l=(x,L)=>L*r+x,h=t.maxX-t.minX,u=t.maxY-t.minY;if(h<=0||u<=0)throw new Error("Invalid map bounds (width/height <= 0).");const d=x=>({x:(x.x-t.minX)/h*r,y:o-(x.y-t.minY)/u*o}),p=e.map(d).filter(x=>Number.isFinite(x.x)&&Number.isFinite(x.y)).filter(x=>x.x>=0&&x.x<r&&x.y>=0&&x.y<o);if(p.length===0)throw new Error("No observation points fall within the provided bounds.");const m=Math.max(1,s.coveragePx),f=m*m,g=new Uint8Array(r*o);for(let x=0;x<o;x++)for(let L=0;L<r;L++){const z=l(L,x);for(const U of p){const K=L-U.x,ee=x-U.y;if(K*K+ee*ee<=f){g[z]=1;break}}}const w=new Float32Array(r*o),I=new Uint8Array(r*o),M=new Uint8Array(r*o),A=new Uint8Array(r*o),S={r:220,g:235,b:205},P={r:232,g:240,b:220},T={r:213,g:232,b:235},N=32,j=28,H=(x,L,z,U)=>{const K=x-U.r,ee=L-U.g,G=z-U.b;return Math.sqrt(K*K+ee*ee+G*G)};for(let x=0;x<o;x++)for(let L=0;L<r;L++){const z=c(L,x),U=a[z],K=a[z+1],ee=a[z+2],G=H(U,K,ee,S),Ue=H(U,K,ee,P),Te=H(U,K,ee,T),We=G<=N,It=!We&&Ue<=N,_e=Te<=j,us=l(L,x);_e&&(I[us]=1),We&&!_e?M[us]=1:M[us]=0,!We&&It&&!_e?A[us]=1:A[us]=0}for(let x=0;x<o;x++)for(let L=0;L<r;L++){const z=l(L,x);M[z]===1&&x_(L,x,M,r,o)&&(M[z]=0)}for(let x=0;x<w.length;x++)I[x]===1?w[x]=0:M[x]===1?w[x]=s.treeScore:A[x]===1?w[x]=s.grassScore:w[x]=0;const he=Math.max(1,k_);for(let x=0;x<o;x++)for(let L=0;L<r;L++){const z=l(L,x);if(I[z]===1)for(let U=-he;U<=he;U++)for(let K=-he;K<=he;K++){const ee=L+K,G=x+U;if(ee<0||G<0||ee>=r||G>=o||K*K+U*U>he*he)continue;const Te=l(ee,G);I[Te]!==1&&w[Te]<s.nearWaterBonus&&(w[Te]=s.nearWaterBonus)}}const Ie=new Float32Array(r*o);for(let x=0;x<o;x++)for(let L=0;L<r;L++){const z=l(L,x);if(!g[z])continue;let U=0;for(const K of p){const ee=L-K.x,G=x-K.y;ee*ee+G*G<=f&&U++}Ie[z]=U/p.length}const pe=new Float32Array(r*o);let ue=0;const ke=.8;for(let x=0;x<pe.length;x++){if(!g[x]||w[x]<=0){pe[x]=0;continue}const L=Ie[x],z=Math.max(0,1-ke+ke*L),U=w[x]*z;pe[x]=U,U>ue&&(ue=U)}ue===0&&(ue=1);const Y=new Float32Array(r*o);for(let x=0;x<pe.length;x++)Y[x]=pe[x]/ue;const $=Math.max(1,Math.round(s.smoothPixels)),ne=A_(Y,r,o,$);let F=0;for(let x=0;x<ne.length;x++)g[x]&&ne[x]>F&&(F=ne[x]);F===0&&(F=1);const ie=new Float32Array(r*o);for(let x=0;x<ne.length;x++)ie[x]=ne[x]/F;const Me=document.createElement("canvas");Me.width=r,Me.height=o;const b=Me.getContext("2d");if(!b)throw new Error("Could not get 2D context for heatmap.");b.putImageData(i,0,0);const y=b.getImageData(0,0,r,o),_=y.data;for(let x=0;x<o;x++)for(let L=0;L<r;L++){const z=l(L,x),U=ie[z];if(U<=0)continue;const K=Math.pow(U,s.gamma),G=Math.max(s.minAlpha,Math.round(K*255))/255,Ue=c(L,x),Te=a[Ue],We=a[Ue+1],It=a[Ue+2],_e=z*4;_[_e]=Math.round(Te*(1-G)+s.heatColor.r*G),_[_e+1]=Math.round(We*(1-G)+s.heatColor.g*G),_[_e+2]=Math.round(It*(1-G)+s.heatColor.b*G),_[_e+3]=255}b.putImageData(y,0,0),b.fillStyle="white";for(const x of p){const L=Math.round(x.x),z=Math.round(x.y);b.fillRect(L,z,1,1),b.fillRect(L-1,z,1,1),b.fillRect(L+1,z,1,1),b.fillRect(L,z-1,1,1),b.fillRect(L,z+1,1,1)}const C=document.createElement("canvas");C.width=r,C.height=o;const v=C.getContext("2d");if(!v)throw new Error("Could not get 2D context for iso canvas.");v.drawImage(Me,0,0);const k=v.getImageData(0,0,r,o),O=k.data,Ne=[[0,1,0],[1,1,1],[0,1,0]],be=s.isoLevels??[];for(const x of be){if(!(x>0&&x<1))continue;const L=new Uint8Array(r*o);for(let U=0;U<L.length;U++)L[U]=ie[U]>=x?1:0;const z=new Uint8Array(r*o);for(let U=0;U<o;U++)for(let K=0;K<r;K++){const ee=l(K,U);if(!L[ee])continue;let G=!0;for(let Ue=-1;Ue<=1;Ue++){for(let Te=-1;Te<=1;Te++){if(Ne[Ue+1][Te+1]===0)continue;const We=K+Te,It=U+Ue;if(We<0||It<0||We>=r||It>=o)continue;const _e=l(We,It);if(!L[_e]){G=!1;break}}if(!G)break}G&&(z[ee]=1)}for(let U=0;U<o;U++)for(let K=0;K<r;K++){const ee=l(K,U);if(L[ee]&&!z[ee]){const G=ee*4;O[G]=180,O[G+1]=180,O[G+2]=180,O[G+3]=255}}}v.putImageData(k,0,0),v.fillStyle="white";for(const x of p){const L=Math.round(x.x),z=Math.round(x.y);v.fillRect(L,z,1,1),v.fillRect(L-1,z,1,1),v.fillRect(L+1,z,1,1),v.fillRect(L,z-1,1,1),v.fillRect(L,z+1,1,1)}return{heatmapCanvas:Me,isoCanvas:C}}function I_(n){if(n.byteLength<100)throw new Error("SHP file too small to contain a valid header.");const e=n.getInt32(0,!1);if(e!==9994)throw new Error(`Unexpected SHP file code: ${e}`);const t=n.getInt32(32,!0),s=n.getFloat64(36,!0),i=n.getFloat64(44,!0),r=n.getFloat64(52,!0),o=n.getFloat64(60,!0);return{shapeType:t,bounds:{minX:s,minY:i,maxX:r,maxY:o}}}function T_(n){if(n.length<3)return null;let e=0,t=0,s=0;for(let r=0;r<n.length;r++){const{x:o,y:a}=n[r],{x:c,y:l}=n[(r+1)%n.length],h=o*l-c*a;e+=h,t+=(o+c)*h,s+=(a+l)*h}if(e*=.5,Math.abs(e)<1e-9)return null;const i=1/(6*e);return{centroid:{x:t*i,y:s*i},area:Math.abs(e)}}function E_(n){if(!n.length)return{x:0,y:0};let e=0,t=0;for(const s of n)e+=s.x,t+=s.y;return{x:e/n.length,y:t/n.length}}function M_(n,e){if(n.getInt32(e,!0)===0)return{centroid:null,next:e};const s=n.getInt32(e+36,!0),i=n.getInt32(e+40,!0),r=e+44,o=r+s*4,a=[];for(let d=0;d<s;d++)a.push(n.getInt32(r+d*4,!0));a.push(i);const c=[];for(let d=0;d<i;d++){const p=o+d*16;c.push({x:n.getFloat64(p,!0),y:n.getFloat64(p+8,!0)})}let l=0,h=0,u=0;for(let d=0;d<s;d++){const p=a[d],m=a[d+1],f=c.slice(p,m),g=T_(f);g&&(l+=g.centroid.x*g.area,h+=g.centroid.y*g.area,u+=g.area)}return u>0?{centroid:{x:l/u,y:h/u},next:o+i*16}:{centroid:E_(c),next:o+i*16}}function B_(n,e){const t=n.getInt32(e+36,!0),s=[],i=e+40;for(let r=0;r<t;r++){const o=i+r*16;s.push({x:n.getFloat64(o,!0),y:n.getFloat64(o+8,!0)})}return{points:s,next:i+t*16}}function Tc(n){const e=new DataView(n),t=I_(e),s=[];let i=100;for(;i+12<=e.byteLength;){const o=e.getInt32(i+4,!1)*2;i+=8;const a=i,c=a+o;if(c>e.byteLength)break;const l=e.getInt32(a,!0);if(l===0){i=c;continue}switch(l){case 1:{const h=e.getFloat64(a+4,!0),u=e.getFloat64(a+12,!0);s.push({x:h,y:u});break}case 8:{const{points:h}=B_(e,a);s.push(...h);break}case 3:case 5:{const{centroid:h}=M_(e,a);h&&s.push(h);break}}i=c}return{points:s,bounds:t.bounds,shapeType:t.shapeType}}function P_(n){const e=n.getUint32(4,!0),t=n.getUint16(8,!0),s=n.getUint16(10,!0);return{recordCount:e,headerLength:t,recordLength:s}}function R_(n,e){const t=[];let s=32,i=1;for(;s+32<=e-1;){const r=new Uint8Array(n.buffer,s,11),o=r.indexOf(0),a=new TextDecoder("ascii").decode(o>=0?r.slice(0,o):r).trim(),c=String.fromCharCode(n.getUint8(s+11)),l=n.getUint8(s+16);if(!a)break;t.push({name:a,type:c,size:l,offset:i}),i+=l,s+=32}return t}function Ec(n,e,t){const s=new Uint8Array(n.buffer,e,t);return new TextDecoder("latin1").decode(s).trim().replace(/\u0000/g,"")}function Mc(n,e="datm_start",t="datm_stop"){const s=new DataView(n),{recordCount:i,headerLength:r,recordLength:o}=P_(s),a=R_(s,r),c=a.find(d=>d.name.toLowerCase()===e.toLowerCase()),l=a.find(d=>d.name.toLowerCase()===t.toLowerCase()),h=[];let u=r;for(let d=0;d<i&&!(u+o>s.byteLength);d++){const p=s.getUint8(u),m={};if(p!==42){if(c){const f=Ec(s,u+c.offset,c.size);f&&(m.start=f)}if(l){const f=Ec(s,u+l.offset,l.size);f&&(m.stop=f)}}h.push(m),u+=o}return h}function O_(n,e,t){return n?{minX:Math.min(n.minX,e),minY:Math.min(n.minY,t),maxX:Math.max(n.maxX,e),maxY:Math.max(n.maxY,t)}:{minX:e,minY:t,maxX:e,maxY:t}}function L_(n){const e=JSON.parse(n);if(!e||e.type!=="FeatureCollection"||!Array.isArray(e.features))throw new Error("GeoJSON moet een FeatureCollection zijn.");const t=[];let s=null;for(const i of e.features){if(!i||i.type!=="Feature"||!i.geometry)continue;const r=i.geometry;if(r.type!=="Point"||!Array.isArray(r.coordinates)||r.coordinates.length<2)continue;const[o,a]=r.coordinates;if(!Number.isFinite(o)||!Number.isFinite(a))continue;const c=i.properties?.datm_start||i.properties?.dateStart,l=i.properties?.datm_stop||i.properties?.dateStop;t.push({x:o,y:a,dateStart:c,dateStop:l}),s=O_(s,o,a)}return s||(s={minX:0,minY:0,maxX:0,maxY:0}),{points:t,bounds:s}}var D_=Object.create,qa=Object.defineProperty,F_=Object.getOwnPropertyDescriptor,N_=(n,e)=>(e=Symbol[n])?e:Symbol.for("Symbol."+n),Ri=n=>{throw TypeError(n)},j_=(n,e,t)=>e in n?qa(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,Bc=(n,e)=>qa(n,"name",{value:e,configurable:!0}),V_=n=>[,,,D_(null)],Ld=["class","method","getter","setter","accessor","field","value","get","set"],Jn=n=>n!==void 0&&typeof n!="function"?Ri("Function expected"):n,H_=(n,e,t,s,i)=>({kind:Ld[n],name:e,metadata:s,addInitializer:r=>t._?Ri("Already initialized"):i.push(Jn(r||null))}),U_=(n,e)=>j_(e,N_("metadata"),n[3]),Gt=(n,e,t,s)=>{for(var i=0,r=n[e>>1],o=r&&r.length;i<o;i++)e&1?r[i].call(t):s=r[i].call(t,s);return s},Oi=(n,e,t,s,i,r)=>{var o,a,c,l,h,u=e&7,d=!!(e&8),p=!!(e&16),m=u>3?n.length+1:u?d?1:2:0,f=Ld[u+5],g=u>3&&(n[m-1]=[]),w=n[m]||(n[m]=[]),I=u&&(!p&&!d&&(i=i.prototype),u<5&&(u>3||!p)&&F_(u<4?i:{get[t](){return Pc(this,r)},set[t](A){return Rc(this,r,A)}},t));u?p&&u<4&&Bc(r,(u>2?"set ":u>1?"get ":"")+t):Bc(i,t);for(var M=s.length-1;M>=0;M--)l=H_(u,t,c={},n[3],w),u&&(l.static=d,l.private=p,h=l.access={has:p?A=>W_(i,A):A=>t in A},u^3&&(h.get=p?A=>(u^1?Pc:z_)(A,i,u^4?r:I.get):A=>A[t]),u>2&&(h.set=p?(A,S)=>Rc(A,i,S,u^4?r:I.set):(A,S)=>A[t]=S)),a=(0,s[M])(u?u<4?p?r:I[f]:u>4?void 0:{get:I.get,set:I.set}:i,l),c._=1,u^4||a===void 0?Jn(a)&&(u>4?g.unshift(a):u?p?r=a:I[f]=a:i=a):typeof a!="object"||a===null?Ri("Object expected"):(Jn(o=a.get)&&(I.get=o),Jn(o=a.set)&&(I.set=o),Jn(o=a.init)&&g.unshift(o));return u||U_(n,i),I&&qa(i,t,I),p?u^4?r:I:i},Ka=(n,e,t)=>e.has(n)||Ri("Cannot "+t),W_=(n,e)=>Object(e)!==e?Ri('Cannot use the "in" operator on this value'):n.has(e),Pc=(n,e,t)=>(Ka(n,e,"read from private field"),t?t.call(n):e.get(n)),Rc=(n,e,t,s)=>(Ka(n,e,"write to private field"),s?s.call(n,t):e.set(n,t),t),z_=(n,e,t)=>(Ka(n,e,"access private method"),t),Dd,Fd,Nd,jd,Vd,Ge;Vd=[Fv({name:"nest-heatmap-view",template:y_})],jd=[ji],Nd=[ji],Fd=[ji],Dd=[ji];class $s{constructor(){this.baseFile=Gt(Ge,8,this,null),Gt(Ge,11,this),this.shpFile=Gt(Ge,12,this,null),Gt(Ge,15,this),this.dbfFile=Gt(Ge,16,this,null),Gt(Ge,19,this),this.geoJsonFile=Gt(Ge,20,this,null),Gt(Ge,23,this),this.baseSource="online",this.config={treeScore:1,grassScore:.15,nearWaterBonus:.1,smoothPixels:20,coveragePx:90,isoLevels:[.5,.75,.9],heatColor:{r:180,g:0,b:200},minAlpha:80,gamma:.6},this.isoString="0.5,0.75,0.9",this.heatmapUrl=null,this.isoUrl=null,this.observationsAll=[],this.observationsFiltered=[],this.shpBounds=null,this.boundsInput={minX:0,minY:0,maxX:0,maxY:0},this.shapefileInfo=null,this.fromDate="",this.toDate="",this.boundsCrs="rd",this.observationSource="shp"}baseFileChanged(e){this.baseFile=e}shpFileChanged(e){this.shpFile=e,this.observationSource="shp",this.loadObservationData()}dbfFileChanged(e){this.dbfFile=e,this.loadObservationData()}geoJsonFileChanged(e){this.geoJsonFile=e,this.observationSource="geojson",this.loadObservationData()}isoStringChanged(e){if(!e){this.config.isoLevels=[];return}const t=e.split(",").map(s=>parseFloat(s.trim())).filter(s=>!isNaN(s)&&s>0&&s<1);t.length&&(this.config.isoLevels=t)}async run(e){if(e&&e.preventDefault(),this.observationSource==="geojson"&&!this.geoJsonFile){console.warn("GeoJSON met registraties is nodig.");return}if(this.observationSource==="shp"&&!this.shpFile){console.warn("Shapefile (.shp) is nodig.");return}try{if(!this.observationsFiltered.length){console.warn("Geen registraties binnen de geselecteerde periode.");return}const t=this.resolveBounds()??this.shpBounds;if(!t){console.warn("Kaart-extents ontbreken of zijn ongeldig.");return}const s=await this.prepareBaseMapAndData(t,this.observationsFiltered);if(!s)return;const i=$_(s.baseImg,s.observations,s.mapBounds,this.config);this.heatmapUrl=i.heatmapCanvas.toDataURL("image/png"),this.isoUrl=i.isoCanvas.toDataURL("image/png")}catch(t){console.error("Error while computing heatmap:",t)}}async prepareBaseMapAndData(e,t){if(this.baseSource==="online"){const o=this.ensureWgsBounds(e),a=await this.fetchCartoBaseMap(o),c=this.prepareDataForWebMerc(a.webMercBounds,t);return{baseImg:a.image,mapBounds:a.webMercBounds,observations:c.observations}}if(!this.baseFile)return console.warn("Basiskaart is nodig."),null;const s=this.prepareDataForMap(e,t),i=await this.loadImageFromFile(this.baseFile),r=this.matchBoundsToImage(s.bounds,i);return{baseImg:i,mapBounds:r,observations:s.observations}}prepareDataForMap(e,t){if(this.boundsCrs==="rd")return{bounds:e,observations:t};const s=this.ensureWgsBounds(e),i=this.boundsToWebMerc(s),r=t.map(o=>{const a=this.observationSource==="shp"?this.rdToWgsObservation(o):o;return this.wgsToWebMercObservation(a)});return{bounds:i,observations:r}}prepareDataForWebMerc(e,t){const s=this.ensureWgsBounds(e),i=this.boundsToWebMerc(s),r=t.map(o=>{const a=this.observationSource==="shp"?this.rdToWgsObservation(o):o;return this.wgsToWebMercObservation(a)});return{bounds:i,observations:r}}matchBoundsToImage(e,t){const s=t.naturalWidth||t.width,i=t.naturalHeight||t.height;if(!s||!i)return e;const r=e.maxX-e.minX,o=e.maxY-e.minY;if(r<=0||o<=0)return e;const a=s/i,c=r/o;if(Math.abs(c-a)<1e-4)return e;const l=(e.minX+e.maxX)/2,h=(e.minY+e.maxY)/2;if(c<a){const d=a*o;return{minX:l-d/2,maxX:l+d/2,minY:e.minY,maxY:e.maxY}}const u=r/a;return{minX:e.minX,maxX:e.maxX,minY:h-u/2,maxY:h+u/2}}rdToWgs(e){const i=52.1551744,r=5.38720621,o=[[0,1,3235.65389],[2,0,-32.58297],[0,2,-.2475],[2,1,-.84978],[0,3,-.0655],[2,2,-.01709],[1,0,-.00738],[4,0,.0053],[2,3,-39e-5],[4,1,33e-5],[1,1,-12e-5]],a=[[1,0,5260.52916],[1,1,105.94684],[1,2,2.45656],[3,0,-.81885],[1,3,.05594],[3,1,-.05607],[0,1,.01199],[3,2,-.00256],[1,4,.00128],[0,2,22e-5],[2,0,-22e-5],[5,0,26e-5]],c=(e.x-155e3)/1e5,l=(e.y-463e3)/1e5;let h=i,u=r;for(const[d,p,m]of o)h+=m*Math.pow(c,d)*Math.pow(l,p)/3600;for(const[d,p,m]of a)u+=m*Math.pow(c,d)*Math.pow(l,p)/3600;return{x:u,y:h}}rdToWgsObservation(e){const t=this.rdToWgs({x:e.x,y:e.y});return{...e,x:t.x,y:t.y}}wgsToWebMerc(e){const t=e.x,s=Math.max(Math.min(e.y,85.05112878),-85.05112878),i=t*2003750834e-2/180,r=Math.log(Math.tan((90+s)*Math.PI/360))*2003750834e-2/Math.PI;return{x:i,y:r}}wgsToWebMercObservation(e){const t=this.wgsToWebMerc({x:e.x,y:e.y});return{...e,x:t.x,y:t.y}}ensureWgsBounds(e){if(Math.abs(e.minX)<=180&&Math.abs(e.maxX)<=180&&Math.abs(e.minY)<=90&&Math.abs(e.maxY)<=90)return e;const s=this.rdToWgs({x:e.minX,y:e.minY}),i=this.rdToWgs({x:e.maxX,y:e.maxY});return{minX:s.x,minY:s.y,maxX:i.x,maxY:i.y}}boundsToWebMerc(e){const t=this.wgsToWebMerc({x:e.minX,y:e.minY}),s=this.wgsToWebMerc({x:e.maxX,y:e.maxY});return{minX:t.x,minY:t.y,maxX:s.x,maxY:s.y}}lonLatToTileX(e,t){const s=Math.pow(2,t);return(e+180)/360*s}latToTileY(e,t){const s=Math.pow(2,t),i=Math.max(Math.min(e,85.05112878),-85.05112878)*Math.PI/180;return(1-Math.log(Math.tan(i)+1/Math.cos(i))/Math.PI)/2*s}tileXToLon(e,t){const s=Math.pow(2,t);return e/s*360-180}tileYToLat(e,t){const s=Math.pow(2,t),i=Math.PI-2*Math.PI*e/s;return 180/Math.PI*Math.atan(.5*(Math.exp(i)-Math.exp(-i)))}computeTileSpan(e,t){const s=Math.floor(this.lonLatToTileX(e.minX,t)),i=Math.floor(this.lonLatToTileX(e.maxX,t)),r=Math.floor(this.latToTileY(e.maxY,t)),o=Math.floor(this.latToTileY(e.minY,t)),a=i-s+1,c=o-r+1,l=256;return{minX:s,maxX:i,minY:r,maxY:o,widthPx:a*l,heightPx:c*l}}pickTileZoom(e){for(let r=17;r>=4;r--){const o=this.computeTileSpan(e,r);if(o.widthPx<=1536&&o.heightPx<=1536)return r}return 4}async fetchCartoBaseMap(e){const t=this.pickTileZoom(e),s=this.computeTileSpan(e,t),i=document.createElement("canvas");i.width=s.widthPx,i.height=s.heightPx;const r=i.getContext("2d");if(!r)throw new Error("Kon geen canvas context maken voor basiskaart.");const o=["a","b","c","d"],a=256,c=[];for(let I=s.minY;I<=s.maxY;I++)for(let M=s.minX;M<=s.maxX;M++){const S=`https://${o[(M+I)%o.length]}.basemaps.cartocdn.com/rastertiles/voyager/${t}/${M}/${I}.png`,P=(M-s.minX)*a,T=(I-s.minY)*a,N=async()=>{const j=await this.loadImageFromUrl(S,!0);r.drawImage(j,P,T,a,a)};c.push(N())}await Promise.all(c);const l=i.toDataURL("image/png"),h=await this.loadImageFromUrl(l,!1),u=this.tileXToLon(s.minX,t),d=this.tileXToLon(s.maxX+1,t),p=this.tileYToLat(s.minY,t),m=this.tileYToLat(s.maxY+1,t),f=this.wgsToWebMerc({x:u,y:m}),g=this.wgsToWebMerc({x:d,y:p}),w={minX:f.x,minY:f.y,maxX:g.x,maxY:g.y};return{image:h,webMercBounds:w}}async exportShpToGeoJson(){if(!this.shpFile){console.warn("Geen shapefile geselecteerd.");return}try{const e=await this.shpFile.arrayBuffer(),t=Tc(e);let s=null;if(this.dbfFile)try{const l=await this.dbfFile.arrayBuffer();s=Mc(l)}catch(l){console.warn("DBF kon niet gelezen worden; datums worden overgeslagen.",l)}const r={type:"FeatureCollection",features:t.points.map((l,h)=>{const u=s&&s[h]?s[h]:void 0,d=this.rdToWgs({x:l.x,y:l.y});return{type:"Feature",geometry:{type:"Point",coordinates:[d.x,d.y]},properties:{datm_start:u?.start??null,datm_stop:u?.stop??null}}})},o=new Blob([JSON.stringify(r,null,2)],{type:"application/json"}),a=URL.createObjectURL(o),c=document.createElement("a");c.href=a,c.download="registrations_wgs84.geojson",c.click(),URL.revokeObjectURL(a)}catch(e){console.error("Kon shapefile niet converteren naar GeoJSON:",e)}}loadImageFromUrl(e,t){return new Promise((s,i)=>{const r=new Image;t&&(r.crossOrigin="anonymous"),r.onload=()=>s(r),r.onerror=o=>i(o),r.src=e})}loadImageFromFile(e){return new Promise((t,s)=>{const i=URL.createObjectURL(e),r=new Image;r.onload=()=>{URL.revokeObjectURL(i),t(r)},r.onerror=o=>{URL.revokeObjectURL(i),s(o)},r.src=i})}resolveBounds(){if(!this.boundsInput)return null;const e={minX:Number(this.boundsInput.minX),minY:Number(this.boundsInput.minY),maxX:Number(this.boundsInput.maxX),maxY:Number(this.boundsInput.maxY)},t=Object.values(e).some(r=>Number.isNaN(r)),s=e.maxX-e.minX,i=e.maxY-e.minY;return t||s<=0||i<=0?null:e}async loadObservationData(){if(this.observationSource==="geojson"){if(!this.geoJsonFile){this.resetObservations();return}try{const e=await this.geoJsonFile.text(),t=L_(e);this.observationsAll=t.points,this.shpBounds=t.bounds,this.boundsInput={...t.bounds},this.boundsCrs="wgs84",this.ensureDefaultDateRange(),this.applyDateFilter(),this.updateInfoMessage()}catch(e){console.error("Kon GeoJSON niet lezen:",e),this.resetObservations("Fout bij inlezen GeoJSON")}return}if(!this.shpFile){this.resetObservations();return}try{const e=await this.shpFile.arrayBuffer(),t=Tc(e);let s=null;if(this.dbfFile)try{const r=await this.dbfFile.arrayBuffer();s=Mc(r)}catch(r){console.warn("DBF kon niet gelezen worden; datums worden overgeslagen.",r)}const i=t.points.map((r,o)=>{const a=s&&s[o]?s[o]:void 0;return{...r,dateStart:a?.start,dateStop:a?.stop}});this.observationsAll=i,this.shpBounds=t.bounds,this.boundsInput={...t.bounds},this.boundsCrs="rd",this.ensureDefaultDateRange(),this.applyDateFilter(),this.updateInfoMessage()}catch(e){console.error("Kon shapefile niet lezen:",e),this.resetObservations("Fout bij inlezen shapefile")}}resetObservations(e=null){this.observationsAll=[],this.observationsFiltered=[],this.shpBounds=null,this.boundsInput={minX:0,minY:0,maxX:0,maxY:0},this.shapefileInfo=e}ensureDefaultDateRange(){const t=new Date().getFullYear(),s=`${t}-01-01`,i=`${t}-12-31`;this.fromDate||(this.fromDate=s),this.toDate||(this.toDate=i)}fromDateChanged(){this.applyDateFilter()}toDateChanged(){this.applyDateFilter()}applyDateFilter(){if(!this.observationsAll.some(r=>!!r.dateStart)){this.observationsFiltered=[...this.observationsAll],this.updateInfoMessage();return}const t=this.parseDate(this.fromDate),s=this.parseDate(this.toDate),i=this.observationsAll.filter(r=>{if(!t&&!s)return!0;if(!r.dateStart)return!1;const o=this.parseDate(r.dateStart);return!(!o||t&&o<t||s&&o>s)});this.observationsFiltered=i,this.updateInfoMessage()}parseDate(e){if(!e)return null;const t=e.includes("-")?e:`${e.slice(0,4)}-${e.slice(4,6)}-${e.slice(6,8)}`,s=new Date(t);return isNaN(s.getTime())?null:s}updateInfoMessage(){const e=this.observationsAll.length,t=this.observationsFiltered.length;if(!e){this.shapefileInfo=null;return}const s=this.fromDate||"...",i=this.toDate||"...";this.shapefileInfo=`${t} van ${e} registraties binnen selectie (${s} t/m ${i}).`}}Ge=V_();Oi(Ge,5,"baseFile",jd,$s);Oi(Ge,5,"shpFile",Nd,$s);Oi(Ge,5,"dbfFile",Fd,$s);Oi(Ge,5,"geoJsonFile",Dd,$s);$s=Oi(Ge,0,"NestHeatmapView",Vd,$s);Gt(Ge,1,$s);mi.app($s).start();
